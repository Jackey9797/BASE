2023-05-17 14:11:51,542 - logger name:exp/district3F11T17/ECL-Informer2023-05-17-14:11:51.542345/ECL-Informer.log
2023-05-17 14:11:51,542 - params : {'conf': 'ECL-Informer', 'load_config': 'configs/', 'data_process': False, 'auto_test': 1, 'load': True, 'device': device(type='cuda', index=1), 'build_graph': False, 'dynamic_graph': False, 'graph_input': False, 'model_name': 'informer', 'data_name': 'electricity', 'root_path': '', 'raw_data_path': 'data/district3F11T17/finaldata/', 'graph_path': 'data/district3F11T17/graph/', 'save_data_path': 'data/ECL/', 'model_path': 'exp/district3F11T17/', 'phase': 2012, 'days': 31, '/* model related args*/': '//', 'x_len': 96, 'y_len': 96, 'label_len': 48, 'features': 'M', 'target': 'OT', 'individual': False, 'test_model_path': '/Disk/fhyega/code/PatchTST/PatchTST_supervised/checkpoints/electricity_96_96_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0/checkpoint.pth', 'e_layers': 2, 'd_layers': 1, 'factor': 3, 'n_heads': 8, 'd_model': 512, 'd_ff': 2048, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'distil': 1, 'linear_output': 0, '/*train related args*/': '//', 'train': True, 'epoch': 100, 'batch_size': 128, 'lr': 0.0001, 'loss': 'mse', '/*dataset related args*/': '//', 'embed': 'timeF', 'freq': 'h', 'begin_phase': 1, 'end_phase': 1, 'phase_len': 15667, 'val_ratio': 0.5, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-Informer', 'time': '2023-05-17-14:11:51.542345', 'path': 'exp/district3F11T17/ECL-Informer2023-05-17-14:11:51.542345', 'logger': <Logger __main__ (INFO)>}
2023-05-17 14:11:51,543 - [*] phase 1 load from data/ECL/1_30day.npz
2023-05-17 14:11:51,543 - [*] phase 1 Dataset load!
2023-05-17 14:13:03,923 - [*] phase 1 Training start
2023-05-17 14:13:04,388 - node number torch.Size([41088, 96])
2023-05-17 14:13:45,451 - epoch:0, training loss:0.7152 validation loss:0.6731
2023-05-17 14:14:26,914 - epoch:1, training loss:0.5602 validation loss:0.6320
2023-05-17 14:15:09,831 - epoch:2, training loss:0.4537 validation loss:0.6688
2023-05-17 14:15:54,060 - epoch:3, training loss:0.3940 validation loss:0.6463
2023-05-17 14:16:40,418 - epoch:4, training loss:0.3684 validation loss:0.6333
2023-05-17 14:17:27,128 - epoch:5, training loss:0.3520 validation loss:0.6458
2023-05-17 14:18:14,971 - epoch:6, training loss:0.3407 validation loss:0.6209
2023-05-17 14:19:02,675 - epoch:7, training loss:0.3312 validation loss:0.6221
2023-05-17 14:19:51,975 - epoch:8, training loss:0.3232 validation loss:0.6092
2023-05-17 14:20:40,402 - epoch:9, training loss:0.3169 validation loss:0.6105
2023-05-17 14:21:28,595 - epoch:10, training loss:0.3109 validation loss:0.6080
2023-05-17 14:22:17,343 - epoch:11, training loss:0.3057 validation loss:0.5879
2023-05-17 14:23:06,193 - epoch:12, training loss:0.3020 validation loss:0.5910
2023-05-17 14:23:54,295 - epoch:13, training loss:0.2972 validation loss:0.5691
2023-05-17 14:24:42,872 - epoch:14, training loss:0.2935 validation loss:0.5619
2023-05-17 14:25:30,124 - epoch:15, training loss:0.2904 validation loss:0.5704
2023-05-17 14:26:14,553 - epoch:16, training loss:0.2865 validation loss:0.5573
2023-05-17 14:27:01,499 - epoch:17, training loss:0.2842 validation loss:0.5488
2023-05-17 14:27:48,850 - epoch:18, training loss:0.2813 validation loss:0.5420
2023-05-17 14:28:35,911 - epoch:19, training loss:0.2792 validation loss:0.5435
2023-05-17 14:29:22,179 - epoch:20, training loss:0.2772 validation loss:0.5401
2023-05-17 14:30:10,899 - epoch:21, training loss:0.2749 validation loss:0.5378
2023-05-17 14:30:58,075 - epoch:22, training loss:0.2733 validation loss:0.5338
2023-05-17 14:31:46,176 - epoch:23, training loss:0.2711 validation loss:0.5283
2023-05-17 14:32:33,534 - epoch:24, training loss:0.2692 validation loss:0.5202
2023-05-17 14:33:20,538 - epoch:25, training loss:0.2678 validation loss:0.5191
2023-05-17 14:34:08,738 - epoch:26, training loss:0.2665 validation loss:0.5196
2023-05-17 14:34:58,115 - epoch:27, training loss:0.2653 validation loss:0.5134
2023-05-17 14:35:46,325 - epoch:28, training loss:0.2636 validation loss:0.5030
2023-05-17 14:36:34,741 - epoch:29, training loss:0.2624 validation loss:0.5022
2023-05-17 14:37:24,714 - epoch:30, training loss:0.2611 validation loss:0.5049
2023-05-17 14:38:14,209 - epoch:31, training loss:0.2596 validation loss:0.5052
2023-05-17 14:39:03,482 - epoch:32, training loss:0.2589 validation loss:0.5049
2023-05-17 14:39:53,000 - epoch:33, training loss:0.2580 validation loss:0.4974
2023-05-17 14:40:42,746 - epoch:34, training loss:0.2568 validation loss:0.4938
2023-05-17 14:41:32,506 - epoch:35, training loss:0.2554 validation loss:0.4833
2023-05-17 14:42:22,653 - epoch:36, training loss:0.2549 validation loss:0.4923
2023-05-17 14:43:10,481 - epoch:37, training loss:0.2538 validation loss:0.4867
2023-05-17 14:43:59,411 - epoch:38, training loss:0.2533 validation loss:0.4826
2023-05-17 14:44:48,628 - epoch:39, training loss:0.2522 validation loss:0.4800
2023-05-17 14:45:39,560 - epoch:40, training loss:0.2513 validation loss:0.4771
2023-05-17 14:46:28,915 - epoch:41, training loss:0.2505 validation loss:0.4797
2023-05-17 14:47:19,210 - epoch:42, training loss:0.2497 validation loss:0.4759
2023-05-17 14:48:10,213 - epoch:43, training loss:0.2491 validation loss:0.4749
2023-05-17 14:49:01,795 - epoch:44, training loss:0.2485 validation loss:0.4726
2023-05-17 14:49:51,780 - epoch:45, training loss:0.2476 validation loss:0.4762
2023-05-17 14:50:42,155 - epoch:46, training loss:0.2469 validation loss:0.4748
2023-05-17 14:51:30,876 - epoch:47, training loss:0.2463 validation loss:0.4725
2023-05-17 14:52:20,241 - epoch:48, training loss:0.2458 validation loss:0.4732
2023-05-17 14:53:09,783 - epoch:49, training loss:0.2452 validation loss:0.4657
2023-05-17 14:53:58,566 - epoch:50, training loss:0.2446 validation loss:0.4764
2023-05-17 14:54:47,513 - epoch:51, training loss:0.2437 validation loss:0.4658
2023-05-17 14:55:34,664 - epoch:52, training loss:0.2431 validation loss:0.4692
2023-05-17 14:56:24,501 - epoch:53, training loss:0.2425 validation loss:0.4644
2023-05-17 14:57:11,962 - epoch:54, training loss:0.2421 validation loss:0.4672
2023-05-17 14:57:59,624 - epoch:55, training loss:0.2414 validation loss:0.4626
2023-05-17 14:58:47,008 - epoch:56, training loss:0.2410 validation loss:0.4570
2023-05-17 14:59:35,886 - epoch:57, training loss:0.2404 validation loss:0.4577
2023-05-17 15:00:23,710 - epoch:58, training loss:0.2399 validation loss:0.4559
2023-05-17 15:01:11,500 - epoch:59, training loss:0.2394 validation loss:0.4600
2023-05-17 15:01:59,189 - epoch:60, training loss:0.2388 validation loss:0.4522
2023-05-17 15:02:45,709 - epoch:61, training loss:0.2385 validation loss:0.4577
2023-05-17 15:03:35,101 - epoch:62, training loss:0.2379 validation loss:0.4529
2023-05-17 15:04:23,879 - epoch:63, training loss:0.2374 validation loss:0.4562
2023-05-17 15:05:11,306 - epoch:64, training loss:0.2371 validation loss:0.4545
2023-05-17 15:05:59,701 - epoch:65, training loss:0.2363 validation loss:0.4532
2023-05-17 15:06:49,986 - epoch:66, training loss:0.2358 validation loss:0.4510
2023-05-17 15:07:38,807 - epoch:67, training loss:0.2357 validation loss:0.4480
2023-05-17 15:08:28,585 - epoch:68, training loss:0.2351 validation loss:0.4485
2023-05-17 15:09:18,843 - epoch:69, training loss:0.2347 validation loss:0.4518
2023-05-17 15:10:09,319 - epoch:70, training loss:0.2342 validation loss:0.4485
2023-05-17 15:10:58,650 - epoch:71, training loss:0.2337 validation loss:0.4490
2023-05-17 15:11:47,949 - epoch:72, training loss:0.2333 validation loss:0.4482
2023-05-17 15:12:38,020 - epoch:73, training loss:0.2330 validation loss:0.4413
2023-05-17 15:13:25,536 - epoch:74, training loss:0.2324 validation loss:0.4436
2023-05-17 15:14:15,718 - epoch:75, training loss:0.2322 validation loss:0.4492
2023-05-17 15:15:05,825 - epoch:76, training loss:0.2318 validation loss:0.4430
2023-05-17 15:15:54,045 - epoch:77, training loss:0.2313 validation loss:0.4422
2023-05-17 15:16:42,999 - epoch:78, training loss:0.2309 validation loss:0.4401
2023-05-17 15:17:32,238 - epoch:79, training loss:0.2305 validation loss:0.4380
2023-05-17 15:18:19,366 - epoch:80, training loss:0.2301 validation loss:0.4402
2023-05-17 15:19:08,603 - epoch:81, training loss:0.2297 validation loss:0.4407
2023-05-17 15:19:58,547 - epoch:82, training loss:0.2294 validation loss:0.4423
2023-05-17 15:20:48,622 - epoch:83, training loss:0.2290 validation loss:0.4406
2023-05-17 15:21:38,605 - epoch:84, training loss:0.2286 validation loss:0.4388
2023-05-17 15:22:27,275 - epoch:85, training loss:0.2283 validation loss:0.4358
2023-05-17 15:23:16,538 - epoch:86, training loss:0.2281 validation loss:0.4398
2023-05-17 15:24:05,073 - epoch:87, training loss:0.2275 validation loss:0.4380
2023-05-17 15:24:54,980 - epoch:88, training loss:0.2272 validation loss:0.4368
2023-05-17 15:25:42,988 - epoch:89, training loss:0.2269 validation loss:0.4379
2023-05-17 15:26:30,796 - epoch:90, training loss:0.2268 validation loss:0.4395
2023-05-17 15:27:20,705 - epoch:91, training loss:0.2264 validation loss:0.4378
2023-05-17 15:28:09,291 - epoch:92, training loss:0.2260 validation loss:0.4375
2023-05-17 15:28:59,952 - epoch:93, training loss:0.2257 validation loss:0.4371
2023-05-17 15:29:49,512 - epoch:94, training loss:0.2254 validation loss:0.4353
2023-05-17 15:30:37,004 - epoch:95, training loss:0.2250 validation loss:0.4320
2023-05-17 15:31:24,885 - epoch:96, training loss:0.2247 validation loss:0.4348
2023-05-17 15:32:14,915 - epoch:97, training loss:0.2245 validation loss:0.4336
2023-05-17 15:33:03,620 - epoch:98, training loss:0.2241 validation loss:0.4299
2023-05-17 15:33:54,057 - epoch:99, training loss:0.2239 validation loss:0.4344
2023-05-17 15:33:54,334 - Finished optimization, total time:4121.82 s, best model:exp/district3F11T17/ECL-Informer2023-05-17-14:11:51.542345/1/0.4299_epoch_98.pkl
2023-05-17 15:37:07,127 - logger name:exp/district3F11T17/ECL-Informer2023-05-17-15:37:07.124514/ECL-Informer.log
2023-05-17 15:37:07,128 - params : {'conf': 'ECL-Informer', 'load_config': 'configs/', 'data_process': False, 'auto_test': 1, 'load': True, 'device': device(type='cuda', index=1), 'build_graph': False, 'dynamic_graph': False, 'graph_input': False, 'model_name': 'informer', 'data_name': 'electricity', 'root_path': '', 'raw_data_path': 'data/district3F11T17/finaldata/', 'graph_path': 'data/district3F11T17/graph/', 'save_data_path': 'data/ECL/', 'model_path': 'exp/district3F11T17/', 'phase': 2012, 'days': 31, '/* model related args*/': '//', 'x_len': 96, 'y_len': 96, 'label_len': 48, 'features': 'M', 'target': 'OT', 'individual': False, 'test_model_path': 'exp/district3F11T17/ECL-Informer2023-05-17-14:11:51.542345/1/0.4299_epoch_98.pkl', 'e_layers': 2, 'd_layers': 1, 'factor': 3, 'n_heads': 8, 'd_model': 512, 'd_ff': 2048, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'distil': 1, 'linear_output': 0, '/*train related args*/': '//', 'train': False, 'epoch': 100, 'batch_size': 128, 'lr': 0.0001, 'loss': 'mse', '/*dataset related args*/': '//', 'embed': 'timeF', 'freq': 'h', 'begin_phase': 1, 'end_phase': 1, 'phase_len': 15667, 'val_ratio': 0.5, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-Informer', 'time': '2023-05-17-15:37:07.124514', 'path': 'exp/district3F11T17/ECL-Informer2023-05-17-15:37:07.124514', 'logger': <Logger __main__ (INFO)>}
2023-05-17 15:37:07,128 - [*] phase 1 load from data/ECL/1_30day.npz
2023-05-17 15:37:07,128 - [*] phase 1 Dataset load!
2023-05-17 15:37:22,356 - [*] loss:0.3472
2023-05-17 15:37:22,537 - [*] phase 1, testing
2023-05-17 15:37:22,833 - T:3	MAE	0.3863	RMSE	0.5344	MAPE	402.5341
2023-05-17 15:37:23,210 - T:6	MAE	0.3780	RMSE	0.5276	MAPE	408.7902
2023-05-17 15:37:23,733 - T:12	MAE	0.3942	RMSE	0.5523	MAPE	415.7743
2023-05-17 15:38:18,122 - T:96	MAE	0.4230	RMSE	0.5871	MAPE	452.6478
2023-05-17 15:38:18,124 - 3	mae	0.39	
2023-05-17 15:38:18,124 - 3	rmse	0.53	
2023-05-17 15:38:18,124 - 3	mape	402.53	
2023-05-17 15:38:18,124 - 6	mae	0.38	
2023-05-17 15:38:18,124 - 6	rmse	0.53	
2023-05-17 15:38:18,124 - 6	mape	408.79	
2023-05-17 15:38:18,124 - 12	mae	0.39	
2023-05-17 15:38:18,124 - 12	rmse	0.55	
2023-05-17 15:38:18,124 - 12	mape	415.77	
2023-05-17 15:38:18,124 - 96	mae	0.42	
2023-05-17 15:38:18,124 - 96	rmse	0.59	
2023-05-17 15:38:18,124 - 96	mape	452.65	
