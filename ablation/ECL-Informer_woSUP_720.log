2023-09-06 23:41:39,767 - logger name:exp/ECL-Informer2023-09-06-23:41:39.763738/ECL-Informer.log
2023-09-06 23:41:39,767 - params : {'loss': 'huber', 'conf': 'ECL-Informer', 'data_name': 'ETTm1', 'iteration': 1, 'train': 1, 'mainrs': 0, 'abl': 0, 'abl_tmp_context': 0, 'abl_ae': 0, 'no_tmp': 0, 'load': True, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'lr': 0.0001, 'lradj': 'TST', 'dropout': 0.05, 'fc_dropout': 0.05, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'd_ff': 512, 'd_model': 128, 'n_heads': 8, 'seq_len': 96, 'pred_len': 720, 'noise_rate': 0.5, 'device': device(type='cuda', index=1), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-26-13:08:31.837686/0/best_model.pkl', 'idx': -1, 'aligner': 1, 'always_align': 1, 'refiner': 1, 'rec_block_num': 1, 'enhance': 1, 'enhance_type': 5, 'seed': 34, 'batch_size': 64, 'share_head': 0, 'add_noise': 1, 'add_norm': 0, 'jitter_sigma': 0.4, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 0, 'debugger': 0, 'summary': 0, 'omega': 1.0, 'theta': 1.5, 'mask_border': 1, 'sup_weight': 0.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 1, 'add_FFN': 1, 'add_residual': 0, 'rec_all': 0, 'e_layers': 2, 'early_break': 0, 'early_stop': 10, '/* model related args*/': '//', 'model_name': 'informer', 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 3, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'distil': 1, 'linear_output': 0, 'pct_start': 0.3, 'indie': 0, '/*train related args*/': '//', 'epoch': 30, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': False, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': 26304, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-Informer', 'time': '2023-09-06-23:41:39.763738', 'path': 'exp/ECL-Informer2023-09-06-23:41:39.763738', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-09-06 23:41:39,767 - [*] phase 0 start training
train 33745
val 10801
test 10801
2023-09-06 23:41:40,036 - [*] phase 0 Dataset load!
dropout 0.05
dropout 0.05
1 True None
2023-09-06 23:41:41,350 - [*] phase 0 Training start
train 33745
2023-09-06 23:45:34,382 - epoch:0, training loss:0.3958 validation loss:0.4867
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4867063027161818 0.5174260165917097
Updating learning rate to 6.8959628024441156e-06
Updating learning rate to 6.8959628024441156e-06
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4801866597325139 0.49223654968498726
need align? ->  False 0.49223654968498726
2023-09-06 23:54:42,681 - epoch:1, training loss:9.0841 validation loss:0.4802
Updating learning rate to 1.5234409520062321e-05
Updating learning rate to 1.5234409520062321e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4692549347524812 0.47048624873866696
need align? ->  False 0.47048624873866696
2023-09-07 00:01:34,535 - epoch:2, training loss:8.1590 validation loss:0.4693
Updating learning rate to 2.8009180506005253e-05
Updating learning rate to 2.8009180506005253e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4716705658732081 0.47646826426305716
need align? ->  True 0.47048624873866696
2023-09-07 00:08:31,526 - epoch:3, training loss:7.4265 validation loss:0.4717
Updating learning rate to 4.367880652756318e-05
Updating learning rate to 4.367880652756318e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4659657537408129 0.46647952329477615
need align? ->  False 0.46647952329477615
2023-09-07 00:15:36,289 - epoch:4, training loss:6.9447 validation loss:0.4660
Updating learning rate to 6.0352510331126026e-05
Updating learning rate to 6.0352510331126026e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.46725047736830966 0.46466288164522523
need align? ->  True 0.46466288164522523
2023-09-07 00:22:40,662 - epoch:5, training loss:6.2548 validation loss:0.4673
Updating learning rate to 7.601835750027339e-05
Updating learning rate to 7.601835750027339e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.469704965427077 0.4614434870918827
need align? ->  True 0.4614434870918827
2023-09-07 00:29:40,355 - epoch:6, training loss:5.9005 validation loss:0.4697
Updating learning rate to 8.878602675706259e-05
Updating learning rate to 8.878602675706259e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4693766223079354 0.4603009348261286
need align? ->  True 0.4603009348261286
2023-09-07 00:36:31,597 - epoch:7, training loss:5.7407 validation loss:0.4694
Updating learning rate to 9.711490579976146e-05
Updating learning rate to 9.711490579976146e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4696732032052159 0.4505181389271155
need align? ->  True 0.4505181389271155
2023-09-07 00:43:57,447 - epoch:8, training loss:5.6085 validation loss:0.4697
Updating learning rate to 9.999999798544934e-05
Updating learning rate to 9.999999798544934e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.47152590390140486 0.4421823380085138
need align? ->  True 0.4421823380085138
2023-09-07 00:51:03,473 - epoch:9, training loss:5.5223 validation loss:0.4715
Updating learning rate to 9.943942612786164e-05
Updating learning rate to 9.943942612786164e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4665560247101022 0.437653455155841
need align? ->  True 0.437653455155841
2023-09-07 00:58:06,473 - epoch:10, training loss:5.4376 validation loss:0.4666
Updating learning rate to 9.777446365443946e-05
Updating learning rate to 9.777446365443946e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.46858422890217344 0.4308255727915369
need align? ->  True 0.4308255727915369
2023-09-07 01:05:07,812 - epoch:11, training loss:5.3564 validation loss:0.4686
Updating learning rate to 9.504230307557132e-05
Updating learning rate to 9.504230307557132e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.46713070306904925 0.4166168801971441
need align? ->  True 0.4166168801971441
2023-09-07 01:12:15,100 - epoch:12, training loss:5.2487 validation loss:0.4671
Updating learning rate to 9.130397634382975e-05
Updating learning rate to 9.130397634382975e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.46392014111287494 0.4182939492386474
need align? ->  True 0.4166168801971441
2023-09-07 01:19:21,971 - epoch:13, training loss:5.0917 validation loss:0.4639
Updating learning rate to 8.664299150100286e-05
Updating learning rate to 8.664299150100286e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4656057690198605 0.4100751963240155
need align? ->  True 0.4100751963240155
2023-09-07 01:26:16,739 - epoch:14, training loss:5.0447 validation loss:0.4656
Updating learning rate to 8.11634672464338e-05
Updating learning rate to 8.11634672464338e-05
(33745, 1)
(33745, 1) False
train 33745
vs, vt 0.465601164472879 0.4044033278815845
need align? ->  True 0.4044033278815845
2023-09-07 01:33:13,270 - epoch:15, training loss:5.0874 validation loss:0.4656
Updating learning rate to 7.498780709732839e-05
Updating learning rate to 7.498780709732839e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.46568214664092433 0.40726466432830993
need align? ->  True 0.4044033278815845
2023-09-07 01:40:09,877 - epoch:16, training loss:5.0901 validation loss:0.4657
Updating learning rate to 6.825396509644642e-05
Updating learning rate to 6.825396509644642e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4677423579982046 0.4108834400684876
need align? ->  True 0.4044033278815845
2023-09-07 01:47:40,971 - epoch:17, training loss:5.0684 validation loss:0.4677
Updating learning rate to 6.111236414674868e-05
Updating learning rate to 6.111236414674868e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.46577132488848894 0.41142246704658814
need align? ->  True 0.4044033278815845
2023-09-07 01:54:54,817 - epoch:18, training loss:5.0537 validation loss:0.4658
Updating learning rate to 5.372253581231107e-05
Updating learning rate to 5.372253581231107e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4668955095773618 0.41332221291297994
need align? ->  True 0.4044033278815845
2023-09-07 02:02:07,021 - epoch:19, training loss:5.0424 validation loss:0.4669
Updating learning rate to 4.624955664680119e-05
Updating learning rate to 4.624955664680119e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.46479003351820997 0.41303893773866124
need align? ->  True 0.4044033278815845
2023-09-07 02:09:19,215 - epoch:20, training loss:5.0348 validation loss:0.4648
Updating learning rate to 3.8860360656050195e-05
Updating learning rate to 3.8860360656050195e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.46197770782829034 0.41446765331474283
need align? ->  True 0.4044033278815845
2023-09-07 02:16:28,730 - epoch:21, training loss:5.0272 validation loss:0.4620
Updating learning rate to 3.172001026821268e-05
Updating learning rate to 3.172001026821268e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4616790904095892 0.4159633012477463
need align? ->  True 0.4044033278815845
2023-09-07 02:23:37,418 - epoch:22, training loss:5.0223 validation loss:0.4617
Updating learning rate to 2.498800911187905e-05
Updating learning rate to 2.498800911187905e-05
(33745, 1)
(33745, 1) False
train 33745
vs, vt 0.46135864402415483 0.4159301452382782
need align? ->  True 0.4044033278815845
2023-09-07 02:30:47,559 - epoch:23, training loss:5.0195 validation loss:0.4614
Updating learning rate to 1.881473896858479e-05
Updating learning rate to 1.881473896858479e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4604469881607936 0.41702948087418573
need align? ->  True 0.4044033278815845
2023-09-07 02:37:58,259 - epoch:24, training loss:5.0144 validation loss:0.4604
Updating learning rate to 1.3338100492309234e-05
Updating learning rate to 1.3338100492309234e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4610263926566705 0.4173799632392691
need align? ->  True 0.4044033278815845
2023-09-07 02:42:54,349 - epoch:25, training loss:5.0120 validation loss:0.4610
Updating learning rate to 8.680432736739732e-06
Updating learning rate to 8.680432736739732e-06
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.46078966796045473 0.41907014922630154
need align? ->  True 0.4044033278815845
2023-09-07 02:46:41,655 - epoch:26, training loss:5.0100 validation loss:0.4608
Updating learning rate to 4.945780302971433e-06
Updating learning rate to 4.945780302971433e-06
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.46036843488202295 0.4184591640999331
need align? ->  True 0.4044033278815845
2023-09-07 02:50:31,777 - epoch:27, training loss:5.0105 validation loss:0.4604
Updating learning rate to 2.217569155047347e-06
Updating learning rate to 2.217569155047347e-06
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4606884507208886 0.4189030036947431
need align? ->  True 0.4044033278815845
2023-09-07 02:54:18,386 - epoch:28, training loss:5.0093 validation loss:0.4607
Updating learning rate to 5.567430217788732e-07
Updating learning rate to 5.567430217788732e-07
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4608146040397283 0.4187763891012006
need align? ->  True 0.4044033278815845
2023-09-07 02:58:04,592 - epoch:29, training loss:5.0089 validation loss:0.4608
Updating learning rate to 4.0201455066715895e-10
Updating learning rate to 4.0201455066715895e-10
dropout 0.05
dropout 0.05
check exp/ECL-Informer2023-09-06-23:41:39.763738/0/0.4604_epoch_27.pkl  &  0.4044033278815845
2023-09-07 02:58:16,120 - [*] loss:1.0354
2023-09-07 02:58:16,212 - [*] phase 0, testing
2023-09-07 02:58:17,704 - T:720	MAE	0.769950	RMSE	1.035517	MAPE	319.381976
2023-09-07 02:58:17,706 - 720	mae	0.7700	
2023-09-07 02:58:17,706 - 720	rmse	1.0355	
2023-09-07 02:58:17,706 - 720	mape	319.3820	
2023-09-07 02:58:28,463 - [*] loss:1.0356
2023-09-07 02:58:28,547 - [*] phase 0, testing
2023-09-07 02:58:29,656 - T:720	MAE	0.769651	RMSE	1.035788	MAPE	319.882751
2023-09-07 02:58:40,898 - [*] loss:1.0355
2023-09-07 02:58:40,984 - [*] phase 0, testing
2023-09-07 02:58:42,098 - T:720	MAE	0.769985	RMSE	1.035689	MAPE	319.325852
2023-09-07 02:58:52,360 - [*] loss:0.9530
2023-09-07 02:58:52,450 - [*] phase 0, testing
2023-09-07 02:58:53,560 - T:720	MAE	0.722552	RMSE	0.953197	MAPE	294.644547
2023-09-07 02:58:53,561 - 720	mae	0.7226	
2023-09-07 02:58:53,561 - 720	rmse	0.9532	
2023-09-07 02:58:53,561 - 720	mape	294.6445	
