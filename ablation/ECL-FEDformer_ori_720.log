2023-09-07 07:56:22,984 - logger name:exp/ECL-FEDformer2023-09-07-07:56:22.984234/ECL-FEDformer.log
2023-09-07 07:56:22,984 - params : {'loss': 'mse', 'conf': 'ECL-FEDformer', 'data_name': 'ETTm1', 'iteration': 1, 'train': 1, 'mainrs': 0, 'abl': 0, 'abl_tmp_context': 0, 'abl_ae': 0, 'no_tmp': 0, 'load': True, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'lr': 0.0001, 'lradj': 'TST', 'dropout': 0.05, 'fc_dropout': 0.05, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'd_ff': 512, 'd_model': 128, 'n_heads': 8, 'seq_len': 96, 'pred_len': 720, 'noise_rate': 0.5, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-26-13:08:31.837686/0/best_model.pkl', 'idx': -1, 'aligner': 0, 'always_align': 1, 'refiner': 0, 'rec_block_num': 1, 'enhance': 0, 'enhance_type': 5, 'seed': 34, 'batch_size': 64, 'share_head': 0, 'add_noise': 1, 'add_norm': 0, 'jitter_sigma': 0.4, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 0, 'debugger': 0, 'summary': 0, 'omega': 1.0, 'theta': 1.5, 'mask_border': 1, 'sup_weight': 10.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 1, 'add_FFN': 1, 'add_residual': 0, 'rec_all': 0, 'e_layers': 2, 'early_break': 0, 'early_stop': 10, '/* model related args*/': '//', 'model_name': 'FEDformer', 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 1, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'distil': 1, 'linear_output': 0, 'pct_start': 0.2, 'num_kernels': 6, 'top_k': 5, 'moving_avg': 25, 'indie': 0, '/*train related args*/': '//', 'epoch': 30, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': -1, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-FEDformer', 'time': '2023-09-07-07:56:22.984234', 'path': 'exp/ECL-FEDformer2023-09-07-07:56:22.984234', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-09-07 07:56:22,984 - [*] phase 0 start training
0 69680
train 33745
val 10801
test 10801
2023-09-07 07:56:23,807 - [*] phase 0 Dataset load!
dropout 0.05
dropout 0.05
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 6, 7, 8, 9, 10, 12, 13, 15, 16, 17, 19, 22, 23, 24, 26, 27, 28, 30, 31, 34, 37, 39, 40, 43, 44, 45, 46, 47]
fourier enhanced block used!
modes=32, index=[19, 50, 63, 81, 83, 95, 104, 110, 124, 134, 144, 156, 162, 191, 204, 218, 244, 249, 250, 252, 259, 277, 278, 306, 312, 321, 322, 323, 336, 357, 367, 377]
 fourier enhanced cross attention used!
modes_q=32, index_q=[5, 6, 18, 37, 47, 68, 80, 112, 129, 153, 167, 195, 201, 220, 225, 229, 232, 239, 249, 250, 294, 296, 299, 315, 328, 344, 347, 350, 353, 358, 362, 376]
modes_kv=32, index_kv=[0, 2, 3, 5, 6, 8, 10, 11, 12, 14, 16, 17, 18, 20, 21, 22, 23, 24, 26, 28, 29, 32, 33, 34, 37, 38, 40, 42, 44, 45, 46, 47]
0 True None
2023-09-07 07:56:23,947 - [*] phase 0 Training start
train 33745
2023-09-07 07:59:03,836 - epoch:0, training loss:0.9364 validation loss:1.4541
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.4541334227697384 1.4571360085137497
Updating learning rate to 1.0434756630121772e-05
Updating learning rate to 1.0434756630121772e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.306421872250427 1.30636084203184
need align? ->  True 1.30636084203184
2023-09-07 08:06:19,171 - epoch:1, training loss:0.9154 validation loss:1.3064
Updating learning rate to 2.801377265011639e-05
Updating learning rate to 2.801377265011639e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.284171634260014 1.2832471794454303
need align? ->  True 1.2832471794454303
2023-09-07 08:11:23,158 - epoch:2, training loss:0.7900 validation loss:1.2842
Updating learning rate to 5.202385264808068e-05
Updating learning rate to 5.202385264808068e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.1481200380790868 1.2421289024621072
need align? ->  False 1.2421289024621072
2023-09-07 08:16:28,479 - epoch:3, training loss:0.7495 validation loss:1.1481
Updating learning rate to 7.602753739665399e-05
Updating learning rate to 7.602753739665399e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.111801420178639 1.1533041895317608
need align? ->  False 1.1533041895317608
2023-09-07 08:25:09,255 - epoch:4, training loss:0.6966 validation loss:1.1118
Updating learning rate to 9.358908232986824e-05
Updating learning rate to 9.358908232986824e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.0992969464973585 1.1378759785869417
need align? ->  False 1.1378759785869417
2023-09-07 08:35:14,211 - epoch:5, training loss:0.6864 validation loss:1.0993
Updating learning rate to 9.999999845760966e-05
Updating learning rate to 9.999999845760966e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.0897770513444258 1.1249317708452777
need align? ->  False 1.1249317708452777
2023-09-07 08:45:00,756 - epoch:6, training loss:0.6802 validation loss:1.0898
Updating learning rate to 9.957062220971791e-05
Updating learning rate to 9.957062220971791e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.0839666759474038 1.114978442971523
need align? ->  False 1.114978442971523
2023-09-07 08:55:25,717 - epoch:7, training loss:0.6756 validation loss:1.0840
Updating learning rate to 9.829308229430039e-05
Updating learning rate to 9.829308229430039e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.0809200351407542 1.1088729896665326
need align? ->  False 1.1088729896665326
2023-09-07 09:05:17,500 - epoch:8, training loss:0.6716 validation loss:1.0809
Updating learning rate to 9.618923777351089e-05
Updating learning rate to 9.618923777351089e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.0610827517932688 1.106068275912979
need align? ->  False 1.106068275912979
2023-09-07 09:15:14,148 - epoch:9, training loss:0.6617 validation loss:1.0611
Updating learning rate to 9.329508601039598e-05
Updating learning rate to 9.329508601039598e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.0514558714169722 1.1066161220419337
need align? ->  False 1.106068275912979
2023-09-07 09:25:15,959 - epoch:10, training loss:0.6403 validation loss:1.0515
Updating learning rate to 8.966014674403308e-05
Updating learning rate to 8.966014674403308e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.0522431279780597 1.1049945984013687
need align? ->  False 1.1049945984013687
2023-09-07 09:35:18,615 - epoch:11, training loss:0.6373 validation loss:1.0522
Updating learning rate to 8.534661479306515e-05
Updating learning rate to 8.534661479306515e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.0528929105700826 1.1041882498377174
need align? ->  False 1.1041882498377174
2023-09-07 09:45:20,810 - epoch:12, training loss:0.6352 validation loss:1.0529
Updating learning rate to 8.04282958851103e-05
Updating learning rate to 8.04282958851103e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.0439378531903205 1.1018970494968652
need align? ->  False 1.1018970494968652
2023-09-07 09:55:23,537 - epoch:13, training loss:0.6326 validation loss:1.0439
Updating learning rate to 7.498934382029921e-05
Updating learning rate to 7.498934382029921e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.050005750366922 1.1020011541229733
need align? ->  False 1.1018970494968652
2023-09-07 10:05:31,247 - epoch:14, training loss:0.6312 validation loss:1.0500
Updating learning rate to 6.912282057642325e-05
Updating learning rate to 6.912282057642325e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.049541914868637 1.1027262081232296
need align? ->  False 1.1018970494968652
2023-09-07 10:15:31,183 - epoch:15, training loss:0.6304 validation loss:1.0495
Updating learning rate to 6.292910399269261e-05
Updating learning rate to 6.292910399269261e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.0505594837771366 1.1004695475277817
need align? ->  False 1.1004695475277817
2023-09-07 10:25:45,187 - epoch:16, training loss:0.6291 validation loss:1.0506
Updating learning rate to 5.651417027707762e-05
Updating learning rate to 5.651417027707762e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.0511225880779458 1.0995493771938176
need align? ->  False 1.0995493771938176
2023-09-07 10:35:47,493 - epoch:17, training loss:0.6271 validation loss:1.0511
Updating learning rate to 4.998778072400808e-05
Updating learning rate to 4.998778072400808e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.0521301971913795 1.0984596432842446
need align? ->  False 1.0984596432842446
2023-09-07 10:46:07,462 - epoch:18, training loss:0.6249 validation loss:1.0521
Updating learning rate to 4.346160366819404e-05
Updating learning rate to 4.346160366819404e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.05015467107296 1.0965634471566015
need align? ->  False 1.0965634471566015
2023-09-07 10:56:18,524 - epoch:19, training loss:0.6242 validation loss:1.0502
Updating learning rate to 3.704730380845859e-05
Updating learning rate to 3.704730380845859e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.0528749448836907 1.0968497448418972
need align? ->  False 1.0965634471566015
2023-09-07 11:06:40,728 - epoch:20, training loss:0.6229 validation loss:1.0529
Updating learning rate to 3.0854631593781676e-05
Updating learning rate to 3.0854631593781676e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.0501822869805895 1.095113505008658
need align? ->  False 1.095113505008658
2023-09-07 11:16:57,029 - epoch:21, training loss:0.6221 validation loss:1.0502
Updating learning rate to 2.4989545362689562e-05
Updating learning rate to 2.4989545362689562e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.0507007551616465 1.0950739548580182
need align? ->  False 1.0950739548580182
2023-09-07 11:27:32,687 - epoch:22, training loss:0.6208 validation loss:1.0507
Updating learning rate to 1.955239836670534e-05
Updating learning rate to 1.955239836670534e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.0511696977904563 1.093247158287545
need align? ->  False 1.093247158287545
2023-09-07 11:37:55,755 - epoch:23, training loss:0.6206 validation loss:1.0512
Updating learning rate to 1.4636221698392234e-05
Updating learning rate to 1.4636221698392234e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 1.0518310645804603 1.0950956122409663
need align? ->  False 1.093247158287545
2023-09-07 11:48:16,927 - epoch:24, training loss:0.6201 validation loss:1.0518
dropout 0.05
dropout 0.05
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 14, 18, 19, 20, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 41, 42, 43, 45]
fourier enhanced block used!
modes=32, index=[23, 25, 44, 54, 63, 74, 93, 117, 135, 152, 154, 176, 181, 182, 200, 201, 248, 252, 261, 267, 310, 314, 322, 324, 342, 345, 347, 349, 361, 366, 372, 375]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 4, 18, 21, 49, 58, 91, 97, 99, 158, 170, 172, 173, 176, 189, 190, 219, 236, 239, 240, 244, 266, 279, 281, 290, 291, 292, 308, 342, 355, 372, 375]
modes_kv=32, index_kv=[0, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 18, 21, 23, 26, 27, 28, 29, 30, 34, 36, 37, 38, 39, 40, 42, 43, 45, 46, 47]
check exp/ECL-FEDformer2023-09-07-07:56:22.984234/0/1.0439_epoch_13.pkl  &  1.093247158287545
2023-09-07 11:49:07,954 - [*] loss:0.6448
2023-09-07 11:49:08,042 - [*] phase 0, testing
2023-09-07 11:49:08,927 - T:720	MAE	0.533675	RMSE	0.644540	MAPE	284.865332
