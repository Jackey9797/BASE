2023-09-06 22:39:43,537 - logger name:exp/ECL-FEDformer2023-09-06-22:39:43.537032/ECL-FEDformer.log
2023-09-06 22:39:43,537 - params : {'loss': 'huber', 'conf': 'ECL-FEDformer', 'data_name': 'ETTm1', 'iteration': 1, 'train': 1, 'mainrs': 0, 'abl': 0, 'abl_tmp_context': 0, 'abl_ae': 0, 'no_tmp': 0, 'load': True, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'lr': 0.0001, 'lradj': 'TST', 'dropout': 0.05, 'fc_dropout': 0.05, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'd_ff': 512, 'd_model': 128, 'n_heads': 8, 'seq_len': 96, 'pred_len': 720, 'noise_rate': 0.5, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-26-13:08:31.837686/0/best_model.pkl', 'idx': -1, 'aligner': 0, 'always_align': 1, 'refiner': 1, 'rec_block_num': 1, 'enhance': 1, 'enhance_type': 5, 'seed': 34, 'batch_size': 64, 'share_head': 0, 'add_noise': 1, 'add_norm': 0, 'jitter_sigma': 0.4, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 0, 'debugger': 0, 'summary': 0, 'omega': 1.0, 'theta': 1.5, 'mask_border': 1, 'sup_weight': 10.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 1, 'add_FFN': 1, 'add_residual': 0, 'rec_all': 0, 'e_layers': 2, 'early_break': 0, 'early_stop': 10, '/* model related args*/': '//', 'model_name': 'FEDformer', 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 1, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'distil': 1, 'linear_output': 0, 'pct_start': 0.2, 'num_kernels': 6, 'top_k': 5, 'moving_avg': 25, 'indie': 0, '/*train related args*/': '//', 'epoch': 30, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': -1, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-FEDformer', 'time': '2023-09-06-22:39:43.537032', 'path': 'exp/ECL-FEDformer2023-09-06-22:39:43.537032', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-09-06 22:39:43,537 - [*] phase 0 start training
0 69680
train 33745
val 10801
test 10801
2023-09-06 22:39:44,343 - [*] phase 0 Dataset load!
dropout 0.05
dropout 0.05
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 6, 7, 8, 9, 10, 12, 13, 15, 16, 17, 19, 22, 23, 24, 26, 27, 28, 30, 31, 34, 37, 39, 40, 43, 44, 45, 46, 47]
fourier enhanced block used!
modes=32, index=[19, 50, 63, 81, 83, 95, 104, 110, 124, 134, 144, 156, 162, 191, 204, 218, 244, 249, 250, 252, 259, 277, 278, 306, 312, 321, 322, 323, 336, 357, 367, 377]
 fourier enhanced cross attention used!
modes_q=32, index_q=[5, 6, 18, 37, 47, 68, 80, 112, 129, 153, 167, 195, 201, 220, 225, 229, 232, 239, 249, 250, 294, 296, 299, 315, 328, 344, 347, 350, 353, 358, 362, 376]
modes_kv=32, index_kv=[0, 2, 3, 5, 6, 8, 10, 11, 12, 14, 16, 17, 18, 20, 21, 22, 23, 24, 26, 28, 29, 32, 33, 34, 37, 38, 40, 42, 44, 45, 46, 47]
1 True None
2023-09-06 22:39:44,490 - [*] phase 0 Training start
train 33745
2023-09-06 22:42:23,966 - epoch:0, training loss:0.3790 validation loss:0.5115
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.5114594247390533 0.5134897963887841
Updating learning rate to 1.0434756630121772e-05
Updating learning rate to 1.0434756630121772e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4544921087971806 0.4584266673883743
need align? ->  False 0.4584266673883743
2023-09-06 22:50:58,213 - epoch:1, training loss:11.5942 validation loss:0.4545
Updating learning rate to 2.801377265011639e-05
Updating learning rate to 2.801377265011639e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4462685067889958 0.448660478392649
need align? ->  False 0.448660478392649
2023-09-06 22:57:18,886 - epoch:2, training loss:9.9405 validation loss:0.4463
Updating learning rate to 5.202385264808068e-05
Updating learning rate to 5.202385264808068e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4087140702548817 0.43402336352675625
need align? ->  False 0.43402336352675625
2023-09-06 23:03:40,709 - epoch:3, training loss:7.1632 validation loss:0.4087
Updating learning rate to 7.602753739665399e-05
Updating learning rate to 7.602753739665399e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.39892634370270563 0.41201429818508895
need align? ->  False 0.41201429818508895
2023-09-06 23:10:02,222 - epoch:4, training loss:5.2671 validation loss:0.3989
Updating learning rate to 9.358908232986824e-05
Updating learning rate to 9.358908232986824e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.39317801894520865 0.4064079404935329
need align? ->  False 0.4064079404935329
2023-09-06 23:16:23,526 - epoch:5, training loss:4.4721 validation loss:0.3932
Updating learning rate to 9.999999845760966e-05
Updating learning rate to 9.999999845760966e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.39026601533212607 0.4012741420925016
need align? ->  False 0.4012741420925016
2023-09-06 23:22:44,461 - epoch:6, training loss:4.0700 validation loss:0.3903
Updating learning rate to 9.957062220971791e-05
Updating learning rate to 9.957062220971791e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.38849208539230584 0.3974867385960895
need align? ->  False 0.3974867385960895
2023-09-06 23:29:04,785 - epoch:7, training loss:3.8244 validation loss:0.3885
Updating learning rate to 9.829308229430039e-05
Updating learning rate to 9.829308229430039e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3868967901320147 0.39538200464121687
need align? ->  False 0.39538200464121687
2023-09-06 23:35:26,611 - epoch:8, training loss:3.6458 validation loss:0.3869
Updating learning rate to 9.618923777351089e-05
Updating learning rate to 9.618923777351089e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3856972016438225 0.39373010908358197
need align? ->  False 0.39373010908358197
2023-09-06 23:41:47,571 - epoch:9, training loss:3.4983 validation loss:0.3857
Updating learning rate to 9.329508601039598e-05
Updating learning rate to 9.329508601039598e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3839258396854767 0.392639927169275
need align? ->  False 0.392639927169275
2023-09-06 23:48:11,892 - epoch:10, training loss:3.3754 validation loss:0.3839
Updating learning rate to 8.966014674403308e-05
Updating learning rate to 8.966014674403308e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3839438989229456 0.39169475105563567
need align? ->  False 0.39169475105563567
2023-09-06 23:54:33,758 - epoch:11, training loss:3.2866 validation loss:0.3839
Updating learning rate to 8.534661479306515e-05
Updating learning rate to 8.534661479306515e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3820234342263295 0.3912356482631356
need align? ->  False 0.3912356482631356
2023-09-07 00:00:55,694 - epoch:12, training loss:3.4214 validation loss:0.3820
Updating learning rate to 8.04282958851103e-05
Updating learning rate to 8.04282958851103e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37432634067782283 0.3901160798481936
need align? ->  False 0.3901160798481936
2023-09-07 00:07:19,087 - epoch:13, training loss:8.7690 validation loss:0.3743
Updating learning rate to 7.498934382029921e-05
Updating learning rate to 7.498934382029921e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37312877367763125 0.390814080878475
need align? ->  False 0.3901160798481936
2023-09-07 00:13:39,718 - epoch:14, training loss:9.9355 validation loss:0.3731
Updating learning rate to 6.912282057642325e-05
Updating learning rate to 6.912282057642325e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37160884932829785 0.389594928091447
need align? ->  False 0.389594928091447
2023-09-07 00:20:01,852 - epoch:15, training loss:10.0978 validation loss:0.3716
Updating learning rate to 6.292910399269261e-05
Updating learning rate to 6.292910399269261e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37166306976030566 0.3889845037865921
need align? ->  False 0.3889845037865921
2023-09-07 00:26:24,662 - epoch:16, training loss:10.2619 validation loss:0.3717
Updating learning rate to 5.651417027707762e-05
Updating learning rate to 5.651417027707762e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37324323738820453 0.38887805496094496
need align? ->  False 0.38887805496094496
2023-09-07 00:32:46,787 - epoch:17, training loss:10.3649 validation loss:0.3732
Updating learning rate to 4.998778072400808e-05
Updating learning rate to 4.998778072400808e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3730955493785221 0.38757228190024223
need align? ->  False 0.38757228190024223
2023-09-07 00:39:10,035 - epoch:18, training loss:10.4409 validation loss:0.3731
Updating learning rate to 4.346160366819404e-05
Updating learning rate to 4.346160366819404e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37200811112949833 0.3866558653803972
need align? ->  False 0.3866558653803972
2023-09-07 00:45:34,203 - epoch:19, training loss:10.4725 validation loss:0.3720
Updating learning rate to 3.704730380845859e-05
Updating learning rate to 3.704730380845859e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3729568261366624 0.38638401586981214
need align? ->  False 0.38638401586981214
2023-09-07 00:51:58,826 - epoch:20, training loss:10.4848 validation loss:0.3730
Updating learning rate to 3.0854631593781676e-05
Updating learning rate to 3.0854631593781676e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3732015311100779 0.38649936734571966
need align? ->  False 0.38638401586981214
2023-09-07 00:58:23,033 - epoch:21, training loss:10.5074 validation loss:0.3732
Updating learning rate to 2.4989545362689562e-05
Updating learning rate to 2.4989545362689562e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37278479875544823 0.38549375009430936
need align? ->  False 0.38549375009430936
2023-09-07 01:04:46,314 - epoch:22, training loss:10.5004 validation loss:0.3728
Updating learning rate to 1.955239836670534e-05
Updating learning rate to 1.955239836670534e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3733262186043361 0.38562109704906417
need align? ->  False 0.38549375009430936
2023-09-07 01:11:11,509 - epoch:23, training loss:10.5132 validation loss:0.3733
Updating learning rate to 1.4636221698392234e-05
Updating learning rate to 1.4636221698392234e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3734570955031017 0.3857278817239598
need align? ->  False 0.38549375009430936
2023-09-07 01:17:36,219 - epoch:24, training loss:10.5178 validation loss:0.3735
Updating learning rate to 1.032513250356674e-05
Updating learning rate to 1.032513250356674e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3731739937641917 0.38535411633859723
need align? ->  False 0.38535411633859723
2023-09-07 01:24:01,429 - epoch:25, training loss:10.5379 validation loss:0.3732
Updating learning rate to 6.692894713612099e-06
Updating learning rate to 6.692894713612099e-06
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37368058558751843 0.38524109319116945
need align? ->  False 0.38524109319116945
2023-09-07 01:30:27,299 - epoch:26, training loss:10.5403 validation loss:0.3737
dropout 0.05
dropout 0.05
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 14, 18, 19, 20, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 41, 42, 43, 45]
fourier enhanced block used!
modes=32, index=[23, 25, 44, 54, 63, 74, 93, 117, 135, 152, 154, 176, 181, 182, 200, 201, 248, 252, 261, 267, 310, 314, 322, 324, 342, 345, 347, 349, 361, 366, 372, 375]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 4, 18, 21, 49, 58, 91, 97, 99, 158, 170, 172, 173, 176, 189, 190, 219, 236, 239, 240, 244, 266, 279, 281, 290, 291, 292, 308, 342, 355, 372, 375]
modes_kv=32, index_kv=[0, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 18, 21, 23, 26, 27, 28, 29, 30, 34, 36, 37, 38, 39, 40, 42, 43, 45, 46, 47]
check exp/ECL-FEDformer2023-09-06-22:39:43.537032/0/0.3716_epoch_15.pkl  &  0.38524109319116945
2023-09-07 01:30:38,241 - [*] loss:0.6584
2023-09-07 01:30:38,303 - [*] phase 0, testing
2023-09-07 01:30:39,179 - T:720	MAE	0.539473	RMSE	0.658098	MAPE	265.483737
2023-09-07 01:30:39,180 - 720	mae	0.5395	
2023-09-07 01:30:39,180 - 720	rmse	0.6581	
2023-09-07 01:30:39,180 - 720	mape	265.4837	
2023-09-07 01:30:49,489 - [*] loss:0.6584
2023-09-07 01:30:49,548 - [*] phase 0, testing
2023-09-07 01:30:50,411 - T:720	MAE	0.539480	RMSE	0.658101	MAPE	265.472364
2023-09-07 01:31:01,239 - [*] loss:0.6584
2023-09-07 01:31:01,300 - [*] phase 0, testing
2023-09-07 01:31:02,172 - T:720	MAE	0.539473	RMSE	0.658098	MAPE	265.483737
2023-09-07 01:31:12,180 - [*] loss:0.5519
2023-09-07 01:31:12,240 - [*] phase 0, testing
2023-09-07 01:31:13,127 - T:720	MAE	0.487511	RMSE	0.551826	MAPE	254.672241
2023-09-07 01:31:13,128 - 720	mae	0.4875	
2023-09-07 01:31:13,128 - 720	rmse	0.5518	
2023-09-07 01:31:13,128 - 720	mape	254.6722	
