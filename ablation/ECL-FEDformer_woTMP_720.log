2023-09-07 04:44:17,707 - logger name:exp/ECL-FEDformer2023-09-07-04:44:17.707148/ECL-FEDformer.log
2023-09-07 04:44:17,707 - params : {'loss': 'huber', 'conf': 'ECL-FEDformer', 'data_name': 'ETTm1', 'iteration': 1, 'train': 1, 'mainrs': 0, 'abl': 0, 'abl_tmp_context': 0, 'abl_ae': 0, 'no_tmp': 1, 'load': True, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'lr': 0.0001, 'lradj': 'TST', 'dropout': 0.05, 'fc_dropout': 0.05, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'd_ff': 512, 'd_model': 128, 'n_heads': 8, 'seq_len': 96, 'pred_len': 720, 'noise_rate': 0.5, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-26-13:08:31.837686/0/best_model.pkl', 'idx': -1, 'aligner': 1, 'always_align': 1, 'refiner': 1, 'rec_block_num': 1, 'enhance': 1, 'enhance_type': 5, 'seed': 34, 'batch_size': 64, 'share_head': 0, 'add_noise': 1, 'add_norm': 0, 'jitter_sigma': 0.4, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 0, 'debugger': 0, 'summary': 0, 'omega': 1.0, 'theta': 1.5, 'mask_border': 1, 'sup_weight': 10.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 1, 'add_FFN': 1, 'add_residual': 0, 'rec_all': 0, 'e_layers': 2, 'early_break': 0, 'early_stop': 10, '/* model related args*/': '//', 'model_name': 'FEDformer', 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 1, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'distil': 1, 'linear_output': 0, 'pct_start': 0.2, 'num_kernels': 6, 'top_k': 5, 'moving_avg': 25, 'indie': 0, '/*train related args*/': '//', 'epoch': 30, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': -1, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-FEDformer', 'time': '2023-09-07-04:44:17.707148', 'path': 'exp/ECL-FEDformer2023-09-07-04:44:17.707148', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-09-07 04:44:17,707 - [*] phase 0 start training
0 69680
train 33745
val 10801
test 10801
2023-09-07 04:44:18,532 - [*] phase 0 Dataset load!
dropout 0.05
dropout 0.05
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 6, 7, 8, 9, 10, 12, 13, 15, 16, 17, 19, 22, 23, 24, 26, 27, 28, 30, 31, 34, 37, 39, 40, 43, 44, 45, 46, 47]
fourier enhanced block used!
modes=32, index=[19, 50, 63, 81, 83, 95, 104, 110, 124, 134, 144, 156, 162, 191, 204, 218, 244, 249, 250, 252, 259, 277, 278, 306, 312, 321, 322, 323, 336, 357, 367, 377]
 fourier enhanced cross attention used!
modes_q=32, index_q=[5, 6, 18, 37, 47, 68, 80, 112, 129, 153, 167, 195, 201, 220, 225, 229, 232, 239, 249, 250, 294, 296, 299, 315, 328, 344, 347, 350, 353, 358, 362, 376]
modes_kv=32, index_kv=[0, 2, 3, 5, 6, 8, 10, 11, 12, 14, 16, 17, 18, 20, 21, 22, 23, 24, 26, 28, 29, 32, 33, 34, 37, 38, 40, 42, 44, 45, 46, 47]
1 True None
2023-09-07 04:44:18,668 - [*] phase 0 Training start
train 33745
2023-09-07 04:46:58,208 - epoch:0, training loss:0.3790 validation loss:0.5115
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.5114594254444337 0.5134897951543684
Updating learning rate to 1.0434756630121772e-05
Updating learning rate to 1.0434756630121772e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4544913383013398 0.45842692247156563
need align? ->  False 0.45842692247156563
2023-09-07 04:55:35,077 - epoch:1, training loss:16.5299 validation loss:0.4545
Updating learning rate to 2.801377265011639e-05
Updating learning rate to 2.801377265011639e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4462733393942816 0.44865995491221106
need align? ->  False 0.44865995491221106
2023-09-07 05:02:00,087 - epoch:2, training loss:14.1773 validation loss:0.4463
Updating learning rate to 5.202385264808068e-05
Updating learning rate to 5.202385264808068e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.40869234696295137 0.43403098141476953
need align? ->  False 0.43403098141476953
2023-09-07 05:08:26,024 - epoch:3, training loss:9.9696 validation loss:0.4087
Updating learning rate to 7.602753739665399e-05
Updating learning rate to 7.602753739665399e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3988699252171629 0.4119641037999526
need align? ->  False 0.4119641037999526
2023-09-07 05:14:52,346 - epoch:4, training loss:6.6208 validation loss:0.3989
Updating learning rate to 9.358908232986824e-05
Updating learning rate to 9.358908232986824e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.39319262988644943 0.4064126074225945
need align? ->  False 0.4064126074225945
2023-09-07 05:21:17,951 - epoch:5, training loss:5.3602 validation loss:0.3932
Updating learning rate to 9.999999845760966e-05
Updating learning rate to 9.999999845760966e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.39028629431357753 0.4013041446988399
need align? ->  False 0.4013041446988399
2023-09-07 05:27:43,537 - epoch:6, training loss:4.8398 validation loss:0.3903
Updating learning rate to 9.957062220971791e-05
Updating learning rate to 9.957062220971791e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.38852244985879525 0.3975612202868659
need align? ->  False 0.3975612202868659
2023-09-07 05:34:07,610 - epoch:7, training loss:4.5446 validation loss:0.3885
Updating learning rate to 9.829308229430039e-05
Updating learning rate to 9.829308229430039e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3869246122752421 0.3953187697120672
need align? ->  False 0.3953187697120672
2023-09-07 05:40:33,055 - epoch:8, training loss:4.3587 validation loss:0.3869
Updating learning rate to 9.618923777351089e-05
Updating learning rate to 9.618923777351089e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3857541022127902 0.39372761371220355
need align? ->  False 0.39372761371220355
2023-09-07 05:46:58,430 - epoch:9, training loss:4.2306 validation loss:0.3858
Updating learning rate to 9.329508601039598e-05
Updating learning rate to 9.329508601039598e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3840216230270425 0.3926548702124308
need align? ->  False 0.3926548702124308
2023-09-07 05:53:24,926 - epoch:10, training loss:4.1398 validation loss:0.3840
Updating learning rate to 8.966014674403308e-05
Updating learning rate to 8.966014674403308e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3840023236867239 0.39170654558923823
need align? ->  False 0.39170654558923823
2023-09-07 05:59:49,791 - epoch:11, training loss:4.0768 validation loss:0.3840
Updating learning rate to 8.534661479306515e-05
Updating learning rate to 8.534661479306515e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.38229888673188417 0.39123492903963347
need align? ->  False 0.39123492903963347
2023-09-07 06:06:14,611 - epoch:12, training loss:4.0384 validation loss:0.3823
Updating learning rate to 8.04282958851103e-05
Updating learning rate to 8.04282958851103e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37976761832392425 0.390190188348646
need align? ->  False 0.390190188348646
2023-09-07 06:12:40,574 - epoch:13, training loss:4.0117 validation loss:0.3798
Updating learning rate to 7.498934382029921e-05
Updating learning rate to 7.498934382029921e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37988914443543675 0.3895426036338129
need align? ->  False 0.3895426036338129
2023-09-07 06:19:07,180 - epoch:14, training loss:3.9937 validation loss:0.3799
Updating learning rate to 6.912282057642325e-05
Updating learning rate to 6.912282057642325e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3783924360511571 0.3889354764974329
need align? ->  False 0.3889354764974329
2023-09-07 06:25:33,478 - epoch:15, training loss:3.9816 validation loss:0.3784
Updating learning rate to 6.292910399269261e-05
Updating learning rate to 6.292910399269261e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37750695676669566 0.3881131146962826
need align? ->  False 0.3881131146962826
2023-09-07 06:31:58,530 - epoch:16, training loss:3.9738 validation loss:0.3775
Updating learning rate to 5.651417027707762e-05
Updating learning rate to 5.651417027707762e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37744760019539375 0.38758801501354523
need align? ->  False 0.38758801501354523
2023-09-07 06:38:23,737 - epoch:17, training loss:3.9686 validation loss:0.3774
Updating learning rate to 4.998778072400808e-05
Updating learning rate to 4.998778072400808e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37661044105622893 0.3861337027253484
need align? ->  False 0.3861337027253484
2023-09-07 06:44:49,965 - epoch:18, training loss:3.9641 validation loss:0.3766
Updating learning rate to 4.346160366819404e-05
Updating learning rate to 4.346160366819404e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37576140732278485 0.3854757792498233
need align? ->  False 0.3854757792498233
2023-09-07 06:51:14,991 - epoch:19, training loss:3.9628 validation loss:0.3758
Updating learning rate to 3.704730380845859e-05
Updating learning rate to 3.704730380845859e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3760796493503469 0.3846863047963769
need align? ->  False 0.3846863047963769
2023-09-07 06:57:40,742 - epoch:20, training loss:3.9599 validation loss:0.3761
Updating learning rate to 3.0854631593781676e-05
Updating learning rate to 3.0854631593781676e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3759554877171855 0.38503382597449265
need align? ->  False 0.3846863047963769
2023-09-07 07:04:05,355 - epoch:21, training loss:3.9587 validation loss:0.3760
Updating learning rate to 2.4989545362689562e-05
Updating learning rate to 2.4989545362689562e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3753179738948331 0.3844981862331283
need align? ->  False 0.3844981862331283
2023-09-07 07:10:30,681 - epoch:22, training loss:3.9575 validation loss:0.3753
Updating learning rate to 1.955239836670534e-05
Updating learning rate to 1.955239836670534e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37581957744423455 0.3843666511262662
need align? ->  False 0.3843666511262662
2023-09-07 07:16:57,178 - epoch:23, training loss:3.9574 validation loss:0.3758
Updating learning rate to 1.4636221698392234e-05
Updating learning rate to 1.4636221698392234e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37559722253733135 0.38442398854614007
need align? ->  False 0.3843666511262662
2023-09-07 07:23:22,704 - epoch:24, training loss:3.9551 validation loss:0.3756
Updating learning rate to 1.032513250356674e-05
Updating learning rate to 1.032513250356674e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.375203699049865 0.3842251022186505
need align? ->  False 0.3842251022186505
2023-09-07 07:29:48,617 - epoch:25, training loss:3.9550 validation loss:0.3752
Updating learning rate to 6.692894713612099e-06
Updating learning rate to 6.692894713612099e-06
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37525816164778536 0.38408374019275754
need align? ->  False 0.38408374019275754
2023-09-07 07:36:16,449 - epoch:26, training loss:3.9547 validation loss:0.3753
Updating learning rate to 3.8016569241609722e-06
Updating learning rate to 3.8016569241609722e-06
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3752241445451798 0.3840735646835446
need align? ->  False 0.3840735646835446
2023-09-07 07:42:43,992 - epoch:27, training loss:3.9548 validation loss:0.3752
Updating learning rate to 1.7008890153934266e-06
Updating learning rate to 1.7008890153934266e-06
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3752268493704542 0.3840674972657621
need align? ->  False 0.3840674972657621
2023-09-07 07:49:10,834 - epoch:28, training loss:3.9557 validation loss:0.3752
Updating learning rate to 4.2653570867139204e-07
Updating learning rate to 4.2653570867139204e-07
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3752287310167883 0.38406491054762043
need align? ->  False 0.38406491054762043
2023-09-07 07:55:36,629 - epoch:29, training loss:3.9545 validation loss:0.3752
Updating learning rate to 4.015423903575793e-10
Updating learning rate to 4.015423903575793e-10
dropout 0.05
dropout 0.05
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 14, 18, 19, 20, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 41, 42, 43, 45]
fourier enhanced block used!
modes=32, index=[23, 25, 44, 54, 63, 74, 93, 117, 135, 152, 154, 176, 181, 182, 200, 201, 248, 252, 261, 267, 310, 314, 322, 324, 342, 345, 347, 349, 361, 366, 372, 375]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 4, 18, 21, 49, 58, 91, 97, 99, 158, 170, 172, 173, 176, 189, 190, 219, 236, 239, 240, 244, 266, 279, 281, 290, 291, 292, 308, 342, 355, 372, 375]
modes_kv=32, index_kv=[0, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 18, 21, 23, 26, 27, 28, 29, 30, 34, 36, 37, 38, 39, 40, 42, 43, 45, 46, 47]
check exp/ECL-FEDformer2023-09-07-04:44:17.707148/0/0.3752_epoch_25.pkl  &  0.38406491054762043
2023-09-07 07:55:47,079 - [*] loss:0.6470
2023-09-07 07:55:47,151 - [*] phase 0, testing
2023-09-07 07:55:48,035 - T:720	MAE	0.535381	RMSE	0.646691	MAPE	279.853034
2023-09-07 07:55:48,035 - 720	mae	0.5354	
2023-09-07 07:55:48,035 - 720	rmse	0.6467	
2023-09-07 07:55:48,036 - 720	mape	279.8530	
2023-09-07 07:55:57,981 - [*] loss:0.6470
2023-09-07 07:55:58,043 - [*] phase 0, testing
2023-09-07 07:55:58,870 - T:720	MAE	0.535381	RMSE	0.646690	MAPE	279.852867
2023-09-07 07:56:09,178 - [*] loss:0.6470
2023-09-07 07:56:09,241 - [*] phase 0, testing
2023-09-07 07:56:10,089 - T:720	MAE	0.535381	RMSE	0.646691	MAPE	279.853034
2023-09-07 07:56:20,072 - [*] loss:0.5489
2023-09-07 07:56:20,131 - [*] phase 0, testing
2023-09-07 07:56:20,986 - T:720	MAE	0.486484	RMSE	0.548768	MAPE	256.518054
2023-09-07 07:56:20,987 - 720	mae	0.4865	
2023-09-07 07:56:20,987 - 720	rmse	0.5488	
2023-09-07 07:56:20,987 - 720	mape	256.5181	
