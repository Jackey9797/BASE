2023-09-07 01:31:15,089 - logger name:exp/ECL-FEDformer2023-09-07-01:31:15.089741/ECL-FEDformer.log
2023-09-07 01:31:15,090 - params : {'loss': 'huber', 'conf': 'ECL-FEDformer', 'data_name': 'ETTm1', 'iteration': 1, 'train': 1, 'mainrs': 0, 'abl': 0, 'abl_tmp_context': 0, 'abl_ae': 0, 'no_tmp': 0, 'load': True, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'lr': 0.0001, 'lradj': 'TST', 'dropout': 0.05, 'fc_dropout': 0.05, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'd_ff': 512, 'd_model': 128, 'n_heads': 8, 'seq_len': 96, 'pred_len': 720, 'noise_rate': 0.5, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-26-13:08:31.837686/0/best_model.pkl', 'idx': -1, 'aligner': 1, 'always_align': 1, 'refiner': 1, 'rec_block_num': 1, 'enhance': 1, 'enhance_type': 5, 'seed': 34, 'batch_size': 64, 'share_head': 0, 'add_noise': 1, 'add_norm': 0, 'jitter_sigma': 0.4, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 0, 'debugger': 0, 'summary': 0, 'omega': 1.0, 'theta': 1.5, 'mask_border': 1, 'sup_weight': 0.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 1, 'add_FFN': 1, 'add_residual': 0, 'rec_all': 0, 'e_layers': 2, 'early_break': 0, 'early_stop': 10, '/* model related args*/': '//', 'model_name': 'FEDformer', 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 1, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'distil': 1, 'linear_output': 0, 'pct_start': 0.2, 'num_kernels': 6, 'top_k': 5, 'moving_avg': 25, 'indie': 0, '/*train related args*/': '//', 'epoch': 30, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': -1, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-FEDformer', 'time': '2023-09-07-01:31:15.089741', 'path': 'exp/ECL-FEDformer2023-09-07-01:31:15.089741', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-09-07 01:31:15,090 - [*] phase 0 start training
0 69680
train 33745
val 10801
test 10801
2023-09-07 01:31:15,951 - [*] phase 0 Dataset load!
dropout 0.05
dropout 0.05
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 6, 7, 8, 9, 10, 12, 13, 15, 16, 17, 19, 22, 23, 24, 26, 27, 28, 30, 31, 34, 37, 39, 40, 43, 44, 45, 46, 47]
fourier enhanced block used!
modes=32, index=[19, 50, 63, 81, 83, 95, 104, 110, 124, 134, 144, 156, 162, 191, 204, 218, 244, 249, 250, 252, 259, 277, 278, 306, 312, 321, 322, 323, 336, 357, 367, 377]
 fourier enhanced cross attention used!
modes_q=32, index_q=[5, 6, 18, 37, 47, 68, 80, 112, 129, 153, 167, 195, 201, 220, 225, 229, 232, 239, 249, 250, 294, 296, 299, 315, 328, 344, 347, 350, 353, 358, 362, 376]
modes_kv=32, index_kv=[0, 2, 3, 5, 6, 8, 10, 11, 12, 14, 16, 17, 18, 20, 21, 22, 23, 24, 26, 28, 29, 32, 33, 34, 37, 38, 40, 42, 44, 45, 46, 47]
1 True None
2023-09-07 01:31:16,088 - [*] phase 0 Training start
train 33745
2023-09-07 01:33:55,922 - epoch:0, training loss:0.3790 validation loss:0.5115
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.5114594250917435 0.5134897967414743
Updating learning rate to 1.0434756630121772e-05
Updating learning rate to 1.0434756630121772e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.45449210888535313 0.45842666879913513
need align? ->  False 0.45842666879913513
2023-09-07 01:42:33,831 - epoch:1, training loss:6.6847 validation loss:0.4545
Updating learning rate to 2.801377265011639e-05
Updating learning rate to 2.801377265011639e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4462685041438193 0.4486604806851353
need align? ->  False 0.4486604806851353
2023-09-07 01:49:01,391 - epoch:2, training loss:5.5177 validation loss:0.4463
Updating learning rate to 5.202385264808068e-05
Updating learning rate to 5.202385264808068e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.40871407096026213 0.43402336343858366
need align? ->  False 0.43402336343858366
2023-09-07 01:55:28,688 - epoch:3, training loss:4.9159 validation loss:0.4087
Updating learning rate to 7.602753739665399e-05
Updating learning rate to 7.602753739665399e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.398926343438188 0.4120142946581869
need align? ->  False 0.4120142946581869
2023-09-07 02:01:56,105 - epoch:4, training loss:4.5677 validation loss:0.3989
Updating learning rate to 9.358908232986824e-05
Updating learning rate to 9.358908232986824e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.39317801603551444 0.40640793820104654
need align? ->  False 0.40640793820104654
2023-09-07 02:08:23,678 - epoch:5, training loss:4.3626 validation loss:0.3932
Updating learning rate to 9.999999845760966e-05
Updating learning rate to 9.999999845760966e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3902660147149182 0.40127414315057225
need align? ->  False 0.40127414315057225
2023-09-07 02:14:51,169 - epoch:6, training loss:4.2209 validation loss:0.3903
Updating learning rate to 9.957062220971791e-05
Updating learning rate to 9.957062220971791e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3884920838933725 0.3974867396982464
need align? ->  False 0.3974867396982464
2023-09-07 02:21:18,020 - epoch:7, training loss:4.1197 validation loss:0.3885
Updating learning rate to 9.829308229430039e-05
Updating learning rate to 9.829308229430039e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.38689678589973225 0.39538200208421287
need align? ->  False 0.39538200208421287
2023-09-07 02:27:44,146 - epoch:8, training loss:4.0452 validation loss:0.3869
Updating learning rate to 9.618923777351089e-05
Updating learning rate to 9.618923777351089e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3856971992190773 0.3937301094362722
need align? ->  False 0.3937301094362722
2023-09-07 02:34:11,102 - epoch:9, training loss:3.9904 validation loss:0.3857
Updating learning rate to 9.329508601039598e-05
Updating learning rate to 9.329508601039598e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3839258316176883 0.39263992743379267
need align? ->  False 0.39263992743379267
2023-09-07 02:40:38,763 - epoch:10, training loss:3.9520 validation loss:0.3839
Updating learning rate to 8.966014674403308e-05
Updating learning rate to 8.966014674403308e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3839438837572668 0.3916947518491886
need align? ->  False 0.3916947518491886
2023-09-07 02:47:04,816 - epoch:11, training loss:3.9257 validation loss:0.3839
Updating learning rate to 8.534661479306515e-05
Updating learning rate to 8.534661479306515e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.38205213655205167 0.3912356476018415
need align? ->  False 0.3912356476018415
2023-09-07 02:53:32,019 - epoch:12, training loss:3.9100 validation loss:0.3821
Updating learning rate to 8.04282958851103e-05
Updating learning rate to 8.04282958851103e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3796103219308797 0.39011279467118565
need align? ->  False 0.39011279467118565
2023-09-07 02:59:59,767 - epoch:13, training loss:3.8982 validation loss:0.3796
Updating learning rate to 7.498934382029921e-05
Updating learning rate to 7.498934382029921e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37972141083704647 0.3894533077640646
need align? ->  False 0.3894533077640646
2023-09-07 03:06:27,588 - epoch:14, training loss:3.8902 validation loss:0.3797
Updating learning rate to 6.912282057642325e-05
Updating learning rate to 6.912282057642325e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37827123168128485 0.3889033063452625
need align? ->  False 0.3889033063452625
2023-09-07 03:12:54,940 - epoch:15, training loss:3.8857 validation loss:0.3783
Updating learning rate to 6.292910399269261e-05
Updating learning rate to 6.292910399269261e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37749357433361413 0.38810169784980414
need align? ->  False 0.38810169784980414
2023-09-07 03:19:21,705 - epoch:16, training loss:3.8817 validation loss:0.3775
Updating learning rate to 5.651417027707762e-05
Updating learning rate to 5.651417027707762e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3773907950291267 0.38752524863333393
need align? ->  False 0.38752524863333393
2023-09-07 03:25:49,932 - epoch:17, training loss:3.8778 validation loss:0.3774
Updating learning rate to 4.998778072400808e-05
Updating learning rate to 4.998778072400808e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3765734772269542 0.38616476750232764
need align? ->  False 0.38616476750232764
2023-09-07 03:32:19,342 - epoch:18, training loss:3.8737 validation loss:0.3766
Updating learning rate to 4.346160366819404e-05
Updating learning rate to 4.346160366819404e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37562437007236765 0.3854996384777261
need align? ->  False 0.3854996384777261
2023-09-07 03:38:47,154 - epoch:19, training loss:3.8723 validation loss:0.3756
Updating learning rate to 3.704730380845859e-05
Updating learning rate to 3.704730380845859e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3760193757404237 0.3847602904724651
need align? ->  False 0.3847602904724651
2023-09-07 03:45:14,490 - epoch:20, training loss:3.8704 validation loss:0.3760
Updating learning rate to 3.0854631593781676e-05
Updating learning rate to 3.0854631593781676e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.375864231022152 0.38505983983094877
need align? ->  False 0.3847602904724651
2023-09-07 03:51:41,825 - epoch:21, training loss:3.8676 validation loss:0.3759
Updating learning rate to 2.4989545362689562e-05
Updating learning rate to 2.4989545362689562e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3752526073942523 0.38449434618625417
need align? ->  False 0.38449434618625417
2023-09-07 03:58:10,890 - epoch:22, training loss:3.8667 validation loss:0.3753
Updating learning rate to 1.955239836670534e-05
Updating learning rate to 1.955239836670534e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37575052308260337 0.38437648884643466
need align? ->  False 0.38437648884643466
2023-09-07 04:04:39,477 - epoch:23, training loss:3.8656 validation loss:0.3758
Updating learning rate to 1.4636221698392234e-05
Updating learning rate to 1.4636221698392234e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3755816177150907 0.3844464397024826
need align? ->  False 0.38437648884643466
2023-09-07 04:11:07,045 - epoch:24, training loss:3.8642 validation loss:0.3756
Updating learning rate to 1.032513250356674e-05
Updating learning rate to 1.032513250356674e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37517717515928506 0.3842074363630199
need align? ->  False 0.3842074363630199
2023-09-07 04:17:35,026 - epoch:25, training loss:3.8628 validation loss:0.3752
Updating learning rate to 6.692894713612099e-06
Updating learning rate to 6.692894713612099e-06
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37520417438808984 0.38409796286616804
need align? ->  False 0.38409796286616804
2023-09-07 04:24:03,301 - epoch:26, training loss:3.8631 validation loss:0.3752
Updating learning rate to 3.8016569241609722e-06
Updating learning rate to 3.8016569241609722e-06
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3751765738665705 0.38407413379327787
need align? ->  False 0.38407413379327787
2023-09-07 04:30:31,298 - epoch:27, training loss:3.8640 validation loss:0.3752
Updating learning rate to 1.7008890153934266e-06
Updating learning rate to 1.7008890153934266e-06
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3751792114161881 0.3840550819533111
need align? ->  False 0.3840550819533111
2023-09-07 04:37:01,452 - epoch:28, training loss:3.8641 validation loss:0.3752
Updating learning rate to 4.2653570867139204e-07
Updating learning rate to 4.2653570867139204e-07
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37517992468804295 0.3840537846705617
need align? ->  False 0.3840537846705617
2023-09-07 04:43:30,191 - epoch:29, training loss:3.8631 validation loss:0.3752
Updating learning rate to 4.015423903575793e-10
Updating learning rate to 4.015423903575793e-10
dropout 0.05
dropout 0.05
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 14, 18, 19, 20, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 41, 42, 43, 45]
fourier enhanced block used!
modes=32, index=[23, 25, 44, 54, 63, 74, 93, 117, 135, 152, 154, 176, 181, 182, 200, 201, 248, 252, 261, 267, 310, 314, 322, 324, 342, 345, 347, 349, 361, 366, 372, 375]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 4, 18, 21, 49, 58, 91, 97, 99, 158, 170, 172, 173, 176, 189, 190, 219, 236, 239, 240, 244, 266, 279, 281, 290, 291, 292, 308, 342, 355, 372, 375]
modes_kv=32, index_kv=[0, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 18, 21, 23, 26, 27, 28, 29, 30, 34, 36, 37, 38, 39, 40, 42, 43, 45, 46, 47]
check exp/ECL-FEDformer2023-09-07-01:31:15.089741/0/0.3752_epoch_27.pkl  &  0.3840537846705617
2023-09-07 04:43:41,058 - [*] loss:0.6480
2023-09-07 04:43:41,120 - [*] phase 0, testing
2023-09-07 04:43:41,995 - T:720	MAE	0.536421	RMSE	0.647703	MAPE	281.474400
2023-09-07 04:43:41,996 - 720	mae	0.5364	
2023-09-07 04:43:41,996 - 720	rmse	0.6477	
2023-09-07 04:43:41,996 - 720	mape	281.4744	
2023-09-07 04:43:52,223 - [*] loss:0.6480
2023-09-07 04:43:52,284 - [*] phase 0, testing
2023-09-07 04:43:53,152 - T:720	MAE	0.536420	RMSE	0.647701	MAPE	281.474376
2023-09-07 04:44:03,933 - [*] loss:0.6480
2023-09-07 04:44:03,992 - [*] phase 0, testing
2023-09-07 04:44:04,849 - T:720	MAE	0.536421	RMSE	0.647703	MAPE	281.474400
2023-09-07 04:44:14,760 - [*] loss:0.5488
2023-09-07 04:44:14,821 - [*] phase 0, testing
2023-09-07 04:44:15,706 - T:720	MAE	0.486338	RMSE	0.548680	MAPE	256.340837
2023-09-07 04:44:15,707 - 720	mae	0.4863	
2023-09-07 04:44:15,707 - 720	rmse	0.5487	
2023-09-07 04:44:15,707 - 720	mape	256.3408	
