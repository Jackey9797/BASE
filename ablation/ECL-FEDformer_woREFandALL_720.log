2023-09-06 19:00:35,034 - logger name:exp/ECL-FEDformer2023-09-06-19:00:35.034293/ECL-FEDformer.log
2023-09-06 19:00:35,034 - params : {'loss': 'huber', 'conf': 'ECL-FEDformer', 'data_name': 'ETTm1', 'iteration': 1, 'train': 1, 'mainrs': 0, 'abl': 0, 'abl_tmp_context': 0, 'abl_ae': 0, 'no_tmp': 0, 'load': True, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'lr': 0.0001, 'lradj': 'TST', 'dropout': 0.05, 'fc_dropout': 0.05, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'd_ff': 512, 'd_model': 128, 'n_heads': 8, 'seq_len': 96, 'pred_len': 720, 'noise_rate': 0.5, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-26-13:08:31.837686/0/best_model.pkl', 'idx': -1, 'aligner': 1, 'always_align': 1, 'refiner': 1, 'rec_block_num': 1, 'enhance': 1, 'enhance_type': 5, 'seed': 34, 'batch_size': 64, 'share_head': 0, 'add_noise': 1, 'add_norm': 0, 'jitter_sigma': 0.4, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 0, 'debugger': 0, 'summary': 0, 'omega': 1.0, 'theta': 1.5, 'mask_border': 1, 'sup_weight': 10.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 1, 'add_FFN': 1, 'add_residual': 0, 'rec_all': 0, 'e_layers': 2, 'early_break': 0, 'early_stop': 10, '/* model related args*/': '//', 'model_name': 'FEDformer', 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 1, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'distil': 1, 'linear_output': 0, 'pct_start': 0.2, 'num_kernels': 6, 'top_k': 5, 'moving_avg': 25, 'indie': 0, '/*train related args*/': '//', 'epoch': 30, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': -1, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-FEDformer', 'time': '2023-09-06-19:00:35.034293', 'path': 'exp/ECL-FEDformer2023-09-06-19:00:35.034293', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-09-06 19:00:35,034 - [*] phase 0 start training
0 69680
train 33745
val 10801
test 10801
2023-09-06 19:00:35,854 - [*] phase 0 Dataset load!
dropout 0.05
dropout 0.05
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 6, 7, 8, 9, 10, 12, 13, 15, 16, 17, 19, 22, 23, 24, 26, 27, 28, 30, 31, 34, 37, 39, 40, 43, 44, 45, 46, 47]
fourier enhanced block used!
modes=32, index=[19, 50, 63, 81, 83, 95, 104, 110, 124, 134, 144, 156, 162, 191, 204, 218, 244, 249, 250, 252, 259, 277, 278, 306, 312, 321, 322, 323, 336, 357, 367, 377]
 fourier enhanced cross attention used!
modes_q=32, index_q=[5, 6, 18, 37, 47, 68, 80, 112, 129, 153, 167, 195, 201, 220, 225, 229, 232, 239, 249, 250, 294, 296, 299, 315, 328, 344, 347, 350, 353, 358, 362, 376]
modes_kv=32, index_kv=[0, 2, 3, 5, 6, 8, 10, 11, 12, 14, 16, 17, 18, 20, 21, 22, 23, 24, 26, 28, 29, 32, 33, 34, 37, 38, 40, 42, 44, 45, 46, 47]
1 True None
2023-09-06 19:00:36,335 - [*] phase 0 Training start
train 33745
2023-09-06 19:04:56,678 - epoch:0, training loss:0.3790 validation loss:0.5115
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.5114594249153984 0.5134897949780233
Updating learning rate to 1.0434756630121772e-05
Updating learning rate to 1.0434756630121772e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4544921084444904 0.45842666835827234
need align? ->  False 0.45842666835827234
2023-09-06 19:16:34,411 - epoch:1, training loss:16.5133 validation loss:0.4545
Updating learning rate to 2.801377265011639e-05
Updating learning rate to 2.801377265011639e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.4462685065244782 0.44866047918620194
need align? ->  False 0.44866047918620194
2023-09-06 19:25:10,708 - epoch:2, training loss:14.1755 validation loss:0.4463
Updating learning rate to 5.202385264808068e-05
Updating learning rate to 5.202385264808068e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.40871407091617584 0.4340233649375171
need align? ->  False 0.4340233649375171
2023-09-06 19:33:46,035 - epoch:3, training loss:9.9584 validation loss:0.4087
Updating learning rate to 7.602753739665399e-05
Updating learning rate to 7.602753739665399e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3989263441435684 0.4120142966861556
need align? ->  False 0.4120142966861556
2023-09-06 19:42:22,097 - epoch:4, training loss:6.5986 validation loss:0.3989
Updating learning rate to 9.358908232986824e-05
Updating learning rate to 9.358908232986824e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3931780170494988 0.406407940184929
need align? ->  False 0.406407940184929
2023-09-06 19:51:01,119 - epoch:5, training loss:5.3557 validation loss:0.3932
Updating learning rate to 9.999999845760966e-05
Updating learning rate to 9.999999845760966e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3902660147149182 0.4012741414752938
need align? ->  False 0.4012741414752938
2023-09-06 19:59:40,471 - epoch:6, training loss:4.8399 validation loss:0.3903
Updating learning rate to 9.957062220971791e-05
Updating learning rate to 9.957062220971791e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.38849208248261163 0.3974867382433993
need align? ->  False 0.3974867382433993
2023-09-06 20:08:19,097 - epoch:7, training loss:4.5461 validation loss:0.3885
Updating learning rate to 9.829308229430039e-05
Updating learning rate to 9.829308229430039e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3868967841362812 0.3953820038476639
need align? ->  False 0.3953820038476639
2023-09-06 20:16:56,911 - epoch:8, training loss:4.3572 validation loss:0.3869
Updating learning rate to 9.618923777351089e-05
Updating learning rate to 9.618923777351089e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.38569719816100667 0.3937301111997232
need align? ->  False 0.3937301111997232
2023-09-06 20:25:36,079 - epoch:9, training loss:4.2281 validation loss:0.3857
Updating learning rate to 9.329508601039598e-05
Updating learning rate to 9.329508601039598e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3839258247402293 0.3926399251413063
need align? ->  False 0.3926399251413063
2023-09-06 20:34:16,259 - epoch:10, training loss:4.1377 validation loss:0.3839
Updating learning rate to 8.966014674403308e-05
Updating learning rate to 8.966014674403308e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.38394387961315685 0.39169475193736114
need align? ->  False 0.39169475193736114
2023-09-06 20:42:01,925 - epoch:11, training loss:4.0756 validation loss:0.3839
Updating learning rate to 8.534661479306515e-05
Updating learning rate to 8.534661479306515e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.38205210410455276 0.3912356481308768
need align? ->  False 0.3912356481308768
2023-09-06 20:48:32,536 - epoch:12, training loss:4.0374 validation loss:0.3821
Updating learning rate to 8.04282958851103e-05
Updating learning rate to 8.04282958851103e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37961017256657753 0.3901127958615151
need align? ->  False 0.3901127958615151
2023-09-06 20:55:02,069 - epoch:13, training loss:4.0116 validation loss:0.3796
Updating learning rate to 7.498934382029921e-05
Updating learning rate to 7.498934382029921e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3797208732930866 0.38945330895439406
need align? ->  False 0.38945330895439406
2023-09-06 21:01:31,132 - epoch:14, training loss:3.9944 validation loss:0.3797
Updating learning rate to 6.912282057642325e-05
Updating learning rate to 6.912282057642325e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37826931141537323 0.3889033036119134
need align? ->  False 0.3889033036119134
2023-09-06 21:07:59,582 - epoch:15, training loss:3.9836 validation loss:0.3783
Updating learning rate to 6.292910399269261e-05
Updating learning rate to 6.292910399269261e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37749043583164554 0.38810169542505896
need align? ->  False 0.38810169542505896
2023-09-06 21:14:28,438 - epoch:16, training loss:3.9756 validation loss:0.3775
Updating learning rate to 5.651417027707762e-05
Updating learning rate to 5.651417027707762e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37738557124631644 0.38753094766619645
need align? ->  False 0.38753094766619645
2023-09-06 21:20:56,834 - epoch:17, training loss:3.9691 validation loss:0.3774
Updating learning rate to 4.998778072400808e-05
Updating learning rate to 4.998778072400808e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37656676398931876 0.3861650922859209
need align? ->  False 0.3861650922859209
2023-09-06 21:27:25,825 - epoch:18, training loss:3.9640 validation loss:0.3766
Updating learning rate to 4.346160366819404e-05
Updating learning rate to 4.346160366819404e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37561631180654614 0.3855007640003453
need align? ->  False 0.3855007640003453
2023-09-06 21:33:54,613 - epoch:19, training loss:3.9627 validation loss:0.3756
Updating learning rate to 3.704730380845859e-05
Updating learning rate to 3.704730380845859e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37600837118879576 0.3847603156016423
need align? ->  False 0.3847603156016423
2023-09-06 21:40:24,103 - epoch:20, training loss:3.9613 validation loss:0.3760
Updating learning rate to 3.0854631593781676e-05
Updating learning rate to 3.0854631593781676e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37585422043969646 0.38506338467612067
need align? ->  False 0.3847603156016423
2023-09-06 21:46:52,935 - epoch:21, training loss:3.9592 validation loss:0.3759
Updating learning rate to 2.4989545362689562e-05
Updating learning rate to 2.4989545362689562e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37524004465729527 0.3844888361512557
need align? ->  False 0.3844888361512557
2023-09-06 21:53:23,005 - epoch:22, training loss:3.9594 validation loss:0.3752
Updating learning rate to 1.955239836670534e-05
Updating learning rate to 1.955239836670534e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3757382003954176 0.3843746656144159
need align? ->  False 0.3843746656144159
2023-09-06 21:59:53,275 - epoch:23, training loss:3.9593 validation loss:0.3757
Updating learning rate to 1.4636221698392234e-05
Updating learning rate to 1.4636221698392234e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3755677487458703 0.3844442142272842
need align? ->  False 0.3843746656144159
2023-09-06 22:06:23,690 - epoch:24, training loss:3.9584 validation loss:0.3756
Updating learning rate to 1.032513250356674e-05
Updating learning rate to 1.032513250356674e-05
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3751633540677601 0.3842083790598536
need align? ->  False 0.3842083790598536
2023-09-06 22:12:53,521 - epoch:25, training loss:3.9572 validation loss:0.3752
Updating learning rate to 6.692894713612099e-06
Updating learning rate to 6.692894713612099e-06
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.37519000973221817 0.3841012759497885
need align? ->  False 0.3841012759497885
2023-09-06 22:19:23,933 - epoch:26, training loss:3.9577 validation loss:0.3752
Updating learning rate to 3.8016569241609722e-06
Updating learning rate to 3.8016569241609722e-06
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3751621792125984 0.3840742069764955
need align? ->  False 0.3840742069764955
2023-09-06 22:25:54,593 - epoch:27, training loss:3.9586 validation loss:0.3752
Updating learning rate to 1.7008890153934266e-06
Updating learning rate to 1.7008890153934266e-06
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3751646568172077 0.384053472760161
need align? ->  False 0.384053472760161
2023-09-06 22:32:24,876 - epoch:28, training loss:3.9587 validation loss:0.3752
Updating learning rate to 4.2653570867139204e-07
Updating learning rate to 4.2653570867139204e-07
(33745, 1)
(33745, 1) True
train 33745
vs, vt 0.3751653967171731 0.3840523971872922
need align? ->  False 0.3840523971872922
2023-09-06 22:38:55,563 - epoch:29, training loss:3.9577 validation loss:0.3752
Updating learning rate to 4.015423903575793e-10
Updating learning rate to 4.015423903575793e-10
dropout 0.05
dropout 0.05
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 14, 18, 19, 20, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 41, 42, 43, 45]
fourier enhanced block used!
modes=32, index=[23, 25, 44, 54, 63, 74, 93, 117, 135, 152, 154, 176, 181, 182, 200, 201, 248, 252, 261, 267, 310, 314, 322, 324, 342, 345, 347, 349, 361, 366, 372, 375]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 4, 18, 21, 49, 58, 91, 97, 99, 158, 170, 172, 173, 176, 189, 190, 219, 236, 239, 240, 244, 266, 279, 281, 290, 291, 292, 308, 342, 355, 372, 375]
modes_kv=32, index_kv=[0, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 18, 21, 23, 26, 27, 28, 29, 30, 34, 36, 37, 38, 39, 40, 42, 43, 45, 46, 47]
check exp/ECL-FEDformer2023-09-06-19:00:35.034293/0/0.3752_epoch_27.pkl  &  0.3840523971872922
2023-09-06 22:39:06,432 - [*] loss:0.6480
2023-09-06 22:39:06,493 - [*] phase 0, testing
2023-09-06 22:39:07,352 - T:720	MAE	0.536435	RMSE	0.647717	MAPE	281.481719
2023-09-06 22:39:07,352 - 720	mae	0.5364	
2023-09-06 22:39:07,352 - 720	rmse	0.6477	
2023-09-06 22:39:07,353 - 720	mape	281.4817	
2023-09-06 22:39:17,594 - [*] loss:0.6480
2023-09-06 22:39:17,656 - [*] phase 0, testing
2023-09-06 22:39:18,538 - T:720	MAE	0.536435	RMSE	0.647716	MAPE	281.481814
2023-09-06 22:39:29,314 - [*] loss:0.6480
2023-09-06 22:39:29,376 - [*] phase 0, testing
2023-09-06 22:39:30,254 - T:720	MAE	0.536435	RMSE	0.647717	MAPE	281.481719
2023-09-06 22:39:40,644 - [*] loss:0.5488
2023-09-06 22:39:40,705 - [*] phase 0, testing
2023-09-06 22:39:41,547 - T:720	MAE	0.486336	RMSE	0.548674	MAPE	256.346011
2023-09-06 22:39:41,548 - 720	mae	0.4863	
2023-09-06 22:39:41,548 - 720	rmse	0.5487	
2023-09-06 22:39:41,548 - 720	mape	256.3460	
