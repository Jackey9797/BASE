2023-07-24 23:30:37,091 - logger name:exp/ECL-PatchTST2023-07-24-23:30:37.091512/ECL-PatchTST.log
2023-07-24 23:30:37,092 - params : {'conf': 'ECL-PatchTST', 'data_name': 'ETTh2', 'iteration': 1, 'load': True, 'build_graph': False, 'grad_norm': False, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 96, 'noise_rate': 0.1, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-07-23-21:59:42.618606/0/0.0379_epoch_25.pkl', 'idx': -1, 'aligner': 0, 'refiner': 0, 'enhance': 0, 'seed': 2021, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'e_layers': 3, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'train': True, 'epoch': 30, 'batch_size': 256, 'lr': 0.0001, 'loss': 'mse', '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': 26304, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-07-24-23:30:37.091512', 'path': 'exp/ECL-PatchTST2023-07-24-23:30:37.091512', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-07-24 23:30:37,092 - [*] phase 0 start training
0 26304
train 8209
val 2785
test 2785
2023-07-24 23:30:37,281 - [*] phase 0 Dataset load!
2023-07-24 23:30:38,122 - [*] phase 0 Training start
train 8209
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:30:46,908 - epoch:0, training loss:0.6575 validation loss:0.3277
train 8209
vs, vt 0.32771552286364813 0.33137928355823865
Updating learning rate to 1.0496729249039657e-05
Updating learning rate to 1.0496729249039657e-05
train 8209
vs, vt 0.2598778341304172 0.2682195949283513
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:31:07,308 - epoch:1, training loss:0.7858 validation loss:0.2599
Updating learning rate to 2.822827154052001e-05
Updating learning rate to 2.822827154052001e-05
train 8209
vs, vt 0.23020700094374744 0.23338651724837042
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:31:21,727 - epoch:2, training loss:0.6743 validation loss:0.2302
Updating learning rate to 5.239475064795585e-05
Updating learning rate to 5.239475064795585e-05
train 8209
vs, vt 0.21735601398077878 0.2200196385383606
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:31:36,486 - epoch:3, training loss:0.6080 validation loss:0.2174
Updating learning rate to 7.645437191869786e-05
Updating learning rate to 7.645437191869786e-05
train 8209
vs, vt 0.2113356969573281 0.21614657206968826
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:31:51,367 - epoch:4, training loss:0.5676 validation loss:0.2113
Updating learning rate to 9.389426680147743e-05
Updating learning rate to 9.389426680147743e-05
train 8209
vs, vt 0.210297860882499 0.21306944638490677
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:32:07,058 - epoch:5, training loss:0.5424 validation loss:0.2103
Updating learning rate to 9.999958167389085e-05
Updating learning rate to 9.999958167389085e-05
train 8209
vs, vt 0.20881165157664905 0.214647077023983
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:32:22,136 - epoch:6, training loss:0.5249 validation loss:0.2088
Updating learning rate to 9.954513359086192e-05
Updating learning rate to 9.954513359086192e-05
train 8209
vs, vt 0.21093582158738916 0.21818628839471124
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:32:37,928 - epoch:7, training loss:0.5092 validation loss:0.2109
Updating learning rate to 9.824295795764264e-05
Updating learning rate to 9.824295795764264e-05
train 8209
vs, vt 0.21131514419208874 0.21923337944529273
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:32:53,137 - epoch:8, training loss:0.4943 validation loss:0.2113
Updating learning rate to 9.611533536034865e-05
Updating learning rate to 9.611533536034865e-05
train 8209
vs, vt 0.2105519642884081 0.2171092927455902
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:33:08,702 - epoch:9, training loss:0.4811 validation loss:0.2106
Updating learning rate to 9.319867001150813e-05
Updating learning rate to 9.319867001150813e-05
train 8209
vs, vt 0.21484302187507803 0.21280777860771527
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:33:23,848 - epoch:10, training loss:0.4715 validation loss:0.2148
Updating learning rate to 8.954286686389209e-05
Updating learning rate to 8.954286686389209e-05
train 8209
vs, vt 0.2145035138184374 0.2102390487085689
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:33:39,266 - epoch:11, training loss:0.4636 validation loss:0.2145
Updating learning rate to 8.52104777229364e-05
Updating learning rate to 8.52104777229364e-05
train 8209
vs, vt 0.21544910764152353 0.20918598838827826
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:33:54,723 - epoch:12, training loss:0.4536 validation loss:0.2154
Updating learning rate to 8.027563096800801e-05
Updating learning rate to 8.027563096800801e-05
train 8209
vs, vt 0.21824912185018713 0.2065817198970101
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:34:10,491 - epoch:13, training loss:0.4456 validation loss:0.2182
Updating learning rate to 7.482276319528172e-05
Updating learning rate to 7.482276319528172e-05
train 8209
vs, vt 0.21733696420084347 0.20504935898564078
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:34:25,732 - epoch:14, training loss:0.4401 validation loss:0.2173
Updating learning rate to 6.894517448416947e-05
Updating learning rate to 6.894517448416947e-05
train 8209
vs, vt 0.21666588701985098 0.20685696601867676
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:34:41,044 - epoch:15, training loss:0.4335 validation loss:0.2167
Updating learning rate to 6.274343200709381e-05
Updating learning rate to 6.274343200709381e-05
train 8209
vs, vt 0.2165473604744131 0.21169765429063278
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:34:56,753 - epoch:16, training loss:0.4283 validation loss:0.2165
Updating learning rate to 5.63236492972854e-05
Updating learning rate to 5.63236492972854e-05
train 8209
vs, vt 0.21517921848730606 0.2085625251585787
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:35:12,372 - epoch:17, training loss:0.4240 validation loss:0.2152
Updating learning rate to 4.9795670616809066e-05
Updating learning rate to 4.9795670616809066e-05
train 8209
vs, vt 0.2170276391235265 0.21174105934121393
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:35:28,146 - epoch:18, training loss:0.4188 validation loss:0.2170
Updating learning rate to 4.32711914907854e-05
Updating learning rate to 4.32711914907854e-05
train 8209
vs, vt 0.2183240536939014 0.20911818539554422
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:35:43,114 - epoch:19, training loss:0.4155 validation loss:0.2183
Updating learning rate to 3.6861847565988014e-05
Updating learning rate to 3.6861847565988014e-05
train 8209
vs, vt 0.21699875660917975 0.20930637080561032
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:35:58,511 - epoch:20, training loss:0.4124 validation loss:0.2170
Updating learning rate to 3.0677304493976024e-05
Updating learning rate to 3.0677304493976024e-05
train 8209
vs, vt 0.2162926894697276 0.20817197317426855
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:36:14,279 - epoch:21, training loss:0.4107 validation loss:0.2163
Updating learning rate to 2.4823381521390875e-05
Updating learning rate to 2.4823381521390875e-05
train 8209
vs, vt 0.21664666723121295 0.20979920571500604
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:36:30,201 - epoch:22, training loss:0.4087 validation loss:0.2166
Updating learning rate to 1.940024089330755e-05
Updating learning rate to 1.940024089330755e-05
train 8209
vs, vt 0.217276239937002 0.2094834650104696
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:36:46,124 - epoch:23, training loss:0.4077 validation loss:0.2173
Updating learning rate to 1.4500674049451182e-05
Updating learning rate to 1.4500674049451182e-05
train 8209
vs, vt 0.21692345359108664 0.20858688720247962
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:37:02,195 - epoch:24, training loss:0.4068 validation loss:0.2169
Updating learning rate to 1.020851393693675e-05
Updating learning rate to 1.020851393693675e-05
train 8209
vs, vt 0.21572334658015857 0.20981415361166
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:37:17,724 - epoch:25, training loss:0.4069 validation loss:0.2157
Updating learning rate to 6.597200605300958e-06
Updating learning rate to 6.597200605300958e-06
train 8209
vs, vt 0.21693209558725357 0.20898742973804474
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:37:34,225 - epoch:26, training loss:0.4060 validation loss:0.2169
Updating learning rate to 3.728524626893306e-06
Updating learning rate to 3.728524626893306e-06
train 8209
vs, vt 0.21662007881836456 0.20958019522103397
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:37:49,466 - epoch:27, training loss:0.4055 validation loss:0.2166
Updating learning rate to 1.6515698430516055e-06
Updating learning rate to 1.6515698430516055e-06
train 8209
vs, vt 0.21657937968319113 0.2091998356309804
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:38:05,265 - epoch:28, training loss:0.4049 validation loss:0.2166
Updating learning rate to 4.018735259680286e-07
Updating learning rate to 4.018735259680286e-07
train 8209
vs, vt 0.21672587503086438 0.2090768339959058
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:38:20,951 - epoch:29, training loss:0.4051 validation loss:0.2167
Updating learning rate to 8.18326109158733e-10
Updating learning rate to 8.18326109158733e-10
2023-07-24 23:38:21,978 - [*] loss:0.2903
2023-07-24 23:38:21,982 - [*] phase 0, testing
2023-07-24 23:38:22,019 - T:96  MAE     0.345960        RMSE    0.288729        MAPE    138.226402
2023-07-24 23:38:22,020 - 96    mae     0.3460
2023-07-24 23:38:22,020 - 96    rmse    0.2887
2023-07-24 23:38:22,020 - 96    mape    138.2264

2023-07-24 22:38:45,533 - logger name:exp/ECL-PatchTST2023-07-24-22:38:45.533476/ECL-PatchTST.log
2023-07-24 22:38:45,534 - params : {'conf': 'ECL-PatchTST', 'data_name': 'ETTh2', 'iteration': 1, 'load': True, 'build_graph': False, 'grad_norm': False, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 96, 'noise_rate': 0.1, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-07-23-21:59:42.618606/0/0.0379_epoch_25.pkl', 'idx': -1, 'aligner': 0, 'refiner': 0, 'enhance': 0, 'seed': 2022, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'e_layers': 3, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'train': True, 'epoch': 30, 'batch_size': 256, 'lr': 0.0001, 'loss': 'mse', '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': 26304, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-07-24-22:38:45.533476', 'path': 'exp/ECL-PatchTST2023-07-24-22:38:45.533476', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-07-24 22:38:45,534 - [*] phase 0 start training
0 26304
train 8209
val 2785
test 2785
2023-07-24 22:38:45,721 - [*] phase 0 Dataset load!
2023-07-24 22:38:46,565 - [*] phase 0 Training start
train 8209
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:38:55,307 - epoch:0, training loss:0.6492 validation loss:0.3203
train 8209
vs, vt 0.3202688748186285 0.32369545237584546
Updating learning rate to 1.0496729249039657e-05
Updating learning rate to 1.0496729249039657e-05
train 8209
vs, vt 0.2585969695990736 0.26650418002497067
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:39:15,785 - epoch:1, training loss:0.7816 validation loss:0.2586
Updating learning rate to 2.822827154052001e-05
Updating learning rate to 2.822827154052001e-05
train 8209
vs, vt 0.23081995072689923 0.23359271613034335
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:39:30,142 - epoch:2, training loss:0.6738 validation loss:0.2308
Updating learning rate to 5.239475064795585e-05
Updating learning rate to 5.239475064795585e-05
train 8209
vs, vt 0.21645325219089334 0.218675896525383
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:39:45,218 - epoch:3, training loss:0.6074 validation loss:0.2165
Updating learning rate to 7.645437191869786e-05
Updating learning rate to 7.645437191869786e-05
train 8209
vs, vt 0.21027038178660654 0.21262425116517328
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:40:00,182 - epoch:4, training loss:0.5672 validation loss:0.2103
Updating learning rate to 9.389426680147743e-05
Updating learning rate to 9.389426680147743e-05
train 8209
vs, vt 0.21285338699817657 0.21150716868313876
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:40:15,840 - epoch:5, training loss:0.5434 validation loss:0.2129
Updating learning rate to 9.999958167389085e-05
Updating learning rate to 9.999958167389085e-05
train 8209
vs, vt 0.20753197304227136 0.21477641368454153
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:40:31,637 - epoch:6, training loss:0.5261 validation loss:0.2075
Updating learning rate to 9.954513359086192e-05
Updating learning rate to 9.954513359086192e-05
train 8209
vs, vt 0.20888815278356726 0.21279610625722192
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:40:47,178 - epoch:7, training loss:0.5091 validation loss:0.2089
Updating learning rate to 9.824295795764264e-05
Updating learning rate to 9.824295795764264e-05
train 8209
vs, vt 0.209750389510935 0.21431134708903052
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:41:02,795 - epoch:8, training loss:0.4941 validation loss:0.2098
Updating learning rate to 9.611533536034865e-05
Updating learning rate to 9.611533536034865e-05
train 8209
vs, vt 0.2147845903580839 0.2143978408791802
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:41:18,307 - epoch:9, training loss:0.4795 validation loss:0.2148
Updating learning rate to 9.319867001150813e-05
Updating learning rate to 9.319867001150813e-05
train 8209
vs, vt 0.211696787991307 0.21536339819431305
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:41:33,848 - epoch:10, training loss:0.4682 validation loss:0.2117
Updating learning rate to 8.954286686389209e-05
Updating learning rate to 8.954286686389209e-05
train 8209
vs, vt 0.21192079172893005 0.2052200280807235
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:41:49,180 - epoch:11, training loss:0.4607 validation loss:0.2119
Updating learning rate to 8.52104777229364e-05
Updating learning rate to 8.52104777229364e-05
train 8209
vs, vt 0.21623955463821237 0.2072684791955081
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:42:04,523 - epoch:12, training loss:0.4511 validation loss:0.2162
Updating learning rate to 8.027563096800801e-05
Updating learning rate to 8.027563096800801e-05
train 8209
vs, vt 0.21465870873494583 0.21082412993366068
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:42:20,263 - epoch:13, training loss:0.4424 validation loss:0.2147
Updating learning rate to 7.482276319528172e-05
Updating learning rate to 7.482276319528172e-05
train 8209
vs, vt 0.21465190906416287 0.20787049288099463
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:42:35,547 - epoch:14, training loss:0.4366 validation loss:0.2147
Updating learning rate to 6.894517448416947e-05
Updating learning rate to 6.894517448416947e-05
train 8209
vs, vt 0.21909339793703772 0.20584871010346847
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:42:51,113 - epoch:15, training loss:0.4301 validation loss:0.2191
Updating learning rate to 6.274343200709381e-05
Updating learning rate to 6.274343200709381e-05
train 8209
vs, vt 0.2160994126038118 0.20920297029343518
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:43:06,443 - epoch:16, training loss:0.4255 validation loss:0.2161
Updating learning rate to 5.63236492972854e-05
Updating learning rate to 5.63236492972854e-05
train 8209
vs, vt 0.21668698638677597 0.20632705227895218
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:43:21,900 - epoch:17, training loss:0.4202 validation loss:0.2167
Updating learning rate to 4.9795670616809066e-05
Updating learning rate to 4.9795670616809066e-05
train 8209
vs, vt 0.2162961553443562 0.20639178563248028
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:43:37,215 - epoch:18, training loss:0.4164 validation loss:0.2163
Updating learning rate to 4.32711914907854e-05
Updating learning rate to 4.32711914907854e-05
train 8209
vs, vt 0.21404450725425372 0.2064265717159618
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:43:52,607 - epoch:19, training loss:0.4133 validation loss:0.2140
Updating learning rate to 3.6861847565988014e-05
Updating learning rate to 3.6861847565988014e-05
train 8209
vs, vt 0.21702588281848215 0.20678589289838617
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:44:07,949 - epoch:20, training loss:0.4109 validation loss:0.2170
Updating learning rate to 3.0677304493976024e-05
Updating learning rate to 3.0677304493976024e-05
train 8209
vs, vt 0.21682323583147742 0.20574056492610412
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:44:23,442 - epoch:21, training loss:0.4096 validation loss:0.2168
Updating learning rate to 2.4823381521390875e-05
Updating learning rate to 2.4823381521390875e-05
train 8209
vs, vt 0.21593471548774026 0.20809937133030457
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:44:38,832 - epoch:22, training loss:0.4064 validation loss:0.2159
Updating learning rate to 1.940024089330755e-05
Updating learning rate to 1.940024089330755e-05
train 8209
vs, vt 0.21616082909432324 0.20776356282559308
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:44:54,604 - epoch:23, training loss:0.4070 validation loss:0.2162
Updating learning rate to 1.4500674049451182e-05
Updating learning rate to 1.4500674049451182e-05
train 8209
vs, vt 0.21538678353483026 0.20652646029537375
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:45:10,406 - epoch:24, training loss:0.4049 validation loss:0.2154
Updating learning rate to 1.020851393693675e-05
Updating learning rate to 1.020851393693675e-05
train 8209
vs, vt 0.215096961368214 0.20621654120358554
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:45:27,210 - epoch:25, training loss:0.4033 validation loss:0.2151
Updating learning rate to 6.597200605300958e-06
Updating learning rate to 6.597200605300958e-06
train 8209
vs, vt 0.216030630198392 0.20668649267066608
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:45:42,803 - epoch:26, training loss:0.4037 validation loss:0.2160
Updating learning rate to 3.728524626893306e-06
Updating learning rate to 3.728524626893306e-06
train 8209
vs, vt 0.21546246720985932 0.20664520900357852
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:45:58,114 - epoch:27, training loss:0.4032 validation loss:0.2155
Updating learning rate to 1.6515698430516055e-06
Updating learning rate to 1.6515698430516055e-06
train 8209
vs, vt 0.215550996363163 0.20661371404474432
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:46:13,712 - epoch:28, training loss:0.4028 validation loss:0.2156
Updating learning rate to 4.018735259680286e-07
Updating learning rate to 4.018735259680286e-07
train 8209
vs, vt 0.2157030295241963 0.20666460489684885
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:46:29,514 - epoch:29, training loss:0.4024 validation loss:0.2157
Updating learning rate to 8.18326109158733e-10
Updating learning rate to 8.18326109158733e-10
2023-07-24 22:46:30,566 - [*] loss:0.2864
2023-07-24 22:46:30,569 - [*] phase 0, testing
2023-07-24 22:46:30,607 - T:96  MAE     0.343861        RMSE    0.284820        MAPE    141.007233
2023-07-24 22:46:30,608 - 96    mae     0.3439
2023-07-24 22:46:30,608 - 96    rmse    0.2848
2023-07-24 22:46:30,608 - 96    mape    141.0072

2023-07-24 22:47:22,943 - logger name:exp/ECL-PatchTST2023-07-24-22:47:22.942995/ECL-PatchTST.log
2023-07-24 22:47:22,943 - params : {'conf': 'ECL-PatchTST', 'data_name': 'ETTh2', 'iteration': 1, 'load': True, 'build_graph': False, 'grad_norm': False, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 96, 'noise_rate': 0.1, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-07-23-21:59:42.618606/0/0.0379_epoch_25.pkl', 'idx': -1, 'aligner': 0, 'refiner': 0, 'enhance': 0, 'seed': 2023, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'e_layers': 3, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'train': True, 'epoch': 30, 'batch_size': 256, 'lr': 0.0001, 'loss': 'mse', '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': 26304, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-07-24-22:47:22.942995', 'path': 'exp/ECL-PatchTST2023-07-24-22:47:22.942995', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-07-24 22:47:22,943 - [*] phase 0 start training
0 26304
train 8209
val 2785
test 2785
2023-07-24 22:47:23,132 - [*] phase 0 Dataset load!
2023-07-24 22:47:23,972 - [*] phase 0 Training start
train 8209
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:47:32,876 - epoch:0, training loss:0.6492 validation loss:0.3225
train 8209
vs, vt 0.322538206523115 0.3238361288200725
Updating learning rate to 1.0496729249039657e-05
Updating learning rate to 1.0496729249039657e-05
train 8209
vs, vt 0.25844988091425464 0.26537197015502234
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:47:54,039 - epoch:1, training loss:0.7806 validation loss:0.2584
Updating learning rate to 2.822827154052001e-05
Updating learning rate to 2.822827154052001e-05
train 8209
vs, vt 0.2297133830460635 0.23222109946337613
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:48:09,900 - epoch:2, training loss:0.6723 validation loss:0.2297
Updating learning rate to 5.239475064795585e-05
Updating learning rate to 5.239475064795585e-05
train 8209
vs, vt 0.2168358936905861 0.22040547159585086
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:48:25,542 - epoch:3, training loss:0.6048 validation loss:0.2168
Updating learning rate to 7.645437191869786e-05
Updating learning rate to 7.645437191869786e-05
train 8209
vs, vt 0.21324856647036292 0.21856786175207657
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:48:41,152 - epoch:4, training loss:0.5680 validation loss:0.2132
Updating learning rate to 9.389426680147743e-05
Updating learning rate to 9.389426680147743e-05
train 8209
vs, vt 0.20987487787550146 0.21757941896265204
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:48:56,738 - epoch:5, training loss:0.5436 validation loss:0.2099
Updating learning rate to 9.999958167389085e-05
Updating learning rate to 9.999958167389085e-05
train 8209
vs, vt 0.20988985963843085 0.21529674530029297
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:49:12,528 - epoch:6, training loss:0.5273 validation loss:0.2099
Updating learning rate to 9.954513359086192e-05
Updating learning rate to 9.954513359086192e-05
train 8209
vs, vt 0.20836484296755356 0.2175410809842023
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:49:28,089 - epoch:7, training loss:0.5147 validation loss:0.2084
Updating learning rate to 9.824295795764264e-05
Updating learning rate to 9.824295795764264e-05
train 8209
vs, vt 0.2082065533507954 0.21714230220426212
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:49:43,677 - epoch:8, training loss:0.5002 validation loss:0.2082
Updating learning rate to 9.611533536034865e-05
Updating learning rate to 9.611533536034865e-05
train 8209
vs, vt 0.21096912771463394 0.2164543094960126
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:49:59,384 - epoch:9, training loss:0.4856 validation loss:0.2110
Updating learning rate to 9.319867001150813e-05
Updating learning rate to 9.319867001150813e-05
train 8209
vs, vt 0.21336637301878494 0.2132390561428937
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:50:14,957 - epoch:10, training loss:0.4737 validation loss:0.2134
Updating learning rate to 8.954286686389209e-05
Updating learning rate to 8.954286686389209e-05
train 8209
vs, vt 0.21354955434799194 0.20765746181661432
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:50:30,304 - epoch:11, training loss:0.4654 validation loss:0.2135
Updating learning rate to 8.52104777229364e-05
Updating learning rate to 8.52104777229364e-05
train 8209
vs, vt 0.21453980762850156 0.20763784850185568
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:50:45,812 - epoch:12, training loss:0.4566 validation loss:0.2145
Updating learning rate to 8.027563096800801e-05
Updating learning rate to 8.027563096800801e-05
train 8209
vs, vt 0.21631706912409177 0.20870940522714096
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:51:01,280 - epoch:13, training loss:0.4465 validation loss:0.2163
Updating learning rate to 7.482276319528172e-05
Updating learning rate to 7.482276319528172e-05
train 8209
vs, vt 0.2154544469985095 0.20621964741836896
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:51:16,888 - epoch:14, training loss:0.4398 validation loss:0.2155
Updating learning rate to 6.894517448416947e-05
Updating learning rate to 6.894517448416947e-05
train 8209
vs, vt 0.218137418681925 0.21037370034239508
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:51:33,064 - epoch:15, training loss:0.4342 validation loss:0.2181
Updating learning rate to 6.274343200709381e-05
Updating learning rate to 6.274343200709381e-05
train 8209
vs, vt 0.2165601592172276 0.2093216363679279
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:51:48,900 - epoch:16, training loss:0.4281 validation loss:0.2166
Updating learning rate to 5.63236492972854e-05
Updating learning rate to 5.63236492972854e-05
train 8209
vs, vt 0.21716068346392026 0.20745594596320932
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:52:04,169 - epoch:17, training loss:0.4243 validation loss:0.2172
Updating learning rate to 4.9795670616809066e-05
Updating learning rate to 4.9795670616809066e-05
train 8209
vs, vt 0.2168676040389321 0.20922906493598764
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:52:19,785 - epoch:18, training loss:0.4201 validation loss:0.2169
Updating learning rate to 4.32711914907854e-05
Updating learning rate to 4.32711914907854e-05
train 8209
vs, vt 0.21916186674074692 0.20841124179688367
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:52:35,186 - epoch:19, training loss:0.4159 validation loss:0.2192
Updating learning rate to 3.6861847565988014e-05
Updating learning rate to 3.6861847565988014e-05
train 8209
vs, vt 0.21676110476255417 0.20862090316685764
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:52:50,846 - epoch:20, training loss:0.4138 validation loss:0.2168
Updating learning rate to 3.0677304493976024e-05
Updating learning rate to 3.0677304493976024e-05
train 8209
vs, vt 0.21743971786715768 0.20884738523851742
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:53:06,215 - epoch:21, training loss:0.4108 validation loss:0.2174
Updating learning rate to 2.4823381521390875e-05
Updating learning rate to 2.4823381521390875e-05
train 8209
vs, vt 0.21787322109395807 0.20932138846679169
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:53:21,562 - epoch:22, training loss:0.4097 validation loss:0.2179
Updating learning rate to 1.940024089330755e-05
Updating learning rate to 1.940024089330755e-05
train 8209
vs, vt 0.217394467104565 0.2101199355992404
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:53:37,130 - epoch:23, training loss:0.4079 validation loss:0.2174
Updating learning rate to 1.4500674049451182e-05
Updating learning rate to 1.4500674049451182e-05
train 8209
vs, vt 0.2172078158367764 0.2082545581189069
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:53:52,314 - epoch:24, training loss:0.4067 validation loss:0.2172
Updating learning rate to 1.020851393693675e-05
Updating learning rate to 1.020851393693675e-05
train 8209
vs, vt 0.2171814421361143 0.20791553841395813
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:54:07,807 - epoch:25, training loss:0.4058 validation loss:0.2172
Updating learning rate to 6.597200605300958e-06
Updating learning rate to 6.597200605300958e-06
train 8209
vs, vt 0.21729330108924347 0.20830139924179425
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:54:25,391 - epoch:26, training loss:0.4063 validation loss:0.2173
Updating learning rate to 3.728524626893306e-06
Updating learning rate to 3.728524626893306e-06
train 8209
vs, vt 0.21724989265203476 0.20809217542409897
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:54:41,562 - epoch:27, training loss:0.4051 validation loss:0.2172
Updating learning rate to 1.6515698430516055e-06
Updating learning rate to 1.6515698430516055e-06
train 8209
vs, vt 0.21720197254961188 0.20814902674068103
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:54:57,877 - epoch:28, training loss:0.4056 validation loss:0.2172
Updating learning rate to 4.018735259680286e-07
Updating learning rate to 4.018735259680286e-07
train 8209
vs, vt 0.2170840691436421 0.20817395706068387
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:55:13,572 - epoch:29, training loss:0.4055 validation loss:0.2171
Updating learning rate to 8.18326109158733e-10
Updating learning rate to 8.18326109158733e-10
2023-07-24 22:55:14,554 - [*] loss:0.2943
2023-07-24 22:55:14,558 - [*] phase 0, testing
2023-07-24 22:55:14,594 - T:96  MAE     0.350406        RMSE    0.292590        MAPE    142.467177
2023-07-24 22:55:14,595 - 96    mae     0.3504
2023-07-24 22:55:14,595 - 96    rmse    0.2926
2023-07-24 22:55:14,595 - 96    mape    142.4672

2023-07-24 23:05:43,267 - logger name:exp/ECL-PatchTST2023-07-24-23:05:43.266976/ECL-PatchTST.log
2023-07-24 23:05:43,267 - params : {'conf': 'ECL-PatchTST', 'data_name': 'ETTh2', 'iteration': 1, 'load': True, 'build_graph': False, 'grad_norm': False, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 96, 'noise_rate': 0.1, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-07-23-21:59:42.618606/0/0.0379_epoch_25.pkl', 'idx': -1, 'aligner': 0, 'refiner': 0, 'enhance': 0, 'seed': 2024, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'e_layers': 3, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'train': True, 'epoch': 30, 'batch_size': 256, 'lr': 0.0001, 'loss': 'mse', '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': 26304, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-07-24-23:05:43.266976', 'path': 'exp/ECL-PatchTST2023-07-24-23:05:43.266976', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-07-24 23:05:43,267 - [*] phase 0 start training
0 26304
train 8209
val 2785
test 2785
2023-07-24 23:05:43,455 - [*] phase 0 Dataset load!
2023-07-24 23:05:44,293 - [*] phase 0 Training start
train 8209
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:05:53,170 - epoch:0, training loss:0.6631 validation loss:0.3271
train 8209
vs, vt 0.32713882489637897 0.3270497498187152
Updating learning rate to 1.0496729249039657e-05
Updating learning rate to 1.0496729249039657e-05
train 8209
vs, vt 0.25987169349735434 0.2666072425517169
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:06:14,167 - epoch:1, training loss:0.7860 validation loss:0.2599
Updating learning rate to 2.822827154052001e-05
Updating learning rate to 2.822827154052001e-05
train 8209
vs, vt 0.23216256363825363 0.23464667390693317
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:06:28,713 - epoch:2, training loss:0.6753 validation loss:0.2322
Updating learning rate to 5.239475064795585e-05
Updating learning rate to 5.239475064795585e-05
train 8209
vs, vt 0.21660095046867023 0.21940682151100852
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:06:43,768 - epoch:3, training loss:0.6060 validation loss:0.2166
Updating learning rate to 7.645437191869786e-05
Updating learning rate to 7.645437191869786e-05
train 8209
vs, vt 0.2108146013184027 0.21489409221844238
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:06:59,263 - epoch:4, training loss:0.5667 validation loss:0.2108
Updating learning rate to 9.389426680147743e-05
Updating learning rate to 9.389426680147743e-05
train 8209
vs, vt 0.20877051963047547 0.2143598828803409
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:07:14,654 - epoch:5, training loss:0.5422 validation loss:0.2088
Updating learning rate to 9.999958167389085e-05
Updating learning rate to 9.999958167389085e-05
train 8209
vs, vt 0.2103398327123035 0.2134670384905555
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:07:30,218 - epoch:6, training loss:0.5257 validation loss:0.2103
Updating learning rate to 9.954513359086192e-05
Updating learning rate to 9.954513359086192e-05
train 8209
vs, vt 0.21250615404410797 0.21737165749073029
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:07:45,423 - epoch:7, training loss:0.5111 validation loss:0.2125
Updating learning rate to 9.824295795764264e-05
Updating learning rate to 9.824295795764264e-05
train 8209
vs, vt 0.2092620303685015 0.21723722192374142
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:08:00,609 - epoch:8, training loss:0.4968 validation loss:0.2093
Updating learning rate to 9.611533536034865e-05
Updating learning rate to 9.611533536034865e-05
train 8209
vs, vt 0.20905927433208985 0.21236511726271023
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:08:16,279 - epoch:9, training loss:0.4843 validation loss:0.2091
Updating learning rate to 9.319867001150813e-05
Updating learning rate to 9.319867001150813e-05
train 8209
vs, vt 0.2109249559315768 0.2102546055208553
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:08:31,288 - epoch:10, training loss:0.4740 validation loss:0.2109
Updating learning rate to 8.954286686389209e-05
Updating learning rate to 8.954286686389209e-05
train 8209
vs, vt 0.2139556103131988 0.2103096368637952
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:08:46,926 - epoch:11, training loss:0.4650 validation loss:0.2140
Updating learning rate to 8.52104777229364e-05
Updating learning rate to 8.52104777229364e-05
train 8209
vs, vt 0.2147640890695832 0.21115202388980173
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:09:01,826 - epoch:12, training loss:0.4541 validation loss:0.2148
Updating learning rate to 8.027563096800801e-05
Updating learning rate to 8.027563096800801e-05
train 8209
vs, vt 0.2151435369795019 0.20877299119125714
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:09:17,392 - epoch:13, training loss:0.4479 validation loss:0.2151
Updating learning rate to 7.482276319528172e-05
Updating learning rate to 7.482276319528172e-05
train 8209
vs, vt 0.21886501596732574 0.2089516114104878
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:09:32,785 - epoch:14, training loss:0.4398 validation loss:0.2189
Updating learning rate to 6.894517448416947e-05
Updating learning rate to 6.894517448416947e-05
train 8209
vs, vt 0.21702218123457648 0.2112452591007406
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:09:47,729 - epoch:15, training loss:0.4330 validation loss:0.2170
Updating learning rate to 6.274343200709381e-05
Updating learning rate to 6.274343200709381e-05
train 8209
vs, vt 0.21607380699027667 0.20934703607450833
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:10:03,115 - epoch:16, training loss:0.4285 validation loss:0.2161
Updating learning rate to 5.63236492972854e-05
Updating learning rate to 5.63236492972854e-05
train 8209
vs, vt 0.21488552540540695 0.208911807699637
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:10:18,414 - epoch:17, training loss:0.4252 validation loss:0.2149
Updating learning rate to 4.9795670616809066e-05
Updating learning rate to 4.9795670616809066e-05
train 8209
vs, vt 0.2166530340909958 0.20911971615119415
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:10:33,786 - epoch:18, training loss:0.4199 validation loss:0.2167
Updating learning rate to 4.32711914907854e-05
Updating learning rate to 4.32711914907854e-05
train 8209
vs, vt 0.2189466424963691 0.20948469842022116
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:10:49,099 - epoch:19, training loss:0.4175 validation loss:0.2189
Updating learning rate to 3.6861847565988014e-05
Updating learning rate to 3.6861847565988014e-05
train 8209
vs, vt 0.21669259396466342 0.2118845209479332
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:11:04,629 - epoch:20, training loss:0.4153 validation loss:0.2167
Updating learning rate to 3.0677304493976024e-05
Updating learning rate to 3.0677304493976024e-05
train 8209
vs, vt 0.21840269728140396 0.21151168712160803
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:11:20,009 - epoch:21, training loss:0.4132 validation loss:0.2184
Updating learning rate to 2.4823381521390875e-05
Updating learning rate to 2.4823381521390875e-05
train 8209
vs, vt 0.2175333337350325 0.2121541384946216
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:11:35,179 - epoch:22, training loss:0.4117 validation loss:0.2175
Updating learning rate to 1.940024089330755e-05
Updating learning rate to 1.940024089330755e-05
train 8209
vs, vt 0.21705425598404623 0.21059740605679425
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:11:50,736 - epoch:23, training loss:0.4093 validation loss:0.2171
Updating learning rate to 1.4500674049451182e-05
Updating learning rate to 1.4500674049451182e-05
train 8209
vs, vt 0.21741204031489111 0.2094648311083967
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:12:05,991 - epoch:24, training loss:0.4089 validation loss:0.2174
Updating learning rate to 1.020851393693675e-05
Updating learning rate to 1.020851393693675e-05
train 8209
vs, vt 0.21768099882385947 0.2106648629361933
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:12:21,379 - epoch:25, training loss:0.4080 validation loss:0.2177
Updating learning rate to 6.597200605300958e-06
Updating learning rate to 6.597200605300958e-06
train 8209
vs, vt 0.21772671761837872 0.21096092801202426
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:12:36,580 - epoch:26, training loss:0.4072 validation loss:0.2177
Updating learning rate to 3.728524626893306e-06
Updating learning rate to 3.728524626893306e-06
train 8209
vs, vt 0.2175989340652119 0.21126467734575272
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:12:52,255 - epoch:27, training loss:0.4065 validation loss:0.2176
Updating learning rate to 1.6515698430516055e-06
Updating learning rate to 1.6515698430516055e-06
train 8209
vs, vt 0.21755740656094116 0.21105828136205673
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:13:07,675 - epoch:28, training loss:0.4065 validation loss:0.2176
Updating learning rate to 4.018735259680286e-07
Updating learning rate to 4.018735259680286e-07
train 8209
vs, vt 0.21743974089622498 0.21108484268188477
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:13:23,329 - epoch:29, training loss:0.4069 validation loss:0.2174
Updating learning rate to 8.18326109158733e-10
Updating learning rate to 8.18326109158733e-10
2023-07-24 23:13:24,260 - [*] loss:0.2813
2023-07-24 23:13:24,263 - [*] phase 0, testing
2023-07-24 23:13:24,300 - T:96  MAE     0.340271        RMSE    0.279756        MAPE    138.159239
2023-07-24 23:13:24,301 - 96    mae     0.3403
2023-07-24 23:13:24,301 - 96    rmse    0.2798
2023-07-24 23:13:24,301 - 96    mape    138.1592

2023-07-24 23:13:49,238 - logger name:exp/ECL-PatchTST2023-07-24-23:13:49.238465/ECL-PatchTST.log
2023-07-24 23:13:49,238 - params : {'conf': 'ECL-PatchTST', 'data_name': 'ETTh2', 'iteration': 1, 'load': True, 'build_graph': False, 'grad_norm': False, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 96, 'noise_rate': 0.1, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-07-23-21:59:42.618606/0/0.0379_epoch_25.pkl', 'idx': -1, 'aligner': 0, 'refiner': 0, 'enhance': 0, 'seed': 2025, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'e_layers': 3, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'train': True, 'epoch': 30, 'batch_size': 256, 'lr': 0.0001, 'loss': 'mse', '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': 26304, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-07-24-23:13:49.238465', 'path': 'exp/ECL-PatchTST2023-07-24-23:13:49.238465', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-07-24 23:13:49,238 - [*] phase 0 start training
0 26304
train 8209
val 2785
test 2785
2023-07-24 23:13:49,426 - [*] phase 0 Dataset load!
2023-07-24 23:13:50,267 - [*] phase 0 Training start
train 8209
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:13:59,220 - epoch:0, training loss:0.6461 validation loss:0.3187
train 8209
vs, vt 0.3187347244132649 0.3273532431234013
Updating learning rate to 1.0496729249039657e-05
Updating learning rate to 1.0496729249039657e-05
train 8209
vs, vt 0.25907102159478446 0.26625406403433194
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:14:20,428 - epoch:1, training loss:0.7804 validation loss:0.2591
Updating learning rate to 2.822827154052001e-05
Updating learning rate to 2.822827154052001e-05
train 8209
vs, vt 0.2318992723118175 0.2338546575470404
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:14:35,823 - epoch:2, training loss:0.6767 validation loss:0.2319
Updating learning rate to 5.239475064795585e-05
Updating learning rate to 5.239475064795585e-05
train 8209
vs, vt 0.21428021653132004 0.2189867083321918
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:14:51,297 - epoch:3, training loss:0.6093 validation loss:0.2143
Updating learning rate to 7.645437191869786e-05
Updating learning rate to 7.645437191869786e-05
train 8209
vs, vt 0.21442700041966004 0.2152603959495371
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:15:06,851 - epoch:4, training loss:0.5670 validation loss:0.2144
Updating learning rate to 9.389426680147743e-05
Updating learning rate to 9.389426680147743e-05
train 8209
vs, vt 0.2105520943349058 0.22146352651444348
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:15:22,449 - epoch:5, training loss:0.5435 validation loss:0.2106
Updating learning rate to 9.999958167389085e-05
Updating learning rate to 9.999958167389085e-05
train 8209
vs, vt 0.21084162660620429 0.21610842035575348
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:15:38,016 - epoch:6, training loss:0.5292 validation loss:0.2108
Updating learning rate to 9.954513359086192e-05
Updating learning rate to 9.954513359086192e-05
train 8209
vs, vt 0.2077226388183507 0.21871782703833145
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:15:53,465 - epoch:7, training loss:0.5167 validation loss:0.2077
Updating learning rate to 9.824295795764264e-05
Updating learning rate to 9.824295795764264e-05
train 8209
vs, vt 0.2118999328125607 0.21907096423886038
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:16:09,036 - epoch:8, training loss:0.5022 validation loss:0.2119
Updating learning rate to 9.611533536034865e-05
Updating learning rate to 9.611533536034865e-05
train 8209
vs, vt 0.2116384289481423 0.21960274942896582
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:16:24,550 - epoch:9, training loss:0.4874 validation loss:0.2116
Updating learning rate to 9.319867001150813e-05
Updating learning rate to 9.319867001150813e-05
train 8209
vs, vt 0.2142046093940735 0.2216491929509423
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:16:40,726 - epoch:10, training loss:0.4752 validation loss:0.2142
Updating learning rate to 8.954286686389209e-05
Updating learning rate to 8.954286686389209e-05
train 8209
vs, vt 0.22095498036254535 0.21921628307212482
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:16:56,232 - epoch:11, training loss:0.4669 validation loss:0.2210
Updating learning rate to 8.52104777229364e-05
Updating learning rate to 8.52104777229364e-05
train 8209
vs, vt 0.21691677990284833 0.2180654542012648
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:17:11,841 - epoch:12, training loss:0.4580 validation loss:0.2169
Updating learning rate to 8.027563096800801e-05
Updating learning rate to 8.027563096800801e-05
train 8209
vs, vt 0.22347566485404968 0.2103937268257141
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:17:27,242 - epoch:13, training loss:0.4530 validation loss:0.2235
Updating learning rate to 7.482276319528172e-05
Updating learning rate to 7.482276319528172e-05
train 8209
vs, vt 0.21942248127677225 0.21924150464209644
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:17:42,380 - epoch:14, training loss:0.4433 validation loss:0.2194
Updating learning rate to 6.894517448416947e-05
Updating learning rate to 6.894517448416947e-05
train 8209
vs, vt 0.21875174072655765 0.21325776658274911
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:17:58,190 - epoch:15, training loss:0.4384 validation loss:0.2188
Updating learning rate to 6.274343200709381e-05
Updating learning rate to 6.274343200709381e-05
train 8209
vs, vt 0.21663455936041745 0.21082414280284534
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:18:13,560 - epoch:16, training loss:0.4324 validation loss:0.2166
Updating learning rate to 5.63236492972854e-05
Updating learning rate to 5.63236492972854e-05
train 8209
vs, vt 0.2177134332331744 0.20760884271426636
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:18:28,948 - epoch:17, training loss:0.4295 validation loss:0.2177
Updating learning rate to 4.9795670616809066e-05
Updating learning rate to 4.9795670616809066e-05
train 8209
vs, vt 0.2170887433669784 0.20771347121758896
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:18:44,167 - epoch:18, training loss:0.4252 validation loss:0.2171
Updating learning rate to 4.32711914907854e-05
Updating learning rate to 4.32711914907854e-05
train 8209
vs, vt 0.21852871098301627 0.20963331311941147
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:18:59,569 - epoch:19, training loss:0.4220 validation loss:0.2185
Updating learning rate to 3.6861847565988014e-05
Updating learning rate to 3.6861847565988014e-05
train 8209
vs, vt 0.2194860279560089 0.21077481724999167
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:19:15,104 - epoch:20, training loss:0.4185 validation loss:0.2195
Updating learning rate to 3.0677304493976024e-05
Updating learning rate to 3.0677304493976024e-05
train 8209
vs, vt 0.21688878739422018 0.20893331210721622
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:19:30,794 - epoch:21, training loss:0.4170 validation loss:0.2169
Updating learning rate to 2.4823381521390875e-05
Updating learning rate to 2.4823381521390875e-05
train 8209
vs, vt 0.21824250641194257 0.20946126295761627
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:19:46,245 - epoch:22, training loss:0.4153 validation loss:0.2182
Updating learning rate to 1.940024089330755e-05
Updating learning rate to 1.940024089330755e-05
train 8209
vs, vt 0.21858004345135254 0.20847289873795075
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:20:01,896 - epoch:23, training loss:0.4127 validation loss:0.2186
Updating learning rate to 1.4500674049451182e-05
Updating learning rate to 1.4500674049451182e-05
train 8209
vs, vt 0.21785047921267423 0.20922080156478015
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:20:17,554 - epoch:24, training loss:0.4113 validation loss:0.2179
Updating learning rate to 1.020851393693675e-05
Updating learning rate to 1.020851393693675e-05
train 8209
vs, vt 0.2176274467598308 0.20945793999867005
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:20:32,992 - epoch:25, training loss:0.4118 validation loss:0.2176
Updating learning rate to 6.597200605300958e-06
Updating learning rate to 6.597200605300958e-06
train 8209
vs, vt 0.21790523691610855 0.20900403369556775
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:20:48,314 - epoch:26, training loss:0.4097 validation loss:0.2179
Updating learning rate to 3.728524626893306e-06
Updating learning rate to 3.728524626893306e-06
train 8209
vs, vt 0.2179037962447513 0.2095850963484157
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:21:03,977 - epoch:27, training loss:0.4103 validation loss:0.2179
Updating learning rate to 1.6515698430516055e-06
Updating learning rate to 1.6515698430516055e-06
train 8209
vs, vt 0.21801096539605747 0.20949061147191309
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:21:19,662 - epoch:28, training loss:0.4092 validation loss:0.2180
Updating learning rate to 4.018735259680286e-07
Updating learning rate to 4.018735259680286e-07
train 8209
vs, vt 0.21790634366598996 0.20940057120539926
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 23:21:35,194 - epoch:29, training loss:0.4094 validation loss:0.2179
Updating learning rate to 8.18326109158733e-10
Updating learning rate to 8.18326109158733e-10
2023-07-24 23:21:36,123 - [*] loss:0.2857
2023-07-24 23:21:36,127 - [*] phase 0, testing
2023-07-24 23:21:36,164 - T:96  MAE     0.343702        RMSE    0.284083        MAPE    141.160023
2023-07-24 23:21:36,166 - 96    mae     0.3437
2023-07-24 23:21:36,166 - 96    rmse    0.2841
2023-07-24 23:21:36,166 - 96    mape    141.1600