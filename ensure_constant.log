2023-08-26 21:43:34,462 - logger name:exp/ECL-PatchTST2023-08-26-21:43:34.461553/ECL-PatchTST.log
2023-08-26 21:43:34,462 - params : {'loss': 'huber', 'conf': 'ECL-PatchTST', 'data_name': 'weather', 'iteration': 1, 'train': 0, 'load': False, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 720, 'noise_rate': 0.5, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-26-13:08:31.837686/0/best_model.pkl', 'idx': -1, 'aligner': 1, 'always_align': 1, 'refiner': 1, 'rec_block_num': 1, 'enhance': 1, 'enhance_type': 5, 'seed': 34, 'batch_size': 32, 'share_head': 0, 'add_noise': 1, 'jitter_sigma': 2.0, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 0, 'debugger': 0, 'omega': 1.0, 'theta': 1.5, 'mask_border': 1, 'sup_weight': 10.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 2, 'add_FFN': 0, 'add_residual': 0, 'rec_all': 0, 'e_layers': 3, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'epoch': 30, 'lr': 0.0001, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': -1, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-08-26-21:43:34.461553', 'path': 'exp/ECL-PatchTST2023-08-26-21:43:34.461553', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-08-26 21:43:34,463 - [*] phase 0 start training
0 52696
36887 5270 10539 0.7 0.2 52696
train 35832
36887 5270 10539 0.7 0.2 52696
val 4551
36887 5270 10539 0.7 0.2 52696
test 9820
2023-08-26 21:43:35,306 - [*] phase 0 Dataset load!
2023-08-26 21:45:38,928 - [*] loss:0.3187
2023-08-26 21:45:39,117 - [*] phase 0, testing
2023-08-26 21:45:42,506 - T:720	MAE	0.326985	RMSE	0.318651	MAPE	1442.583179
2023-08-26 21:45:42,508 - 720	mae	0.3270	
2023-08-26 21:45:42,508 - 720	rmse	0.3187	
2023-08-26 21:45:42,508 - 720	mape	1442.5832	
2023-08-26 21:46:37,783 - [*] loss:0.3186
2023-08-26 21:46:37,971 - [*] phase 0, testing
2023-08-26 21:46:41,352 - T:720	MAE	0.326856	RMSE	0.318527	MAPE	1443.423271
2023-08-26 21:48:31,173 - [*] loss:0.3226
2023-08-26 21:48:31,371 - [*] phase 0, testing
2023-08-26 21:48:34,746 - T:720	MAE	0.329463	RMSE	0.322501	MAPE	1531.647873
2023-08-26 21:49:24,173 - [*] loss:0.3244
2023-08-26 21:49:24,362 - [*] phase 0, testing
2023-08-26 21:49:27,643 - T:720	MAE	0.329941	RMSE	0.324298	MAPE	1536.742783
2023-08-26 21:49:27,645 - 720	mae	0.3299	
2023-08-26 21:49:27,646 - 720	rmse	0.3243	
2023-08-26 21:49:27,646 - 720	mape	1536.7428	
2023-08-26 21:49:29,710 - logger name:exp/ECL-PatchTST2023-08-26-21:49:29.709790/ECL-PatchTST.log
2023-08-26 21:49:29,710 - params : {'loss': 'huber', 'conf': 'ECL-PatchTST', 'data_name': 'weather', 'iteration': 1, 'train': 0, 'load': False, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 720, 'noise_rate': 0.5, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-26-13:08:31.837686/0/best_model.pkl', 'idx': -1, 'aligner': 1, 'always_align': 1, 'refiner': 1, 'rec_block_num': 1, 'enhance': 1, 'enhance_type': 5, 'seed': 34, 'batch_size': 32, 'share_head': 0, 'add_noise': 1, 'jitter_sigma': 2.0, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 1, 'debugger': 0, 'omega': 1.0, 'theta': 1.5, 'mask_border': 1, 'sup_weight': 10.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 2, 'add_FFN': 0, 'add_residual': 0, 'rec_all': 0, 'e_layers': 3, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'epoch': 30, 'lr': 0.0001, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': -1, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-08-26-21:49:29.709790', 'path': 'exp/ECL-PatchTST2023-08-26-21:49:29.709790', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-08-26 21:49:29,710 - [*] phase 0 start training
0 52696
36887 5270 10539 0.7 0.2 52696
train 35832
36887 5270 10539 0.7 0.2 52696
val 4551
36887 5270 10539 0.7 0.2 52696
test 9820
2023-08-26 21:49:30,509 - [*] phase 0 Dataset load!
2023-08-26 21:51:07,746 - [*] loss:0.3874
2023-08-26 21:51:07,946 - [*] phase 0, testing
2023-08-26 21:51:11,240 - T:720	MAE	0.413340	RMSE	0.387280	MAPE	1823.410225
2023-08-26 21:51:11,242 - 720	mae	0.4133	
2023-08-26 21:51:11,242 - 720	rmse	0.3873	
2023-08-26 21:51:11,242 - 720	mape	1823.4102	
2023-08-26 21:52:01,451 - [*] loss:0.3876
2023-08-26 21:52:01,635 - [*] phase 0, testing
2023-08-26 21:52:04,851 - T:720	MAE	0.413596	RMSE	0.387490	MAPE	1843.744469
2023-08-26 21:53:40,462 - [*] loss:0.3871
2023-08-26 21:53:40,645 - [*] phase 0, testing
2023-08-26 21:53:43,887 - T:720	MAE	0.411403	RMSE	0.386989	MAPE	1850.515556
2023-08-26 21:54:32,575 - [*] loss:0.3876
2023-08-26 21:54:32,756 - [*] phase 0, testing
2023-08-26 21:54:36,010 - T:720	MAE	0.412955	RMSE	0.387546	MAPE	1956.438065
2023-08-26 21:54:36,012 - 720	mae	0.4130	
2023-08-26 21:54:36,012 - 720	rmse	0.3875	
2023-08-26 21:54:36,012 - 720	mape	1956.4381	
2023-08-26 21:54:38,096 - logger name:exp/ECL-PatchTST2023-08-26-21:54:38.095795/ECL-PatchTST.log
2023-08-26 21:54:38,096 - params : {'loss': 'huber', 'conf': 'ECL-PatchTST', 'data_name': 'weather', 'iteration': 1, 'train': 0, 'load': False, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 720, 'noise_rate': 0.5, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-26-13:08:31.837686/0/best_model.pkl', 'idx': -1, 'aligner': 1, 'always_align': 1, 'refiner': 1, 'rec_block_num': 1, 'enhance': 1, 'enhance_type': 5, 'seed': 34, 'batch_size': 32, 'share_head': 0, 'add_noise': 1, 'jitter_sigma': 2.0, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 2, 'debugger': 0, 'omega': 1.0, 'theta': 1.5, 'mask_border': 1, 'sup_weight': 10.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 2, 'add_FFN': 0, 'add_residual': 0, 'rec_all': 0, 'e_layers': 3, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'epoch': 30, 'lr': 0.0001, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': -1, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-08-26-21:54:38.095795', 'path': 'exp/ECL-PatchTST2023-08-26-21:54:38.095795', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-08-26 21:54:38,096 - [*] phase 0 start training
0 52696
36887 5270 10539 0.7 0.2 52696
train 35832
36887 5270 10539 0.7 0.2 52696
val 4551
36887 5270 10539 0.7 0.2 52696
test 9820
2023-08-26 21:54:38,894 - [*] phase 0 Dataset load!
2023-08-26 21:56:15,170 - [*] loss:0.3330
2023-08-26 21:56:15,355 - [*] phase 0, testing
2023-08-26 21:56:18,592 - T:720	MAE	0.340371	RMSE	0.332886	MAPE	1559.342003
2023-08-26 21:56:18,594 - 720	mae	0.3404	
2023-08-26 21:56:18,594 - 720	rmse	0.3329	
2023-08-26 21:56:18,594 - 720	mape	1559.3420	
2023-08-26 21:57:08,894 - [*] loss:0.3329
2023-08-26 21:57:09,084 - [*] phase 0, testing
2023-08-26 21:57:12,366 - T:720	MAE	0.340196	RMSE	0.332815	MAPE	1562.215614
2023-08-26 21:58:47,640 - [*] loss:0.3326
2023-08-26 21:58:47,828 - [*] phase 0, testing
2023-08-26 21:58:51,089 - T:720	MAE	0.341046	RMSE	0.332549	MAPE	1572.746277
2023-08-26 21:59:39,728 - [*] loss:0.3366
2023-08-26 21:59:39,914 - [*] phase 0, testing
2023-08-26 21:59:43,208 - T:720	MAE	0.344618	RMSE	0.336491	MAPE	1597.072697
2023-08-26 21:59:43,212 - 720	mae	0.3446	
2023-08-26 21:59:43,212 - 720	rmse	0.3365	
2023-08-26 21:59:43,212 - 720	mape	1597.0727	
2023-08-26 21:59:45,334 - logger name:exp/ECL-PatchTST2023-08-26-21:59:45.331151/ECL-PatchTST.log
2023-08-26 21:59:45,334 - params : {'loss': 'huber', 'conf': 'ECL-PatchTST', 'data_name': 'weather', 'iteration': 1, 'train': 0, 'load': False, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 720, 'noise_rate': 0.5, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-26-13:08:31.837686/0/best_model.pkl', 'idx': -1, 'aligner': 1, 'always_align': 1, 'refiner': 1, 'rec_block_num': 1, 'enhance': 1, 'enhance_type': 5, 'seed': 34, 'batch_size': 32, 'share_head': 0, 'add_noise': 1, 'jitter_sigma': 2.0, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 3, 'debugger': 0, 'omega': 1.0, 'theta': 1.5, 'mask_border': 1, 'sup_weight': 10.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 2, 'add_FFN': 0, 'add_residual': 0, 'rec_all': 0, 'e_layers': 3, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'epoch': 30, 'lr': 0.0001, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': -1, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-08-26-21:59:45.331151', 'path': 'exp/ECL-PatchTST2023-08-26-21:59:45.331151', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-08-26 21:59:45,334 - [*] phase 0 start training
0 52696
36887 5270 10539 0.7 0.2 52696
train 35832
36887 5270 10539 0.7 0.2 52696
val 4551
36887 5270 10539 0.7 0.2 52696
test 9820
2023-08-26 21:59:46,130 - [*] phase 0 Dataset load!
2023-08-26 22:01:45,883 - [*] loss:0.3348
2023-08-26 22:01:46,082 - [*] phase 0, testing
2023-08-26 22:01:49,509 - T:720	MAE	0.353078	RMSE	0.334687	MAPE	1677.947617
2023-08-26 22:01:49,511 - 720	mae	0.3531	
2023-08-26 22:01:49,511 - 720	rmse	0.3347	
2023-08-26 22:01:49,511 - 720	mape	1677.9476	
2023-08-26 22:03:04,526 - [*] loss:0.3353
2023-08-26 22:03:04,713 - [*] phase 0, testing
2023-08-26 22:03:08,248 - T:720	MAE	0.353688	RMSE	0.335219	MAPE	1665.497971
2023-08-26 22:05:18,065 - [*] loss:0.3387
2023-08-26 22:05:18,257 - [*] phase 0, testing
2023-08-26 22:05:21,681 - T:720	MAE	0.355797	RMSE	0.338656	MAPE	1781.907845
2023-08-26 22:06:17,123 - [*] loss:0.3416
2023-08-26 22:06:17,310 - [*] phase 0, testing
2023-08-26 22:06:20,463 - T:720	MAE	0.359405	RMSE	0.341508	MAPE	1814.154243
2023-08-26 22:06:20,465 - 720	mae	0.3594	
2023-08-26 22:06:20,465 - 720	rmse	0.3415	
2023-08-26 22:06:20,465 - 720	mape	1814.1542	
2023-08-26 22:06:22,608 - logger name:exp/ECL-PatchTST2023-08-26-22:06:22.608467/ECL-PatchTST.log
2023-08-26 22:06:22,609 - params : {'loss': 'huber', 'conf': 'ECL-PatchTST', 'data_name': 'weather', 'iteration': 1, 'train': 0, 'load': False, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 720, 'noise_rate': 0.5, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-26-13:08:31.837686/0/best_model.pkl', 'idx': -1, 'aligner': 1, 'always_align': 1, 'refiner': 1, 'rec_block_num': 1, 'enhance': 1, 'enhance_type': 5, 'seed': 34, 'batch_size': 32, 'share_head': 0, 'add_noise': 1, 'jitter_sigma': 2.0, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 4, 'debugger': 0, 'omega': 1.0, 'theta': 1.5, 'mask_border': 1, 'sup_weight': 10.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 2, 'add_FFN': 0, 'add_residual': 0, 'rec_all': 0, 'e_layers': 3, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'epoch': 30, 'lr': 0.0001, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': -1, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-08-26-22:06:22.608467', 'path': 'exp/ECL-PatchTST2023-08-26-22:06:22.608467', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-08-26 22:06:22,609 - [*] phase 0 start training
0 52696
36887 5270 10539 0.7 0.2 52696
train 35832
36887 5270 10539 0.7 0.2 52696
val 4551
36887 5270 10539 0.7 0.2 52696
test 9820
2023-08-26 22:06:23,391 - [*] phase 0 Dataset load!
2023-08-26 22:08:01,991 - [*] loss:0.3487
2023-08-26 22:08:02,171 - [*] phase 0, testing
2023-08-26 22:08:05,354 - T:720	MAE	0.374999	RMSE	0.348595	MAPE	1407.422352
2023-08-26 22:08:05,382 - 720	mae	0.3750	
2023-08-26 22:08:05,382 - 720	rmse	0.3486	
2023-08-26 22:08:05,383 - 720	mape	1407.4224	
2023-08-26 22:08:54,793 - [*] loss:0.3493
2023-08-26 22:08:54,976 - [*] phase 0, testing
2023-08-26 22:08:58,118 - T:720	MAE	0.375166	RMSE	0.349250	MAPE	1401.017857
2023-08-26 22:10:35,550 - [*] loss:0.3530
2023-08-26 22:10:35,751 - [*] phase 0, testing
2023-08-26 22:10:38,968 - T:720	MAE	0.380789	RMSE	0.352879	MAPE	1466.013718
2023-08-26 22:11:30,871 - [*] loss:0.3567
2023-08-26 22:11:31,062 - [*] phase 0, testing
2023-08-26 22:11:34,298 - T:720	MAE	0.385235	RMSE	0.356650	MAPE	1490.581608
2023-08-26 22:11:34,300 - 720	mae	0.3852	
2023-08-26 22:11:34,300 - 720	rmse	0.3567	
2023-08-26 22:11:34,300 - 720	mape	1490.5816	
2023-08-26 22:11:36,351 - logger name:exp/ECL-PatchTST2023-08-26-22:11:36.351748/ECL-PatchTST.log
2023-08-26 22:11:36,352 - params : {'loss': 'huber', 'conf': 'ECL-PatchTST', 'data_name': 'weather', 'iteration': 1, 'train': 0, 'load': False, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 720, 'noise_rate': 0.5, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-26-13:08:31.837686/0/best_model.pkl', 'idx': -1, 'aligner': 1, 'always_align': 1, 'refiner': 1, 'rec_block_num': 1, 'enhance': 1, 'enhance_type': 5, 'seed': 34, 'batch_size': 32, 'share_head': 0, 'add_noise': 1, 'jitter_sigma': 2.0, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 5, 'debugger': 0, 'omega': 1.0, 'theta': 1.5, 'mask_border': 1, 'sup_weight': 10.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 2, 'add_FFN': 0, 'add_residual': 0, 'rec_all': 0, 'e_layers': 3, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'epoch': 30, 'lr': 0.0001, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': -1, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-08-26-22:11:36.351748', 'path': 'exp/ECL-PatchTST2023-08-26-22:11:36.351748', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-08-26 22:11:36,352 - [*] phase 0 start training
0 52696
36887 5270 10539 0.7 0.2 52696
train 35832
36887 5270 10539 0.7 0.2 52696
val 4551
36887 5270 10539 0.7 0.2 52696
test 9820
2023-08-26 22:11:37,155 - [*] phase 0 Dataset load!
2023-08-26 22:13:13,637 - [*] loss:0.3193
2023-08-26 22:13:13,835 - [*] phase 0, testing
2023-08-26 22:13:17,131 - T:720	MAE	0.341167	RMSE	0.319265	MAPE	1210.547543
2023-08-26 22:13:17,133 - 720	mae	0.3412	
2023-08-26 22:13:17,133 - 720	rmse	0.3193	
2023-08-26 22:13:17,133 - 720	mape	1210.5475	
2023-08-26 22:14:07,654 - [*] loss:0.3195
2023-08-26 22:14:07,840 - [*] phase 0, testing
2023-08-26 22:14:11,138 - T:720	MAE	0.341371	RMSE	0.319381	MAPE	1207.795620
2023-08-26 22:15:47,463 - [*] loss:0.3246
2023-08-26 22:15:47,650 - [*] phase 0, testing
2023-08-26 22:15:50,975 - T:720	MAE	0.347337	RMSE	0.324518	MAPE	1291.240120
2023-08-26 22:16:40,663 - [*] loss:0.3249
2023-08-26 22:16:40,845 - [*] phase 0, testing
2023-08-26 22:16:44,107 - T:720	MAE	0.345450	RMSE	0.324813	MAPE	1300.971031
2023-08-26 22:16:44,109 - 720	mae	0.3455	
2023-08-26 22:16:44,109 - 720	rmse	0.3248	
2023-08-26 22:16:44,109 - 720	mape	1300.9710	
2023-08-26 22:16:46,263 - logger name:exp/ECL-PatchTST2023-08-26-22:16:46.263639/ECL-PatchTST.log
2023-08-26 22:16:46,264 - params : {'loss': 'huber', 'conf': 'ECL-PatchTST', 'data_name': 'ETTh2', 'iteration': 1, 'train': 0, 'load': False, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 96, 'noise_rate': 0.5, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-23-11:43:26.865832/0/best_model.pkl', 'idx': -1, 'aligner': 1, 'always_align': 1, 'refiner': 1, 'rec_block_num': 1, 'enhance': 1, 'enhance_type': 5, 'seed': 34, 'batch_size': 128, 'share_head': 0, 'add_noise': 1, 'jitter_sigma': 0.8, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 0, 'debugger': 0, 'omega': 1.0, 'theta': 1.1, 'mask_border': 1, 'sup_weight': 10.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 2, 'add_FFN': 0, 'add_residual': 0, 'rec_all': 0, 'e_layers': 3, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'epoch': 30, 'lr': 0.0001, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': -1, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-08-26-22:16:46.263639', 'path': 'exp/ECL-PatchTST2023-08-26-22:16:46.263639', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-08-26 22:16:46,264 - [*] phase 0 start training
0 17420
train 8209
val 2785
test 2785
2023-08-26 22:16:46,466 - [*] phase 0 Dataset load!
2023-08-26 22:16:56,023 - [*] loss:nan
2023-08-26 22:16:56,026 - [*] phase 0, testing
2023-08-26 22:16:56,064 - T:96	MAE	0.330945	RMSE	0.270921	MAPE	136.236000
2023-08-26 22:16:56,065 - 96	mae	0.3309	
2023-08-26 22:16:56,065 - 96	rmse	0.2709	
2023-08-26 22:16:56,065 - 96	mape	136.2360	
2023-08-26 22:17:00,161 - [*] loss:0.2714
2023-08-26 22:17:00,164 - [*] phase 0, testing
2023-08-26 22:17:00,201 - T:96	MAE	0.331964	RMSE	0.271524	MAPE	135.913777
2023-08-26 22:17:08,627 - [*] loss:nan
2023-08-26 22:17:08,630 - [*] phase 0, testing
2023-08-26 22:17:08,670 - T:96	MAE	0.330702	RMSE	0.273321	MAPE	134.983778
2023-08-26 22:17:13,866 - [*] loss:0.2733
2023-08-26 22:17:13,869 - [*] phase 0, testing
2023-08-26 22:17:13,908 - T:96	MAE	0.332327	RMSE	0.273280	MAPE	132.915294
2023-08-26 22:17:13,910 - 96	mae	0.3323	
2023-08-26 22:17:13,910 - 96	rmse	0.2733	
2023-08-26 22:17:13,910 - 96	mape	132.9153	
2023-08-26 22:17:16,062 - logger name:exp/ECL-PatchTST2023-08-26-22:17:16.061624/ECL-PatchTST.log
2023-08-26 22:17:16,062 - params : {'loss': 'huber', 'conf': 'ECL-PatchTST', 'data_name': 'ETTh2', 'iteration': 1, 'train': 0, 'load': False, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 96, 'noise_rate': 0.5, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-23-11:43:26.865832/0/best_model.pkl', 'idx': -1, 'aligner': 1, 'always_align': 1, 'refiner': 1, 'rec_block_num': 1, 'enhance': 1, 'enhance_type': 5, 'seed': 34, 'batch_size': 128, 'share_head': 0, 'add_noise': 1, 'jitter_sigma': 0.8, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 1, 'debugger': 0, 'omega': 1.0, 'theta': 1.1, 'mask_border': 1, 'sup_weight': 10.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 2, 'add_FFN': 0, 'add_residual': 0, 'rec_all': 0, 'e_layers': 3, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'epoch': 30, 'lr': 0.0001, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': -1, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-08-26-22:17:16.061624', 'path': 'exp/ECL-PatchTST2023-08-26-22:17:16.061624', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-08-26 22:17:16,062 - [*] phase 0 start training
0 17420
train 8209
val 2785
test 2785
2023-08-26 22:17:16,263 - [*] phase 0 Dataset load!
2023-08-26 22:17:26,990 - [*] loss:0.3358
2023-08-26 22:17:26,993 - [*] phase 0, testing
2023-08-26 22:17:27,030 - T:96	MAE	0.409352	RMSE	0.335277	MAPE	205.181885
2023-08-26 22:17:27,031 - 96	mae	0.4094	
2023-08-26 22:17:27,031 - 96	rmse	0.3353	
2023-08-26 22:17:27,031 - 96	mape	205.1819	
2023-08-26 22:17:32,224 - [*] loss:0.3369
2023-08-26 22:17:32,227 - [*] phase 0, testing
2023-08-26 22:17:32,265 - T:96	MAE	0.414393	RMSE	0.336596	MAPE	215.904570
2023-08-26 22:17:41,727 - [*] loss:0.3315
2023-08-26 22:17:41,734 - [*] phase 0, testing
2023-08-26 22:17:41,796 - T:96	MAE	0.403639	RMSE	0.331144	MAPE	197.003937
2023-08-26 22:17:46,633 - [*] loss:0.3369
2023-08-26 22:17:46,636 - [*] phase 0, testing
2023-08-26 22:17:46,674 - T:96	MAE	0.412591	RMSE	0.336456	MAPE	214.330292
2023-08-26 22:17:46,675 - 96	mae	0.4126	
2023-08-26 22:17:46,675 - 96	rmse	0.3365	
2023-08-26 22:17:46,675 - 96	mape	214.3303	
2023-08-26 22:17:48,819 - logger name:exp/ECL-PatchTST2023-08-26-22:17:48.819402/ECL-PatchTST.log
2023-08-26 22:17:48,820 - params : {'loss': 'huber', 'conf': 'ECL-PatchTST', 'data_name': 'ETTh2', 'iteration': 1, 'train': 0, 'load': False, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 96, 'noise_rate': 0.5, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-23-11:43:26.865832/0/best_model.pkl', 'idx': -1, 'aligner': 1, 'always_align': 1, 'refiner': 1, 'rec_block_num': 1, 'enhance': 1, 'enhance_type': 5, 'seed': 34, 'batch_size': 128, 'share_head': 0, 'add_noise': 1, 'jitter_sigma': 0.8, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 2, 'debugger': 0, 'omega': 1.0, 'theta': 1.1, 'mask_border': 1, 'sup_weight': 10.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 2, 'add_FFN': 0, 'add_residual': 0, 'rec_all': 0, 'e_layers': 3, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'epoch': 30, 'lr': 0.0001, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': -1, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-08-26-22:17:48.819402', 'path': 'exp/ECL-PatchTST2023-08-26-22:17:48.819402', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-08-26 22:17:48,820 - [*] phase 0 start training
0 17420
train 8209
val 2785
test 2785
2023-08-26 22:17:49,021 - [*] phase 0 Dataset load!
2023-08-26 22:18:00,404 - [*] loss:nan
2023-08-26 22:18:00,413 - [*] phase 0, testing
2023-08-26 22:18:00,456 - T:96	MAE	0.339725	RMSE	0.277214	MAPE	134.838235
2023-08-26 22:18:00,457 - 96	mae	0.3397	
2023-08-26 22:18:00,457 - 96	rmse	0.2772	
2023-08-26 22:18:00,457 - 96	mape	134.8382	
2023-08-26 22:18:05,978 - [*] loss:0.2870
2023-08-26 22:18:05,982 - [*] phase 0, testing
2023-08-26 22:18:06,020 - T:96	MAE	0.351201	RMSE	0.287011	MAPE	140.645123
2023-08-26 22:18:16,354 - [*] loss:nan
2023-08-26 22:18:16,357 - [*] phase 0, testing
2023-08-26 22:18:16,395 - T:96	MAE	0.341709	RMSE	0.282285	MAPE	135.520601
2023-08-26 22:18:21,888 - [*] loss:0.2964
2023-08-26 22:18:21,892 - [*] phase 0, testing
2023-08-26 22:18:21,931 - T:96	MAE	0.357076	RMSE	0.296364	MAPE	142.243338
2023-08-26 22:18:21,932 - 96	mae	0.3571	
2023-08-26 22:18:21,932 - 96	rmse	0.2964	
2023-08-26 22:18:21,932 - 96	mape	142.2433	
2023-08-26 22:18:24,152 - logger name:exp/ECL-PatchTST2023-08-26-22:18:24.151623/ECL-PatchTST.log
2023-08-26 22:18:24,152 - params : {'loss': 'huber', 'conf': 'ECL-PatchTST', 'data_name': 'ETTh2', 'iteration': 1, 'train': 0, 'load': False, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 96, 'noise_rate': 0.5, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-23-11:43:26.865832/0/best_model.pkl', 'idx': -1, 'aligner': 1, 'always_align': 1, 'refiner': 1, 'rec_block_num': 1, 'enhance': 1, 'enhance_type': 5, 'seed': 34, 'batch_size': 128, 'share_head': 0, 'add_noise': 1, 'jitter_sigma': 0.8, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 3, 'debugger': 0, 'omega': 1.0, 'theta': 1.1, 'mask_border': 1, 'sup_weight': 10.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 2, 'add_FFN': 0, 'add_residual': 0, 'rec_all': 0, 'e_layers': 3, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'epoch': 30, 'lr': 0.0001, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': -1, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-08-26-22:18:24.151623', 'path': 'exp/ECL-PatchTST2023-08-26-22:18:24.151623', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-08-26 22:18:24,152 - [*] phase 0 start training
0 17420
train 8209
val 2785
test 2785
2023-08-26 22:18:24,368 - [*] phase 0 Dataset load!
2023-08-26 22:18:36,408 - [*] loss:nan
2023-08-26 22:18:36,412 - [*] phase 0, testing
2023-08-26 22:18:36,466 - T:96	MAE	0.333540	RMSE	0.274602	MAPE	133.104229
2023-08-26 22:18:36,467 - 96	mae	0.3335	
2023-08-26 22:18:36,468 - 96	rmse	0.2746	
2023-08-26 22:18:36,468 - 96	mape	133.1042	
2023-08-26 22:18:42,567 - [*] loss:0.2752
2023-08-26 22:18:42,571 - [*] phase 0, testing
2023-08-26 22:18:42,610 - T:96	MAE	0.335288	RMSE	0.275239	MAPE	135.693300
2023-08-26 22:18:53,449 - [*] loss:nan
2023-08-26 22:18:53,453 - [*] phase 0, testing
2023-08-26 22:18:53,492 - T:96	MAE	0.336565	RMSE	0.277205	MAPE	141.529250
2023-08-26 22:18:59,822 - [*] loss:0.2764
2023-08-26 22:18:59,825 - [*] phase 0, testing
2023-08-26 22:18:59,877 - T:96	MAE	0.337062	RMSE	0.276325	MAPE	136.158919
2023-08-26 22:18:59,877 - 96	mae	0.3371	
2023-08-26 22:18:59,877 - 96	rmse	0.2763	
2023-08-26 22:18:59,877 - 96	mape	136.1589	
2023-08-26 22:19:02,086 - logger name:exp/ECL-PatchTST2023-08-26-22:19:02.085686/ECL-PatchTST.log
2023-08-26 22:19:02,086 - params : {'loss': 'huber', 'conf': 'ECL-PatchTST', 'data_name': 'ETTh2', 'iteration': 1, 'train': 0, 'load': False, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 96, 'noise_rate': 0.5, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-23-11:43:26.865832/0/best_model.pkl', 'idx': -1, 'aligner': 1, 'always_align': 1, 'refiner': 1, 'rec_block_num': 1, 'enhance': 1, 'enhance_type': 5, 'seed': 34, 'batch_size': 128, 'share_head': 0, 'add_noise': 1, 'jitter_sigma': 0.8, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 4, 'debugger': 0, 'omega': 1.0, 'theta': 1.1, 'mask_border': 1, 'sup_weight': 10.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 2, 'add_FFN': 0, 'add_residual': 0, 'rec_all': 0, 'e_layers': 3, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'epoch': 30, 'lr': 0.0001, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': -1, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-08-26-22:19:02.085686', 'path': 'exp/ECL-PatchTST2023-08-26-22:19:02.085686', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-08-26 22:19:02,086 - [*] phase 0 start training
0 17420
train 8209
val 2785
test 2785
2023-08-26 22:19:02,317 - [*] phase 0 Dataset load!
2023-08-26 22:19:14,845 - [*] loss:0.3148
2023-08-26 22:19:14,848 - [*] phase 0, testing
2023-08-26 22:19:14,889 - T:96	MAE	0.382409	RMSE	0.314966	MAPE	192.361605
2023-08-26 22:19:14,890 - 96	mae	0.3824	
2023-08-26 22:19:14,890 - 96	rmse	0.3150	
2023-08-26 22:19:14,891 - 96	mape	192.3616	
2023-08-26 22:19:21,300 - [*] loss:0.3353
2023-08-26 22:19:21,303 - [*] phase 0, testing
2023-08-26 22:19:21,344 - T:96	MAE	0.400285	RMSE	0.335377	MAPE	198.915589
2023-08-26 22:19:32,382 - [*] loss:0.3310
2023-08-26 22:19:32,385 - [*] phase 0, testing
2023-08-26 22:19:32,449 - T:96	MAE	0.394705	RMSE	0.331637	MAPE	194.859755
2023-08-26 22:19:38,945 - [*] loss:0.3320
2023-08-26 22:19:38,949 - [*] phase 0, testing
2023-08-26 22:19:39,019 - T:96	MAE	0.395069	RMSE	0.332143	MAPE	188.860476
2023-08-26 22:19:39,020 - 96	mae	0.3951	
2023-08-26 22:19:39,020 - 96	rmse	0.3321	
2023-08-26 22:19:39,020 - 96	mape	188.8605	
2023-08-26 22:19:41,249 - logger name:exp/ECL-PatchTST2023-08-26-22:19:41.248823/ECL-PatchTST.log
2023-08-26 22:19:41,249 - params : {'loss': 'huber', 'conf': 'ECL-PatchTST', 'data_name': 'ETTh2', 'iteration': 1, 'train': 0, 'load': False, 'build_graph': False, 'same_init': True, 'grad_norm': False, 'refiner_residual': 0, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 96, 'noise_rate': 0.5, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-08-23-11:43:26.865832/0/best_model.pkl', 'idx': -1, 'aligner': 1, 'always_align': 1, 'refiner': 1, 'rec_block_num': 1, 'enhance': 1, 'enhance_type': 5, 'seed': 34, 'batch_size': 128, 'share_head': 0, 'add_noise': 1, 'jitter_sigma': 0.8, 'slope_rate': 0.01, 'slope_range': 0.2, 'alpha': 10.0, 'beta': 1.0, 'gamma': 0.15, 'feature_jittering': 1, 'rec_intra_feature': 0, 'rec_ori': 1, 'mid_dim': 128, 'test_en': 5, 'debugger': 0, 'omega': 1.0, 'theta': 1.1, 'mask_border': 1, 'sup_weight': 10.0, 'rec_length_ratio': 0.8, 'ref_dropout': 0.0, 'ref_block_num': 2, 'add_FFN': 0, 'add_residual': 0, 'rec_all': 0, 'e_layers': 3, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'epoch': 30, 'lr': 0.0001, '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': -1, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-08-26-22:19:41.248823', 'path': 'exp/ECL-PatchTST2023-08-26-22:19:41.248823', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-08-26 22:19:41,249 - [*] phase 0 start training
0 17420
train 8209
val 2785
test 2785
2023-08-26 22:19:41,473 - [*] phase 0 Dataset load!
2023-08-26 22:19:53,035 - [*] loss:nan
2023-08-26 22:19:53,038 - [*] phase 0, testing
2023-08-26 22:19:53,077 - T:96	MAE	0.384824	RMSE	0.336444	MAPE	130.430293
2023-08-26 22:19:53,078 - 96	mae	0.3848	
2023-08-26 22:19:53,078 - 96	rmse	0.3364	
2023-08-26 22:19:53,078 - 96	mape	130.4303	
2023-08-26 22:19:58,829 - [*] loss:0.3501
2023-08-26 22:19:58,832 - [*] phase 0, testing
2023-08-26 22:19:58,872 - T:96	MAE	0.396546	RMSE	0.349969	MAPE	129.798615
2023-08-26 22:20:09,156 - [*] loss:nan
2023-08-26 22:20:09,160 - [*] phase 0, testing
2023-08-26 22:20:09,202 - T:96	MAE	0.389875	RMSE	0.346283	MAPE	129.624271
2023-08-26 22:20:15,113 - [*] loss:0.3388
2023-08-26 22:20:15,116 - [*] phase 0, testing
2023-08-26 22:20:15,158 - T:96	MAE	0.384995	RMSE	0.338587	MAPE	125.515950
2023-08-26 22:20:15,159 - 96	mae	0.3850	
2023-08-26 22:20:15,159 - 96	rmse	0.3386	
2023-08-26 22:20:15,159 - 96	mape	125.5159	
