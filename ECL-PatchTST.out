2023-05-14 21:18:25,883 - logger name:exp/district3F11T17/ECL-PatchTST2023-05-14-21:18:25.883122/ECL-PatchTST.log
2023-05-14 21:18:25,883 - params : {'conf': 'ECL-PatchTST', 'load_config': 'configs/', 'data_process': False, 'auto_test': 1, 'load': True, 'device': device(type='cuda', index=1), 'build_graph': False, 'dynamic_graph': False, 'graph_input': False, 'model_name': 'PatchTST', 'data_name': 'electricity', 'root_path': '', 'raw_data_path': 'data/district3F11T17/finaldata/', 'graph_path': 'data/district3F11T17/graph/', 'save_data_path': 'data/ECL/', 'model_path': 'exp/district3F11T17/', 'phase': 2012, 'days': 31, '/* model related args*/': '//', 'x_len': 96, 'y_len': 96, 'label_len': 48, 'features': 'M', 'target': 'OT', 'individual': False, 'test_model_path': 'exp/district3F11T17/CUSTOM-TEST2023-05-14-19:41:54.522136/1/0.2784_epoch_7.pkl', 'e_layers': 3, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, '/*train related args*/': '//', 'train': True, 'epoch': 100, 'batch_size': 32, 'lr': 0.01, 'loss': 'mse', '/*dataset related args*/': '//', 'embed': 'timeF', 'freq': 'H', 'begin_phase': 1, 'end_phase': 1, 'phase_len': 15667, 'val_ratio': 0.5, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-05-14-21:18:25.883122', 'path': 'exp/district3F11T17/ECL-PatchTST2023-05-14-21:18:25.883122', 'logger': <Logger __main__ (INFO)>}
2023-05-14 21:18:25,883 - [*] phase 1 load from data/ECL/1_30day.npz
2023-05-14 21:18:25,884 - [*] phase 1 Dataset load!
2023-05-14 21:19:07,005 - [*] phase 1 Training start
2023-05-14 21:19:07,765 - node number torch.Size([10272, 96])
2023-05-14 21:22:03,421 - epoch:0, training loss:0.3970 validation loss:0.3134
2023-05-14 21:25:04,351 - epoch:1, training loss:0.3092 validation loss:0.2952
2023-05-14 21:28:05,297 - epoch:2, training loss:0.2951 validation loss:0.2858
2023-05-14 21:31:06,958 - epoch:3, training loss:0.2872 validation loss:0.2783
2023-05-14 21:34:09,908 - epoch:4, training loss:0.2831 validation loss:0.2757
2023-05-14 21:37:14,133 - epoch:5, training loss:0.2802 validation loss:0.2768
2023-05-14 21:40:18,687 - epoch:6, training loss:0.2777 validation loss:0.2742
2023-05-14 21:43:24,131 - epoch:7, training loss:0.2756 validation loss:0.2705
2023-05-14 21:46:29,491 - epoch:8, training loss:0.2739 validation loss:0.2686
2023-05-14 21:49:35,247 - epoch:9, training loss:0.2730 validation loss:0.2735
2023-05-14 21:52:40,266 - epoch:10, training loss:0.2720 validation loss:0.2682
2023-05-14 21:55:43,438 - epoch:11, training loss:0.2716 validation loss:0.2646
2023-05-14 21:58:46,603 - epoch:12, training loss:0.2708 validation loss:0.2663
2023-05-14 22:01:49,877 - epoch:13, training loss:0.2708 validation loss:0.2643
2023-05-14 22:05:19,563 - epoch:14, training loss:0.2709 validation loss:0.2680
2023-05-14 22:08:22,951 - epoch:15, training loss:0.2710 validation loss:0.2652
2023-05-14 22:11:27,470 - epoch:16, training loss:0.2713 validation loss:0.2708
2023-05-14 22:14:31,870 - epoch:17, training loss:0.2716 validation loss:0.2687
2023-05-14 22:17:37,258 - epoch:18, training loss:0.2744 validation loss:0.2675
2023-05-14 22:20:42,090 - epoch:19, training loss:0.2722 validation loss:0.2668
2023-05-14 22:20:42,113 - Finished optimization, total time:3252.89 s, best model:exp/district3F11T17/ECL-PatchTST2023-05-14-21:18:25.883122/1/0.2643_epoch_13.pkl
2023-05-14 22:21:03,419 - [*] loss:0.1689
2023-05-14 22:21:04,460 - [*] phase 1, testing
2023-05-14 22:21:04,866 - T:3	MAE	0.1826	RMSE	0.2872	MAPE	209.4178
2023-05-14 22:21:05,257 - T:6	MAE	0.2015	RMSE	0.3184	MAPE	226.4647
2023-05-14 22:21:05,827 - T:12	MAE	0.2160	RMSE	0.3460	MAPE	231.9630
2023-05-14 22:21:51,729 - T:96	MAE	0.2552	RMSE	0.4106	MAPE	251.4143
2023-05-14 22:21:51,735 - 3	mae	0.18	
2023-05-14 22:21:51,735 - 3	rmse	0.29	
2023-05-14 22:21:51,735 - 3	mape	209.42	
2023-05-14 22:21:51,735 - 6	mae	0.20	
2023-05-14 22:21:51,735 - 6	rmse	0.32	
2023-05-14 22:21:51,735 - 6	mape	226.46	
2023-05-14 22:21:51,735 - 12	mae	0.22	
2023-05-14 22:21:51,735 - 12	rmse	0.35	
2023-05-14 22:21:51,735 - 12	mape	231.96	
2023-05-14 22:21:51,735 - 96	mae	0.26	
2023-05-14 22:21:51,735 - 96	rmse	0.41	
2023-05-14 22:21:51,735 - 96	mape	251.41	
2023-05-14 22:21:51,735 - phase	1	total_time	3252.887333	average_time	162.644376	epoch	20
