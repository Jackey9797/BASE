2023-07-24 21:55:53,210 - logger name:exp/ECL-PatchTST2023-07-24-21:55:53.209758/ECL-PatchTST.log
2023-07-24 21:55:53,210 - params : {'conf': 'ECL-PatchTST', 'data_name': 'electricity', 'iteration': 1, 'load': True, 'build_graph': False, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 96, 'noise_rate': 0.1, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-07-23-21:59:42.618606/0/0.0379_epoch_25.pkl', 'idx': 89, 'aligner': 0, 'refiner': 0, 'enhance': 0, 'seed': 2021, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'e_layers': 3, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'train': True, 'epoch': 30, 'batch_size': 256, 'lr': 0.0001, 'loss': 'mse', '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': 26304, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-07-24-21:55:53.209758', 'path': 'exp/ECL-PatchTST2023-07-24-21:55:53.209758', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-07-24 21:55:53,210 - [*] phase 0 start training
0 26304
18412 2632 5260 0.7 0.2 26304
train 17981
18412 2632 5260 0.7 0.2 26304
val 2537
18412 2632 5260 0.7 0.2 26304
test 5165
2023-07-24 21:56:05,013 - [*] phase 0 Dataset load!
2023-07-24 21:56:05,843 - [*] phase 0 Training start
18412 2632 5260 0.7 0.2 26304
train 17981
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:56:11,377 - epoch:0, training loss:0.6718 validation loss:0.1490
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.14897971227765083 0.1595781199634075
Updating learning rate to 1.0460804405720289e-05
Updating learning rate to 1.0460804405720289e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.08412474766373634 0.0875021394342184
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:56:21,893 - epoch:1, training loss:0.4078 validation loss:0.0841
Updating learning rate to 2.8103967890840526e-05
Updating learning rate to 2.8103967890840526e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.06708494089543819 0.0689881717786193
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:56:28,798 - epoch:2, training loss:0.2867 validation loss:0.0671
Updating learning rate to 5.2179947606381204e-05
Updating learning rate to 5.2179947606381204e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.05950518976897001 0.060833440907299516
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:56:35,732 - epoch:3, training loss:0.2204 validation loss:0.0595
Updating learning rate to 7.620748539325079e-05
Updating learning rate to 7.620748539325079e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.054667475074529646 0.055966084077954295
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:56:42,692 - epoch:4, training loss:0.1820 validation loss:0.0547
Updating learning rate to 9.371836366844854e-05
Updating learning rate to 9.371836366844854e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.05145792607218027 0.052768643386662005
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:56:49,764 - epoch:5, training loss:0.1616 validation loss:0.0515
Updating learning rate to 9.999991257828403e-05
Updating learning rate to 9.999991257828403e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.0494358079507947 0.05062928646802902
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:56:56,891 - epoch:6, training loss:0.1507 validation loss:0.0494
Updating learning rate to 9.955995399140267e-05
Updating learning rate to 9.955995399140267e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.048098357208073136 0.04926480073481798
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:57:03,956 - epoch:7, training loss:0.1437 validation loss:0.0481
Updating learning rate to 9.82720142731687e-05
Updating learning rate to 9.82720142731687e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04745785053819418 0.04868204798549414
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:57:11,212 - epoch:8, training loss:0.1384 validation loss:0.0475
Updating learning rate to 9.615813042924547e-05
Updating learning rate to 9.615813042924547e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.046451123617589476 0.047687997668981554
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:57:18,220 - epoch:9, training loss:0.1348 validation loss:0.0465
Updating learning rate to 9.325447159828183e-05
Updating learning rate to 9.325447159828183e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04615580085664987 0.046704739518463614
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:57:25,169 - epoch:10, training loss:0.1317 validation loss:0.0462
Updating learning rate to 8.961072018792186e-05
Updating learning rate to 8.961072018792186e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04535166556015611 0.045856574829667804
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:57:32,165 - epoch:11, training loss:0.1285 validation loss:0.0454
Updating learning rate to 8.528922179503559e-05
Updating learning rate to 8.528922179503559e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04528606608510018 0.04553392147645354
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:57:39,245 - epoch:12, training loss:0.1263 validation loss:0.0453
Updating learning rate to 8.0363918455271e-05
Updating learning rate to 8.0363918455271e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04488897016271949 0.045111144334077834
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:57:46,589 - epoch:13, training loss:0.1243 validation loss:0.0449
Updating learning rate to 7.491908347432356e-05
Updating learning rate to 7.491908347432356e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04449298921972513 0.04477733047679067
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:57:54,382 - epoch:14, training loss:0.1225 validation loss:0.0445
Updating learning rate to 6.90478794883107e-05
Updating learning rate to 6.90478794883107e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04420587038621306 0.044410132337361574
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:58:01,450 - epoch:15, training loss:0.1213 validation loss:0.0442
Updating learning rate to 6.285076442523838e-05
Updating learning rate to 6.285076442523838e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04436770947650075 0.04413014212623238
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:58:08,331 - epoch:16, training loss:0.1200 validation loss:0.0444
Updating learning rate to 5.6433772642000686e-05
Updating learning rate to 5.6433772642000686e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04369563525542617 0.04378570793196559
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:58:15,504 - epoch:17, training loss:0.1188 validation loss:0.0437
Updating learning rate to 4.9906700647135036e-05
Updating learning rate to 4.9906700647135036e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04351505162194371 0.04365570014342666
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:58:22,425 - epoch:18, training loss:0.1177 validation loss:0.0435
Updating learning rate to 4.338122845211983e-05
Updating learning rate to 4.338122845211983e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04379023732617497 0.04351488025858998
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:58:29,627 - epoch:19, training loss:0.1169 validation loss:0.0438
Updating learning rate to 3.696900869541445e-05
Updating learning rate to 3.696900869541445e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04343158155679703 0.04318204233422875
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:58:36,946 - epoch:20, training loss:0.1159 validation loss:0.0434
Updating learning rate to 3.077975623485933e-05
Updating learning rate to 3.077975623485933e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04309422234073281 0.04308762764558196
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:58:44,020 - epoch:21, training loss:0.1152 validation loss:0.0431
Updating learning rate to 2.4919370896039528e-05
Updating learning rate to 2.4919370896039528e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04302555928006768 0.04292326755821705
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:58:51,256 - epoch:22, training loss:0.1146 validation loss:0.0430
Updating learning rate to 1.948812549690802e-05
Updating learning rate to 1.948812549690802e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04297695243731141 0.04282505251467228
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:58:58,245 - epoch:23, training loss:0.1143 validation loss:0.0430
Updating learning rate to 1.4578950152069679e-05
Updating learning rate to 1.4578950152069679e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04295535096898675 0.0427414869889617
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:59:05,330 - epoch:24, training loss:0.1138 validation loss:0.0430
Updating learning rate to 1.0275842212755217e-05
Updating learning rate to 1.0275842212755217e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04282212359830737 0.042691112402826546
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:59:12,568 - epoch:25, training loss:0.1135 validation loss:0.0428
Updating learning rate to 6.652429048853217e-06
Updating learning rate to 6.652429048853217e-06
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04277768200263381 0.042639081925153734
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:59:19,690 - epoch:26, training loss:0.1132 validation loss:0.0428
Updating learning rate to 3.7707082641979737e-06
Updating learning rate to 3.7707082641979737e-06
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04277913561090827 0.04259789837524295
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:59:26,702 - epoch:27, training loss:0.1132 validation loss:0.0428
Updating learning rate to 1.6799869003788695e-06
Updating learning rate to 1.6799869003788695e-06
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.042754766251891854 0.042576806619763374
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:59:33,935 - epoch:28, training loss:0.1130 validation loss:0.0428
Updating learning rate to 4.1603777958832436e-07
Updating learning rate to 4.1603777958832436e-07
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04276205217465758 0.04256779085844755
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 21:59:41,158 - epoch:29, training loss:0.1128 validation loss:0.0428
Updating learning rate to 4.874217159761038e-10
Updating learning rate to 4.874217159761038e-10
2023-07-24 21:59:41,700 - [*] loss:0.0831
2023-07-24 21:59:41,701 - [*] phase 0, testing
2023-07-24 21:59:41,710 - T:96  MAE     0.186265        RMSE    0.084264        MAPE    46.954605
2023-07-24 21:59:41,711 - 96    mae     0.1863
2023-07-24 21:59:41,711 - 96    rmse    0.0843
2023-07-24 21:59:41,711 - 96    mape    46.9546


2023-07-24 22:13:37,052 - logger name:exp/ECL-PatchTST2023-07-24-22:13:37.052319/ECL-PatchTST.log
2023-07-24 22:13:37,052 - params : {'conf': 'ECL-PatchTST', 'data_name': 'electricity', 'iteration': 1, 'load': True, 'build_graph': False, 'grad_norm': False, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 96, 'noise_rate': 0.1, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-07-23-21:59:42.618606/0/0.0379_epoch_25.pkl', 'idx': 89, 'aligner': 0, 'refiner': 0, 'enhance': 0, 'seed': 2022, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'e_layers': 3, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'train': True, 'epoch': 30, 'batch_size': 256, 'lr': 0.0001, 'loss': 'mse', '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': 26304, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-07-24-22:13:37.052319', 'path': 'exp/ECL-PatchTST2023-07-24-22:13:37.052319', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-07-24 22:13:37,052 - [*] phase 0 start training
0 26304
18412 2632 5260 0.7 0.2 26304
train 17981
18412 2632 5260 0.7 0.2 26304
val 2537
18412 2632 5260 0.7 0.2 26304
test 5165
2023-07-24 22:13:49,047 - [*] phase 0 Dataset load!
2023-07-24 22:13:49,870 - [*] phase 0 Training start
18412 2632 5260 0.7 0.2 26304
train 17981
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:13:55,161 - epoch:0, training loss:0.6949 validation loss:0.1537
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.15368804037570954 0.15759033635258674
Updating learning rate to 1.0460804405720289e-05
Updating learning rate to 1.0460804405720289e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.0874932412058115 0.08715387620031834
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:14:06,028 - epoch:1, training loss:0.4078 validation loss:0.0875
Updating learning rate to 2.8103967890840526e-05
Updating learning rate to 2.8103967890840526e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.06880468390882015 0.06862345430999994
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:14:13,156 - epoch:2, training loss:0.2850 validation loss:0.0688
Updating learning rate to 5.2179947606381204e-05
Updating learning rate to 5.2179947606381204e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.06057795807719231 0.06106816045939922
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:14:20,173 - epoch:3, training loss:0.2198 validation loss:0.0606
Updating learning rate to 7.620748539325079e-05
Updating learning rate to 7.620748539325079e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.054648895375430585 0.05617250073701143
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:14:27,331 - epoch:4, training loss:0.1822 validation loss:0.0546
Updating learning rate to 9.371836366844854e-05
Updating learning rate to 9.371836366844854e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.051550650224089625 0.053234180249273774
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:14:34,446 - epoch:5, training loss:0.1624 validation loss:0.0516
Updating learning rate to 9.999991257828403e-05
Updating learning rate to 9.999991257828403e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04944624062627554 0.05103448424488306
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:14:41,649 - epoch:6, training loss:0.1507 validation loss:0.0494
Updating learning rate to 9.955995399140267e-05
Updating learning rate to 9.955995399140267e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04805647749453783 0.04943122807890177
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:14:48,717 - epoch:7, training loss:0.1435 validation loss:0.0481
Updating learning rate to 9.82720142731687e-05
Updating learning rate to 9.82720142731687e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04726754650473595 0.04837619904428721
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:14:56,135 - epoch:8, training loss:0.1380 validation loss:0.0473
Updating learning rate to 9.615813042924547e-05
Updating learning rate to 9.615813042924547e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04682629853487015 0.047814768739044666
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:15:03,740 - epoch:9, training loss:0.1345 validation loss:0.0468
Updating learning rate to 9.325447159828183e-05
Updating learning rate to 9.325447159828183e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.045996830239892005 0.04684099387377501
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:15:10,802 - epoch:10, training loss:0.1312 validation loss:0.0460
Updating learning rate to 8.961072018792186e-05
Updating learning rate to 8.961072018792186e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04558306727558374 0.04634121004492044
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:15:18,180 - epoch:11, training loss:0.1284 validation loss:0.0456
Updating learning rate to 8.528922179503559e-05
Updating learning rate to 8.528922179503559e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04521281523630023 0.04571785144507885
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:15:25,546 - epoch:12, training loss:0.1264 validation loss:0.0452
Updating learning rate to 8.0363918455271e-05
Updating learning rate to 8.0363918455271e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.044767049979418515 0.04522498911246657
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:15:32,615 - epoch:13, training loss:0.1244 validation loss:0.0448
Updating learning rate to 7.491908347432356e-05
Updating learning rate to 7.491908347432356e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04468258991837502 0.045227808970957996
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:15:39,983 - epoch:14, training loss:0.1230 validation loss:0.0447
Updating learning rate to 6.90478794883107e-05
Updating learning rate to 6.90478794883107e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04504034407436848 0.044604457821696995
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:15:47,282 - epoch:15, training loss:0.1209 validation loss:0.0450
Updating learning rate to 6.285076442523838e-05
Updating learning rate to 6.285076442523838e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.044080556742846964 0.04431552896276116
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:15:54,696 - epoch:16, training loss:0.1200 validation loss:0.0441
Updating learning rate to 5.6433772642000686e-05
Updating learning rate to 5.6433772642000686e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04404638297855854 0.044101777765899894
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:16:02,264 - epoch:17, training loss:0.1189 validation loss:0.0440
Updating learning rate to 4.9906700647135036e-05
Updating learning rate to 4.9906700647135036e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.043732461798936126 0.043913559336215255
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:16:09,897 - epoch:18, training loss:0.1177 validation loss:0.0437
Updating learning rate to 4.338122845211983e-05
Updating learning rate to 4.338122845211983e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04356873417273164 0.04365041991695762
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:16:17,100 - epoch:19, training loss:0.1172 validation loss:0.0436
Updating learning rate to 3.696900869541445e-05
Updating learning rate to 3.696900869541445e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04340715613216162 0.04351261099800467
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:16:24,338 - epoch:20, training loss:0.1162 validation loss:0.0434
Updating learning rate to 3.077975623485933e-05
Updating learning rate to 3.077975623485933e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.0432826760224998 0.0433013035915792
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:16:31,499 - epoch:21, training loss:0.1152 validation loss:0.0433
Updating learning rate to 2.4919370896039528e-05
Updating learning rate to 2.4919370896039528e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04316383516415954 0.043141191452741624
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:16:39,013 - epoch:22, training loss:0.1146 validation loss:0.0432
Updating learning rate to 1.948812549690802e-05
Updating learning rate to 1.948812549690802e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04338900996372104 0.04326299419626593
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:16:46,663 - epoch:23, training loss:0.1143 validation loss:0.0434
Updating learning rate to 1.4578950152069679e-05
Updating learning rate to 1.4578950152069679e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.042995283380150795 0.04303778549656272
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:16:53,801 - epoch:24, training loss:0.1140 validation loss:0.0430
Updating learning rate to 1.0275842212755217e-05
Updating learning rate to 1.0275842212755217e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.042880146857351066 0.04295019488781691
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:17:01,539 - epoch:25, training loss:0.1135 validation loss:0.0429
Updating learning rate to 6.652429048853217e-06
Updating learning rate to 6.652429048853217e-06
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.042811104003340004 0.04289106018841267
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:17:08,573 - epoch:26, training loss:0.1132 validation loss:0.0428
Updating learning rate to 3.7707082641979737e-06
Updating learning rate to 3.7707082641979737e-06
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.0428163037635386 0.04286492094397545
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:17:15,899 - epoch:27, training loss:0.1130 validation loss:0.0428
Updating learning rate to 1.6799869003788695e-06
Updating learning rate to 1.6799869003788695e-06
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04283945905044675 0.04284049477428198
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:17:23,054 - epoch:28, training loss:0.1130 validation loss:0.0428
Updating learning rate to 4.1603777958832436e-07
Updating learning rate to 4.1603777958832436e-07
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04281543353572488 0.04284232100471854
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:17:30,505 - epoch:29, training loss:0.1129 validation loss:0.0428
Updating learning rate to 4.874217159761038e-10
Updating learning rate to 4.874217159761038e-10
2023-07-24 22:17:30,968 - [*] loss:0.0837
2023-07-24 22:17:30,970 - [*] phase 0, testing
2023-07-24 22:17:30,979 - T:96  MAE     0.187210        RMSE    0.084820        MAPE    47.016212
2023-07-24 22:17:30,979 - 96    mae     0.1872
2023-07-24 22:17:30,979 - 96    rmse    0.0848
2023-07-24 22:17:30,979 - 96    mape    47.0162

2023-07-24 22:18:09,034 - logger name:exp/ECL-PatchTST2023-07-24-22:18:09.034689/ECL-PatchTST.log
2023-07-24 22:18:09,035 - params : {'conf': 'ECL-PatchTST', 'data_name': 'electricity', 'iteration': 1, 'load': True, 'build_graph': False, 'grad_norm': False, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 96, 'noise_rate': 0.1, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-07-23-21:59:42.618606/0/0.0379_epoch_25.pkl', 'idx': 89, 'aligner': 0, 'refiner': 0, 'enhance': 0, 'seed': 2023, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'e_layers': 3, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'train': True, 'epoch': 30, 'batch_size': 256, 'lr': 0.0001, 'loss': 'mse', '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': 26304, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-07-24-22:18:09.034689', 'path': 'exp/ECL-PatchTST2023-07-24-22:18:09.034689', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-07-24 22:18:09,035 - [*] phase 0 start training
0 26304
18412 2632 5260 0.7 0.2 26304
train 17981
18412 2632 5260 0.7 0.2 26304
val 2537
18412 2632 5260 0.7 0.2 26304
test 5165
2023-07-24 22:18:20,904 - [*] phase 0 Dataset load!
2023-07-24 22:18:21,730 - [*] phase 0 Training start
18412 2632 5260 0.7 0.2 26304
train 17981
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:18:27,199 - epoch:0, training loss:0.7148 validation loss:0.1571
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.15705706626176835 0.15335377901792527
Updating learning rate to 1.0460804405720289e-05
Updating learning rate to 1.0460804405720289e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.08748885355889797 0.08627122975885868
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:18:37,797 - epoch:1, training loss:0.4116 validation loss:0.0875
Updating learning rate to 2.8103967890840526e-05
Updating learning rate to 2.8103967890840526e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.06879115588963032 0.06868559997528792
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:18:44,896 - epoch:2, training loss:0.2879 validation loss:0.0688
Updating learning rate to 5.2179947606381204e-05
Updating learning rate to 5.2179947606381204e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.060997041687369344 0.06102212015539408
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:18:51,747 - epoch:3, training loss:0.2206 validation loss:0.0610
Updating learning rate to 7.620748539325079e-05
Updating learning rate to 7.620748539325079e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.05563078820705414 0.05588044282048941
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:18:58,708 - epoch:4, training loss:0.1829 validation loss:0.0556
Updating learning rate to 9.371836366844854e-05
Updating learning rate to 9.371836366844854e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.05218962822109461 0.05295367781072855
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:19:05,812 - epoch:5, training loss:0.1631 validation loss:0.0522
Updating learning rate to 9.999991257828403e-05
Updating learning rate to 9.999991257828403e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.049380349926650524 0.050912113673985
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:19:12,915 - epoch:6, training loss:0.1514 validation loss:0.0494
Updating learning rate to 9.955995399140267e-05
Updating learning rate to 9.955995399140267e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04883855525404215 0.049624569714069366
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:19:20,026 - epoch:7, training loss:0.1439 validation loss:0.0488
Updating learning rate to 9.82720142731687e-05
Updating learning rate to 9.82720142731687e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04732944816350937 0.048159758932888506
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:19:27,388 - epoch:8, training loss:0.1389 validation loss:0.0473
Updating learning rate to 9.615813042924547e-05
Updating learning rate to 9.615813042924547e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.046585597284138205 0.047308018803596495
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:19:34,443 - epoch:9, training loss:0.1348 validation loss:0.0466
Updating learning rate to 9.325447159828183e-05
Updating learning rate to 9.325447159828183e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.045729313790798184 0.04649282153695822
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:19:41,824 - epoch:10, training loss:0.1315 validation loss:0.0457
Updating learning rate to 8.961072018792186e-05
Updating learning rate to 8.961072018792186e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04585347976535559 0.04609037134796381
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:19:49,381 - epoch:11, training loss:0.1289 validation loss:0.0459
Updating learning rate to 8.528922179503559e-05
Updating learning rate to 8.528922179503559e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04531460087746382 0.045629249420017004
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:19:56,585 - epoch:12, training loss:0.1266 validation loss:0.0453
Updating learning rate to 8.0363918455271e-05
Updating learning rate to 8.0363918455271e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04474965743720531 0.044947687443345784
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:20:04,098 - epoch:13, training loss:0.1249 validation loss:0.0447
Updating learning rate to 7.491908347432356e-05
Updating learning rate to 7.491908347432356e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.044549893215298654 0.044515018630772826
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:20:11,588 - epoch:14, training loss:0.1227 validation loss:0.0445
Updating learning rate to 6.90478794883107e-05
Updating learning rate to 6.90478794883107e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04409240754321218 0.044226137641817334
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:20:18,835 - epoch:15, training loss:0.1213 validation loss:0.0441
Updating learning rate to 6.285076442523838e-05
Updating learning rate to 6.285076442523838e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04377090986818075 0.04387609614059329
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:20:26,226 - epoch:16, training loss:0.1201 validation loss:0.0438
Updating learning rate to 5.6433772642000686e-05
Updating learning rate to 5.6433772642000686e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04407300762832165 0.04381616534665227
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:20:33,694 - epoch:17, training loss:0.1188 validation loss:0.0441
Updating learning rate to 4.9906700647135036e-05
Updating learning rate to 4.9906700647135036e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04332632338628173 0.04321987861767411
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:20:41,097 - epoch:18, training loss:0.1178 validation loss:0.0433
Updating learning rate to 4.338122845211983e-05
Updating learning rate to 4.338122845211983e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.043450857233256104 0.04320547869428992
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:20:48,532 - epoch:19, training loss:0.1170 validation loss:0.0435
Updating learning rate to 3.696900869541445e-05
Updating learning rate to 3.696900869541445e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.043294407427310944 0.0430932205170393
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:20:55,843 - epoch:20, training loss:0.1161 validation loss:0.0433
Updating learning rate to 3.077975623485933e-05
Updating learning rate to 3.077975623485933e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.043101529311388734 0.04289254108443856
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:21:04,257 - epoch:21, training loss:0.1153 validation loss:0.0431
Updating learning rate to 2.4919370896039528e-05
Updating learning rate to 2.4919370896039528e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04305620351806283 0.04270377783104777
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:21:11,732 - epoch:22, training loss:0.1150 validation loss:0.0431
Updating learning rate to 1.948812549690802e-05
Updating learning rate to 1.948812549690802e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04291267357766628 0.04255279265344143
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:21:18,901 - epoch:23, training loss:0.1146 validation loss:0.0429
Updating learning rate to 1.4578950152069679e-05
Updating learning rate to 1.4578950152069679e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.042879795748740436 0.04253425020724535
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:21:26,053 - epoch:24, training loss:0.1137 validation loss:0.0429
Updating learning rate to 1.0275842212755217e-05
Updating learning rate to 1.0275842212755217e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.042710856441408394 0.042434198595583436
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:21:33,223 - epoch:25, training loss:0.1136 validation loss:0.0427
Updating learning rate to 6.652429048853217e-06
Updating learning rate to 6.652429048853217e-06
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04267264306545258 0.04238283773884177
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:21:40,653 - epoch:26, training loss:0.1134 validation loss:0.0427
Updating learning rate to 3.7707082641979737e-06
Updating learning rate to 3.7707082641979737e-06
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04262778675183654 0.04236802589148283
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:21:48,008 - epoch:27, training loss:0.1134 validation loss:0.0426
Updating learning rate to 1.6799869003788695e-06
Updating learning rate to 1.6799869003788695e-06
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04268039306625724 0.04234808115288615
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:21:55,335 - epoch:28, training loss:0.1132 validation loss:0.0427
Updating learning rate to 4.1603777958832436e-07
Updating learning rate to 4.1603777958832436e-07
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04266711417585611 0.04233298972249031
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:22:02,587 - epoch:29, training loss:0.1129 validation loss:0.0427
Updating learning rate to 4.874217159761038e-10
Updating learning rate to 4.874217159761038e-10
2023-07-24 22:22:03,079 - [*] loss:0.0833
2023-07-24 22:22:03,081 - [*] phase 0, testing
2023-07-24 22:22:03,089 - T:96  MAE     0.186912        RMSE    0.084421        MAPE    46.687511
2023-07-24 22:22:03,089 - 96    mae     0.1869
2023-07-24 22:22:03,089 - 96    rmse    0.0844
2023-07-24 22:22:03,089 - 96    mape    46.6875

2023-07-24 22:22:39,798 - logger name:exp/ECL-PatchTST2023-07-24-22:22:39.798309/ECL-PatchTST.log
2023-07-24 22:22:39,798 - params : {'conf': 'ECL-PatchTST', 'data_name': 'electricity', 'iteration': 1, 'load': True, 'build_graph': False, 'grad_norm': False, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 96, 'noise_rate': 0.1, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-07-23-21:59:42.618606/0/0.0379_epoch_25.pkl', 'idx': 89, 'aligner': 0, 'refiner': 0, 'enhance': 0, 'seed': 2024, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'e_layers': 3, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'train': True, 'epoch': 30, 'batch_size': 256, 'lr': 0.0001, 'loss': 'mse', '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': 26304, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-07-24-22:22:39.798309', 'path': 'exp/ECL-PatchTST2023-07-24-22:22:39.798309', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-07-24 22:22:39,799 - [*] phase 0 start training
0 26304
18412 2632 5260 0.7 0.2 26304
train 17981
18412 2632 5260 0.7 0.2 26304
val 2537
18412 2632 5260 0.7 0.2 26304
test 5165
2023-07-24 22:22:51,560 - [*] phase 0 Dataset load!
2023-07-24 22:22:52,398 - [*] phase 0 Training start
18412 2632 5260 0.7 0.2 26304
train 17981
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:22:57,700 - epoch:0, training loss:0.6682 validation loss:0.1456
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.1456044152379036 0.14525736048817633
Updating learning rate to 1.0460804405720289e-05
Updating learning rate to 1.0460804405720289e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.08913536556065083 0.08717497177422047
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:23:08,266 - epoch:1, training loss:0.4101 validation loss:0.0891
Updating learning rate to 2.8103967890840526e-05
Updating learning rate to 2.8103967890840526e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.06956669315695763 0.06841284185647964
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:23:15,288 - epoch:2, training loss:0.2897 validation loss:0.0696
Updating learning rate to 5.2179947606381204e-05
Updating learning rate to 5.2179947606381204e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.060968396812677385 0.06107627786695957
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:23:22,357 - epoch:3, training loss:0.2215 validation loss:0.0610
Updating learning rate to 7.620748539325079e-05
Updating learning rate to 7.620748539325079e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.055980066396296026 0.05602683648467064
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:23:29,677 - epoch:4, training loss:0.1822 validation loss:0.0560
Updating learning rate to 9.371836366844854e-05
Updating learning rate to 9.371836366844854e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.05242790002375841 0.05292132869362831
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:23:36,685 - epoch:5, training loss:0.1619 validation loss:0.0524
Updating learning rate to 9.999991257828403e-05
Updating learning rate to 9.999991257828403e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.05002010464668274 0.050891396962106226
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:23:44,032 - epoch:6, training loss:0.1509 validation loss:0.0500
Updating learning rate to 9.955995399140267e-05
Updating learning rate to 9.955995399140267e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04930090699344873 0.049585235491395
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:23:51,125 - epoch:7, training loss:0.1437 validation loss:0.0493
Updating learning rate to 9.82720142731687e-05
Updating learning rate to 9.82720142731687e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.047323103062808514 0.04827671535313129
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:23:58,455 - epoch:8, training loss:0.1387 validation loss:0.0473
Updating learning rate to 9.615813042924547e-05
Updating learning rate to 9.615813042924547e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.046645968593657015 0.047427753917872906
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:24:06,281 - epoch:9, training loss:0.1347 validation loss:0.0466
Updating learning rate to 9.325447159828183e-05
Updating learning rate to 9.325447159828183e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04645491596311331 0.04683398492634296
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:24:13,579 - epoch:10, training loss:0.1314 validation loss:0.0465
Updating learning rate to 8.961072018792186e-05
Updating learning rate to 8.961072018792186e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.0462831661105156 0.046298456750810145
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:24:20,646 - epoch:11, training loss:0.1290 validation loss:0.0463
Updating learning rate to 8.528922179503559e-05
Updating learning rate to 8.528922179503559e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.045153398625552656 0.04546466413885355
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:24:27,938 - epoch:12, training loss:0.1269 validation loss:0.0452
Updating learning rate to 8.0363918455271e-05
Updating learning rate to 8.0363918455271e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.044936041533946994 0.0454121470451355
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:24:35,132 - epoch:13, training loss:0.1245 validation loss:0.0449
Updating learning rate to 7.491908347432356e-05
Updating learning rate to 7.491908347432356e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.0451698194257915 0.04465578244999051
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:24:42,295 - epoch:14, training loss:0.1232 validation loss:0.0452
Updating learning rate to 6.90478794883107e-05
Updating learning rate to 6.90478794883107e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04423298770561814 0.0443482656031847
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:24:49,821 - epoch:15, training loss:0.1220 validation loss:0.0442
Updating learning rate to 6.285076442523838e-05
Updating learning rate to 6.285076442523838e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04392303880304098 0.04401953127235174
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:24:57,171 - epoch:16, training loss:0.1201 validation loss:0.0439
Updating learning rate to 5.6433772642000686e-05
Updating learning rate to 5.6433772642000686e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.043855854962021115 0.04368542591109872
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:25:04,445 - epoch:17, training loss:0.1188 validation loss:0.0439
Updating learning rate to 4.9906700647135036e-05
Updating learning rate to 4.9906700647135036e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.043809323385357854 0.04337337566539645
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:25:11,876 - epoch:18, training loss:0.1180 validation loss:0.0438
Updating learning rate to 4.338122845211983e-05
Updating learning rate to 4.338122845211983e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04353660987690091 0.043156515900045635
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:25:19,039 - epoch:19, training loss:0.1169 validation loss:0.0435
Updating learning rate to 3.696900869541445e-05
Updating learning rate to 3.696900869541445e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04346814071759582 0.043180121947079896
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:25:26,558 - epoch:20, training loss:0.1159 validation loss:0.0435
Updating learning rate to 3.077975623485933e-05
Updating learning rate to 3.077975623485933e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04350196300074458 0.04300247887149453
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:25:33,764 - epoch:21, training loss:0.1155 validation loss:0.0435
Updating learning rate to 2.4919370896039528e-05
Updating learning rate to 2.4919370896039528e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.043319357000291346 0.04271849142387509
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:25:41,260 - epoch:22, training loss:0.1151 validation loss:0.0433
Updating learning rate to 1.948812549690802e-05
Updating learning rate to 1.948812549690802e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.042978263553231956 0.04278835244476795
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:25:49,004 - epoch:23, training loss:0.1144 validation loss:0.0430
Updating learning rate to 1.4578950152069679e-05
Updating learning rate to 1.4578950152069679e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.043279646150767806 0.04264595555141568
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:25:56,705 - epoch:24, training loss:0.1141 validation loss:0.0433
Updating learning rate to 1.0275842212755217e-05
Updating learning rate to 1.0275842212755217e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.0432501781731844 0.04256081636995077
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:26:04,128 - epoch:25, training loss:0.1138 validation loss:0.0433
Updating learning rate to 6.652429048853217e-06
Updating learning rate to 6.652429048853217e-06
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04299687780439854 0.042495794035494326
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:26:11,586 - epoch:26, training loss:0.1134 validation loss:0.0430
Updating learning rate to 3.7707082641979737e-06
Updating learning rate to 3.7707082641979737e-06
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04296471234411001 0.04246107107028365
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:26:18,907 - epoch:27, training loss:0.1134 validation loss:0.0430
Updating learning rate to 1.6799869003788695e-06
Updating learning rate to 1.6799869003788695e-06
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04292828356847167 0.04246487757191062
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:26:26,998 - epoch:28, training loss:0.1134 validation loss:0.0429
Updating learning rate to 4.1603777958832436e-07
Updating learning rate to 4.1603777958832436e-07
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.042960609029978516 0.04244266394525766
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:26:34,422 - epoch:29, training loss:0.1132 validation loss:0.0430
Updating learning rate to 4.874217159761038e-10
Updating learning rate to 4.874217159761038e-10
2023-07-24 22:26:34,918 - [*] loss:0.0836
2023-07-24 22:26:34,919 - [*] phase 0, testing
2023-07-24 22:26:34,927 - T:96  MAE     0.187545        RMSE    0.084794        MAPE    47.244766
2023-07-24 22:26:34,928 - 96    mae     0.1875
2023-07-24 22:26:34,928 - 96    rmse    0.0848
2023-07-24 22:26:34,928 - 96    mape    47.2448

2023-07-24 22:28:28,956 - logger name:exp/ECL-PatchTST2023-07-24-22:28:28.956687/ECL-PatchTST.log
2023-07-24 22:28:28,957 - params : {'conf': 'ECL-PatchTST', 'data_name': 'electricity', 'iteration': 1, 'load': True, 'build_graph': False, 'grad_norm': False, 'root_path': '', 'exp_path': 'exp/', 'val_test_mix': False, 'pred_len': 96, 'noise_rate': 0.1, 'device': device(type='cuda', index=0), 'test_model_path': '/Disk/fhyega/code/BASE/exp/ECL-PatchTST2023-07-23-21:59:42.618606/0/0.0379_epoch_25.pkl', 'idx': 89, 'aligner': 0, 'refiner': 0, 'enhance': 0, 'seed': 2025, '/* model related args*/': '//', 'model_name': 'PatchTST', 'seq_len': 336, 'label_len': 48, 'features': 'M', 'target': 'OT', 'graph_input': False, 'individual': False, 'e_layers': 3, 'd_layers': 1, 'factor': 1, 'n_heads': 16, 'd_model': 128, 'd_ff': 256, 'dropout': 0.2, 'fc_dropout': 0.2, 'head_dropout': 0.0, 'patch_len': 16, 'stride': 8, 'des': 'Exp', 'padding_patch': 'end', 'revin': 1, 'affine': 0, 'subtract_last': 0, 'decomposition': 0, 'kernel_size': 25, 'output_attention': 0, 'embed_type': 0, 'activation': 'gelu', 'lradj': 'TST', 'distil': 1, 'linear_output': 1, 'pct_start': 0.2, '/*train related args*/': '//', 'train': True, 'epoch': 30, 'batch_size': 256, 'lr': 0.0001, 'loss': 'mse', '/*dataset related args*/': '//', 'save_data_path': 'data/ECL/', 'data_process': True, 'embed': 'timeF', 'freq': 'h', 'begin_phase': 0, 'end_phase': 1, 'phase_len': 26304, 'val_ratio': 0.33, 'graph_size': 321, '/*strategy related args*/': '//', 'strategy': 'incremental', 'increase': False, 'detect': False, 'detect_strategy': 'feature', 'replay': False, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'subgraph_train': False, 'num_hops': 2, 'logname': 'ECL-PatchTST', 'time': '2023-07-24-22:28:28.956687', 'path': 'exp/ECL-PatchTST2023-07-24-22:28:28.956687', 'num_workers': 4, 'start_train': 0, 'train_mode': 'pretrain', 'get_score': False, 'use_cm': True, 'logger': <Logger __main__ (INFO)>}
2023-07-24 22:28:28,957 - [*] phase 0 start training
0 26304
18412 2632 5260 0.7 0.2 26304
train 17981
18412 2632 5260 0.7 0.2 26304
val 2537
18412 2632 5260 0.7 0.2 26304
test 5165
2023-07-24 22:28:40,820 - [*] phase 0 Dataset load!
2023-07-24 22:28:41,661 - [*] phase 0 Training start
18412 2632 5260 0.7 0.2 26304
train 17981
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:28:46,931 - epoch:0, training loss:0.7184 validation loss:0.1573
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.15729238614439964 0.1470085196197033
Updating learning rate to 1.0460804405720289e-05
Updating learning rate to 1.0460804405720289e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.08593867793679237 0.08483410738408566
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:28:57,826 - epoch:1, training loss:0.4126 validation loss:0.0859
Updating learning rate to 2.8103967890840526e-05
Updating learning rate to 2.8103967890840526e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.06740039754658937 0.06756097972393035
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:29:04,733 - epoch:2, training loss:0.2903 validation loss:0.0674
Updating learning rate to 5.2179947606381204e-05
Updating learning rate to 5.2179947606381204e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.05901594385504723 0.05931625049561262
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:29:11,816 - epoch:3, training loss:0.2222 validation loss:0.0590
Updating learning rate to 7.620748539325079e-05
Updating learning rate to 7.620748539325079e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.055000281892716885 0.05507961846888065
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:29:18,835 - epoch:4, training loss:0.1821 validation loss:0.0550
Updating learning rate to 9.371836366844854e-05
Updating learning rate to 9.371836366844854e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.05059079043567181 0.05175294671207666
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:29:25,894 - epoch:5, training loss:0.1618 validation loss:0.0506
Updating learning rate to 9.999991257828403e-05
Updating learning rate to 9.999991257828403e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.049010240286588666 0.049926532246172425
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:29:32,996 - epoch:6, training loss:0.1507 validation loss:0.0490
Updating learning rate to 9.955995399140267e-05
Updating learning rate to 9.955995399140267e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04796386174857616 0.048669306188821794
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:29:40,151 - epoch:7, training loss:0.1433 validation loss:0.0480
Updating learning rate to 9.82720142731687e-05
Updating learning rate to 9.82720142731687e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.0469934755936265 0.047749643214046955
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:29:47,254 - epoch:8, training loss:0.1380 validation loss:0.0470
Updating learning rate to 9.615813042924547e-05
Updating learning rate to 9.615813042924547e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04706332925707102 0.047043457999825476
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:29:54,523 - epoch:9, training loss:0.1342 validation loss:0.0471
Updating learning rate to 9.325447159828183e-05
Updating learning rate to 9.325447159828183e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04584134574979544 0.046138879004865886
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:30:02,686 - epoch:10, training loss:0.1311 validation loss:0.0458
Updating learning rate to 8.961072018792186e-05
Updating learning rate to 8.961072018792186e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04551633466035128 0.04558562552556396
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:30:09,980 - epoch:11, training loss:0.1281 validation loss:0.0455
Updating learning rate to 8.528922179503559e-05
Updating learning rate to 8.528922179503559e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.045534515846520664 0.045017354656010866
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:30:17,225 - epoch:12, training loss:0.1263 validation loss:0.0455
Updating learning rate to 8.0363918455271e-05
Updating learning rate to 8.0363918455271e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.044774967897683385 0.04453740296885371
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:30:24,583 - epoch:13, training loss:0.1242 validation loss:0.0448
Updating learning rate to 7.491908347432356e-05
Updating learning rate to 7.491908347432356e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04507011054083705 0.04466968281194568
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:30:31,902 - epoch:14, training loss:0.1228 validation loss:0.0451
Updating learning rate to 6.90478794883107e-05
Updating learning rate to 6.90478794883107e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.044130452815443276 0.04403917593881488
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:30:39,161 - epoch:15, training loss:0.1210 validation loss:0.0441
Updating learning rate to 6.285076442523838e-05
Updating learning rate to 6.285076442523838e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.044323403108865025 0.043756446428596975
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:30:46,470 - epoch:16, training loss:0.1199 validation loss:0.0443
Updating learning rate to 5.6433772642000686e-05
Updating learning rate to 5.6433772642000686e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.044220846612006426 0.04339225003495813
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:30:53,871 - epoch:17, training loss:0.1184 validation loss:0.0442
Updating learning rate to 4.9906700647135036e-05
Updating learning rate to 4.9906700647135036e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04351429920643568 0.04305654019117355
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:31:01,432 - epoch:18, training loss:0.1172 validation loss:0.0435
Updating learning rate to 4.338122845211983e-05
Updating learning rate to 4.338122845211983e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.043767446931451556 0.04320387970656157
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:31:09,667 - epoch:19, training loss:0.1163 validation loss:0.0438
Updating learning rate to 3.696900869541445e-05
Updating learning rate to 3.696900869541445e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.0431907169520855 0.04280649218708277
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:31:17,113 - epoch:20, training loss:0.1156 validation loss:0.0432
Updating learning rate to 3.077975623485933e-05
Updating learning rate to 3.077975623485933e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04323319979012012 0.04272496942430735
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:31:24,519 - epoch:21, training loss:0.1152 validation loss:0.0432
Updating learning rate to 2.4919370896039528e-05
Updating learning rate to 2.4919370896039528e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04288931330665946 0.042549609765410425
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:31:31,694 - epoch:22, training loss:0.1143 validation loss:0.0429
Updating learning rate to 1.948812549690802e-05
Updating learning rate to 1.948812549690802e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04313287837430835 0.04257269231602549
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:31:38,842 - epoch:23, training loss:0.1138 validation loss:0.0431
Updating learning rate to 1.4578950152069679e-05
Updating learning rate to 1.4578950152069679e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04287805473431945 0.04243792714551091
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:31:46,413 - epoch:24, training loss:0.1136 validation loss:0.0429
Updating learning rate to 1.0275842212755217e-05
Updating learning rate to 1.0275842212755217e-05
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04275242034345865 0.04235448092222214
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:31:53,651 - epoch:25, training loss:0.1130 validation loss:0.0428
Updating learning rate to 6.652429048853217e-06
Updating learning rate to 6.652429048853217e-06
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04280353402718902 0.042294996045529845
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:32:00,950 - epoch:26, training loss:0.1129 validation loss:0.0428
Updating learning rate to 3.7707082641979737e-06
Updating learning rate to 3.7707082641979737e-06
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04273500302806497 0.04225783422589302
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:32:08,187 - epoch:27, training loss:0.1128 validation loss:0.0427
Updating learning rate to 1.6799869003788695e-06
Updating learning rate to 1.6799869003788695e-06
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04269899344071746 0.04224384874105454
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:32:15,842 - epoch:28, training loss:0.1126 validation loss:0.0427
Updating learning rate to 4.1603777958832436e-07
Updating learning rate to 4.1603777958832436e-07
18412 2632 5260 0.7 0.2 26304
train 17981
vs, vt 0.04269742146134377 0.04223928963765502
/Disk/fhyega/code/BASE/main.py:304: DeprecationWarning: The truth value of an empty array is ambiguous. Returning False, but in future this will result in an error. Use `array.size > 0` to check that an array is not empty.
  if self.args.Score == []: self.args.Score = self.lossfunc(pred, true, reduction="none").mean(dim=1).detach().cpu().numpy()
2023-07-24 22:32:23,068 - epoch:29, training loss:0.1126 validation loss:0.0427
Updating learning rate to 4.874217159761038e-10
Updating learning rate to 4.874217159761038e-10
2023-07-24 22:32:23,695 - [*] loss:0.0830
2023-07-24 22:32:23,696 - [*] phase 0, testing
2023-07-24 22:32:23,704 - T:96  MAE     0.186313        RMSE    0.084148        MAPE    47.233614
2023-07-24 22:32:23,704 - 96    mae     0.1863
2023-07-24 22:32:23,704 - 96    rmse    0.0841
2023-07-24 22:32:23,705 - 96    mape    47.2336
